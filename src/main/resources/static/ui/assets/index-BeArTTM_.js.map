{"version":3,"mappings":"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","names":["CoordinatorToolApiService","response","error","planTemplateId","errorText","result","tool","requestData","errorMessage","errorData","id","__publicField","PlanParameterApiService","t","useI18n","props","__props","emit","__emit","showModal","computed","value","ref","success","publishing","deleting","currentTool","isSaved","publishAsHttpService","publishAsInternalToolcall","parameterRequirements","isLoadingParameters","formData","reactive","modalTitle","isUpdate","_a","initializeFormData","loadParameterRequirements","requirements","param","showMessage","msg","type","validateForm","i","handlePublish","inputSchema","savedTool","enabledServices","serviceUrls","err","handleDelete","watchModal","loadCoordinatorToolData","baseUrl","parameters","e","watch","newId","oldId","onMounted","__expose","_createVNode","Modal","$event","_createElementVNode","_hoisted_30","_createElementBlock","_createBlock","_unref","Icon","_createTextVNode","_toDisplayString","_hoisted_1","_hoisted_2","_hoisted_3","_cache","_normalizeClass","_vModelText","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_openBlock","_Fragment","index","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","FileUploadApiService","files","file","uploadKey","fileName","fileInputRef","uploadedFiles","isUploading","resetSession","onUnmounted","newFiles","handleFileUpload","handleFileChange","event","target","fileArray","f","uploadFiles","removeFile","fileToRemove","formatFileSize","bytes","k","sizes","acceptedFileTypes","_hoisted_4","_renderList","executionParams","parameterValues","activeTab","parameterErrors","isValidationError","isExecutingPlan","fileUploadRef","apiTabs","isAnyServiceEnabled","buttonText","canExecute","handleFilesUploaded","key","handleFilesRemoved","handleUploadKeyChanged","handleUploadStarted","handleUploadCompleted","handleUploadError","handleExecutePlan","validateParameters","replacementParams","payload","handlePublishMcpService","clearExecutionParams","newValues","updateExecutionParamsFromParameters","updateParameterValue","paramName","hasErrors","newValue","FileUploadComponent","showPublishButton","currentPlanTemplateId","toolInfo","_hoisted_18","_hoisted_19","_hoisted_31","tab","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","useJsonEditor","showJsonPreview","displayData","parseJsonToVisual","jsonContent","parsed","step","convertVisualToJson","formattedJsonOutput","newContent","oldContent","jsonOutput","newStep","addStep","removeStep","moveStepUp","moveStepDown","handleRollback","handleRestore","handleSave","toggleJsonPreview","closeJsonPreview","autoResizeTextarea","textarea","lineHeight","lines","minRows","maxRows","targetRows","newHeight","$t","_hoisted_8","_hoisted_12","_vModelSelect","args","canRollback","canRestore","isGenerating","isExecuting","bind","fn","thisArg","toString","getPrototypeOf","iterator","toStringTag","kindOf","cache","thing","str","kindOfTest","typeOfTest","isArray","isUndefined","isBuffer","val","isFunction","isArrayBuffer","isArrayBufferView","isString","isNumber","isObject","isBoolean","isPlainObject","prototype","isDate","isFile","isBlob","isFileList","isStream","isFormData","kind","isURLSearchParams","isReadableStream","isRequest","isResponse","isHeaders","trim","forEach","obj","allOwnKeys","l","keys","len","findKey","_key","_global","isContextDefined","context","merge","caseless","assignValue","targetKey","extend","a","b","stripBOM","content","inherits","constructor","superConstructor","descriptors","toFlatObject","sourceObj","destObj","filter","propFilter","prop","merged","endsWith","searchString","position","lastIndex","toArray","arr","isTypedArray","TypedArray","forEachEntry","_iterator","pair","matchAll","regExp","matches","isHTMLForm","toCamelCase","m","p1","p2","hasOwnProperty","isRegExp","reduceDescriptors","reducer","reducedDescriptors","descriptor","name","ret","freezeMethods","toObjectSet","arrayOrString","delimiter","define","noop","toFiniteNumber","defaultValue","isSpecCompliantForm","toJSONObject","stack","visit","source","reducedValue","isAsyncFn","isThenable","_setImmediate","setImmediateSupported","postMessageSupported","token","callbacks","data","cb","asap","isIterable","utils$1","AxiosError","message","code","config","request","utils","customProps","axiosError","httpAdapter","isVisitable","removeBrackets","renderKey","path","dots","isFlatArray","predicates","toFormData","options","option","metaTokens","visitor","defaultVisitor","indexes","useBlob","convertValue","el","exposedHelpers","build","encode","charMap","match","AxiosURLSearchParams","params","encoder","_encode","buildURL","url","serializeFn","serializedParams","hashmarkIndex","InterceptorManager","fulfilled","rejected","h","transitionalDefaults","URLSearchParams$1","FormData$1","Blob$1","platform$1","URLSearchParams","FormData","Blob","hasBrowserEnv","_navigator","hasStandardBrowserEnv","hasStandardBrowserWebWorkerEnv","origin","platform","toURLEncodedForm","helpers","parsePropPath","arrayToObject","formDataToJSON","buildPath","isNumericKey","isLast","stringifySafely","rawValue","parser","defaults","headers","contentType","hasJSONContentType","isObjectPayload","_FormData","transitional","forcedJSONParsing","JSONRequested","strictJSONParsing","status","method","ignoreDuplicateOf","parseHeaders","rawHeaders","line","$internals","normalizeHeader","header","normalizeValue","parseTokens","tokens","tokensRE","isValidHeaderName","matchHeaderValue","isHeaderNameFilter","formatHeader","w","char","buildAccessors","accessorName","methodName","arg1","arg2","arg3","AxiosHeaders$1","valueOrRewrite","rewrite","self","setHeader","_value","_header","_rewrite","lHeader","setHeaders","dest","entry","matcher","deleted","deleteHeader","format","normalized","targets","asStrings","first","accessors","defineAccessor","AxiosHeaders","mapped","headerValue","transformData","fns","isCancel","CanceledError","settle","resolve","reject","validateStatus","parseProtocol","speedometer","samplesCount","min","timestamps","head","tail","firstSampleTS","chunkLength","now","startedAt","bytesCount","passed","throttle","freq","timestamp","threshold","lastArgs","timer","invoke","progressEventReducer","listener","isDownloadStream","bytesNotified","_speedometer","loaded","total","progressBytes","rate","inRange","progressEventDecorator","throttled","lengthComputable","asyncDecorator","isURLSameOrigin","isMSIE","cookies","expires","domain","secure","cookie","isAbsoluteURL","combineURLs","baseURL","relativeURL","buildFullPath","requestedURL","allowAbsoluteUrls","isRelativeUrl","headersToObject","mergeConfig","config1","config2","getMergedValue","mergeDeepProperties","valueFromConfig2","defaultToConfig2","mergeDirectKeys","mergeMap","configValue","resolveConfig","newConfig","withXSRFToken","xsrfHeaderName","xsrfCookieName","auth","xsrfValue","isXHRAdapterSupported","xhrAdapter","_config","requestHeaders","responseType","onUploadProgress","onDownloadProgress","onCanceled","uploadThrottled","downloadThrottled","flushUpload","flushDownload","done","onloadend","responseHeaders","timeoutErrorMessage","cancel","protocol","composeSignals","signals","timeout","length","controller","aborted","onabort","reason","unsubscribe","signal","streamChunk","chunk","chunkSize","pos","end","readBytes","iterable","readStream","stream","reader","trackStream","onProgress","onFinish","_onFinish","loadedBytes","isFetchSupported","isReadableStreamSupported","encodeText","test","supportsRequestStream","duplexAccessed","hasContentType","DEFAULT_CHUNK_SIZE","supportsResponseStream","resolvers","res","_","getBodyLength","body","resolveBodyLength","fetchAdapter","cancelToken","withCredentials","fetchOptions","composedSignal","requestContentLength","_request","contentTypeHeader","flush","isCredentialsSupported","isStreamResponse","responseContentLength","responseData","knownAdapters","renderReason","isResolvedHandle","adapter","adapters","nameOrAdapter","rejectedReasons","reasons","state","s","throwIfCancellationRequested","dispatchRequest","VERSION","validators","deprecatedWarnings","validator","version","formatMessage","opt","desc","opts","correctSpelling","assertOptions","schema","allowUnknown","Axios$1","instanceConfig","configOrUrl","dummy","paramsSerializer","contextHeaders","requestInterceptorChain","synchronousRequestInterceptors","interceptor","responseInterceptorChain","promise","chain","onFulfilled","onRejected","fullPath","Axios","generateHTTPMethod","isForm","CancelToken$1","CancelToken","executor","resolvePromise","onfulfilled","_resolve","abort","c","spread","callback","isAxiosError","HttpStatusCode","createInstance","defaultConfig","instance","axios","promises","all","Cancel","formToJSON","getAdapter","ConfigApiService","filteredSelectedToolIds","toolId","newFilteredTools","getToolDisplayName","getToolDescription","title","showAddButton","$emit","addButtonText","useGridLayout","emptyText","visible","searchQuery","sortBy","collapsedGroups","selectedTools","updateGroupCheckboxState","groupName","tools","checkbox","isGroupPartiallySelected","newIds","filteredTools","filtered","query","aSelected","bSelected","groupA","groupB","groupedTools","groups","totalTools","nextTick","isToolSelected","toolKey","toggleToolSelection","isChecked","getSelectedToolsInGroup","isGroupFullySelected","selectedCount","toggleGroupSelection","toolKeys","newSelected","toggleGroupCollapse","handleConfirm","handleCancel","newVisible","groupNames","compatibleProps","planTypeError","titleError","availableModels","isLoadingModels","modelsLoadError","showToolModal","currentStepIndex","loadAvailableModels","showToolSelectionModal","stepIndex","sidebarStore","handleToolSelectionConfirm","selectedToolIds","handleToolsFiltered","handleCopyPlan","initializeParsedData","newData","formatTableHeader","terminateColumns","columns","col","model","_hoisted_51","_hoisted_52","AssignedTools","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","ToolSelectionModal","toast","useToast","sidebarWidth","isResizing","startX","startWidth","executionControllerRef","currentToolInfo","publishMcpModalRef","coordinatorToolConfig","loadCoordinatorToolConfig","handleSaveTemplate","saveResult","refreshParameterRequirements","planData","finalPlanData","finalPayload","showPublishMcpModal","showCopyPlanModal","newPlanTitle","isCopyingPlan","handleMcpServicePublished","handleClearExecutionParams","handleUpdateExecutionParams","closeCopyPlanModal","confirmCopyPlan","newPlan","PlanActApiService","__vitePreload","loadToolInfo","toolData","getRelativeTimeString","date","diffMs","diffMinutes","diffHours","diffDays","truncateText","text","maxLength","startResize","handleMouseMove","handleMouseUp","containerWidth","deltaPercent","newWidth","resetSidebarWidth","newPlanTemplateId","savedWidth","template","_withModifiers","JsonEditorV2","JsonEditor","ExecutionController","PublishServiceModal","MemoryApiService","conversationId","memoryName","MemoryStore","memoryId","messages","memoryStore","showTitleEdit","filteredMessages","showNameModal","currentEditMessageId","nameInput","showDeleteModal","currentDeleteId","expandedMap","handleEscKey","closeDeleteModal","closeNameModal","loadMessages","mes","mesMsg","handleSearch","selectMemory","formatTimestamp","timestampNum","matchesName","matchesId","matchesContent","bubble","showNameEditModal","messageId","currentName","saveName","newName","messageIndex","currentMessage","returnMemory","toggleMessage","filteredIndex","showDeleteConfirm","confirmDelete","_Teleport","_Transition","idx","API_BASE_URL","fetchAgentExecutionDetail","stepId","refreshAgentExecutionDetail","FileBrowserApiService","planId","apiResponse","filePath","blob","mimeType","textMimeTypes","textExtensions","lowerFileName","ext","node","isExpanded","showActions","showContextMenu","contextMenuStyle","toggleExpanded","handleClick","handleFileSelect","hideContextMenu","handleDownload","handleRightClick","copyPath","getNodeIcon","level","child","_component_FileTreeNode","loading","fileTree","selectedFile","fileContent","loadingContent","contentError","autoRefreshTimer","isTextFile","isPlanDirectoryNotFound","clearAutoRefresh","startAutoRefresh","refreshFileTree","handleFileSelected","handleDownloadFile","closeFileViewer","getFileIcon","newPlanId","FileTreeNode","scrollContainer","selectedStep","lastExecutedPlanId","hasExecutedAnyPlan","showScrollToBottomButton","isNearBottom","shouldAutoScrollToBottom","stepStatusText","fileBrowserPlanId","shouldShowNoTaskMessage","handleStepSelected","agentExecutionDetail","stepData","_c","_b","checkScrollState","autoScrollToBottomIfNeeded","refreshCurrentStep","newStepId","setScrollContainer","element","scrollTop","scrollHeight","clientHeight","isAtBottom","hasScrollableContent","scrollToBottom","formatJson","jsonData","jsonObj","cleanup","initScrollListener","setupScrollListener","oldPlanId","rootPlanId","tas","actToolInfo","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_66","FileBrowser","_hoisted_67","_hoisted_68","_hoisted_69","useMessageFormatting","diff","html","attachment","getNestingClass","getSubPlanStatusClass","agent","getSubPlanStatusText","getSubPlanStatusIcon","getSubPlanProgress","completedCount","getSubPlanCompletedCount","getAgentPreviewStatusClass","getAgentPreviewStatusIcon","getAgentStatusText","hasNestedSubPlans","getNestedSubPlans","handleSubPlanClick","handleSubPlanAgentClick","agentIndex","handleThinkActStepClick","_stepIndex","handleNestedSubPlanSelected","subPlanIndex","subPlan","handleNestedStepSelected","nestingLevel","maxVisibleSteps","nestedStep","nestedStepIndex","_component_RecursiveSubPlan","maxNestingDepth","directSubPlan","directIndex","agentExecutionSequence","handleAgentClick","agentExecution","getPlanStatusClass","getPlanStatusText","getAgentStatusClass","getAgentStatusIcon","formatToolParameters","planExecution","RecursiveSubPlan","shouldShowThinking","_d","handleAgentSelected","handleSubPlanSelected","handleUserInputSubmit","inputData","thinking","thinkingDetails","ExecutionDetails","stepActions","genericInput","hasContent","CommonApiService","rawText","formInputsStore","isInitialized","initializationTimeout","initializeFormInputs","formInputs","input","numIndex","label","getOptionsArray","isRequired","required","userInputWaitState","inputIndex","_vModelCheckbox","_vModelRadio","formatResponseText","copyToClipboard","plainText","handleRegenerate","handleRetry","handleUserInputSubmitted","UserInputForm","_mergeProps","isStreaming","handleCopy","ThinkingSection","ResponseSection","getMessageClasses","messageClasses","UserMessage","AssistantMessage","convertPlanExecutionRecord","record","converted","convertAgentExecutionRecord","convertMessageToCompatible","useChatMessages","isLoading","streamingMessageId","activeMessageId","lastMessage","hasMessages","addMessage","updateMessage","updates","removeMessage","clearMessages","startStreaming","stopStreaming","setActiveMessage","appendToMessage","field","updateMessageThinkingDetails","updateMessageThinking","updateMessagePlanExecution","findMessage","getMessageIndex","readonly","useScrollBehavior","containerRef","showScrollToBottom","isAutoScrollEnabled","scrollThreshold","smooth","checkScrollPosition","nearBottom","handleScroll","autoScrollToBottom","forceScrollToBottom","scrollToMessage","messageElement","getScrollInfo","isAtTop","scrollPercentage","addScrollListener","removeScrollListener","initializeScrollBehavior","cleanupScrollBehavior","_PlanExecutionManager","uiState","planCacheSize","uiStateCacheSize","errorPlanId","cachedRecord","uiStatePlanId","DirectApiService","useTaskStore","n","details","taskStore","PlanExecutionManager","planExecutionManager","messagesRef","pollingInterval","isMessageStreaming","compatibleMessages","handleMessageContainerClick","handleCopyMessage","handleRegenerateMessage","handleRetryMessage","handlePlanUpdate","planDetails","finalResponse","handlePlanCompleted","summary","handleDialogRoundStart","handlePlanError","ChatMessage","isTaskRunning","inputRef","currentInput","defaultPlaceholder","currentPlaceholder","isDisabled","adjustInputHeight","handleKeydown","handleSend","clearInput","handlePlanModeClick","handleStop","updateState","enabled","placeholder","setInputValue","getQuery","CronApiService","cronConfig","CronTaskUtils","cronExpr","parts","timeString","task","taskId","newStatus","saving","templates","fetchTemplates","handleOverlayClick","handleDisableLinkTemplate","formatTime","taskToSave","newTask","templateId","modelValue","router","useRouter","cronTasks","executing","toggling","activeDropdown","showDetail","selectedTask","taskToDelete","showCreateOptions","loadCronTasks","executeTask","chatId","executionData","showTaskDetail","handleSaveTask","updatedTask","showDeleteConfirmDialog","handleDeleteTask","cancelDelete","toggleDropdown","toggleTaskStatus","copyCronTime","cronTime","addNewTask","createWithJmanus","templateContent","createManually","cancelCreateOptions","handleClickOutside","_withDirectives","TaskDetailModal","route","useRoute","useMessage","prompt","inputOnlyContent","rightPanelRef","chatRef","sidebarRef","currentRootPlanId","showCronTaskModal","leftPanelWidth","startLeftWidth","computedLeftPanelWidth","maxAvailableWidth","shouldProcessEventForCurrentPlan","freshDetails","handleInputClear","handleInputUpdateState","taskContent","handleChatSendMessage","taskToInput","handlePlanExecutionRequested","newPrompt","oldPrompt","newTaskToInput","resetPanelSize","allowSpecialIds","assistantMessage","userMessage","_e","_f","_g","_h","_i","handleSendMessage","handleInputFocus","handleSubPlanStepSelected","parentPlanId","subPlanId","subStepIndex","handlePlanModeClicked","goBack","handleConfig","userMessageAdded","messageError","errorHandlingError","memorySelected","newChat","Sidebar","LanguageSwitcher","ChatContainer","InputArea","$i18n","RightPanel","CronTaskModal","Memory"],"ignoreList":[8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],"sources":["../../src/api/coordinator-tool-api-service.ts","../../src/api/plan-parameter-api-service.ts","../../src/components/publish-service-modal/PublishServiceModal.vue","../../src/api/file-upload-api-service.ts","../../src/components/file-upload/FileUploadComponent.vue","../../src/components/sidebar/ExecutionController.vue","../../src/components/sidebar/json-editor-logic.ts","../../src/components/sidebar/JsonEditor.vue","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/bind.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/utils.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/AxiosError.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/null.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/toFormData.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/AxiosURLSearchParams.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/buildURL.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/InterceptorManager.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/defaults/transitional.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/URLSearchParams.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/FormData.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/Blob.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/browser/index.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/common/utils.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/index.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/toURLEncodedForm.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/formDataToJSON.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/defaults/index.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/parseHeaders.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/AxiosHeaders.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/transformData.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/cancel/isCancel.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/cancel/CanceledError.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/settle.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/parseProtocol.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/speedometer.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/throttle.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/progressEventReducer.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/isURLSameOrigin.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/cookies.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/isAbsoluteURL.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/combineURLs.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/buildFullPath.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/mergeConfig.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/resolveConfig.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/adapters/xhr.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/composeSignals.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/trackStream.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/adapters/fetch.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/adapters/adapters.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/dispatchRequest.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/env/data.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/validator.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/Axios.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/cancel/CancelToken.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/spread.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/isAxiosError.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/HttpStatusCode.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/axios.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/index.js","../../src/api/config-api-service.ts","../../src/components/shared/AssignedTools.vue","../../src/components/tool-selection-modal/ToolSelectionModal.vue","../../src/components/sidebar/JsonEditorV2.vue","../../src/components/sidebar/Sidebar.vue","../../src/api/memory-api-service.ts","../../src/stores/memory.ts","../../src/components/memory/Memory.vue","../../src/api/agent-execution.ts","../../src/api/file-browser-api-service.ts","../../src/components/file-browser/FileTreeNode.vue","../../src/components/file-browser/index.vue","../../src/components/right-panel/RightPanel.vue","../../src/components/chat/composables/useMessageFormatting.ts","../../src/components/chat/UserMessage.vue","../../src/components/chat/RecursiveSubPlan.vue","../../src/components/chat/ExecutionDetails.vue","../../src/components/chat/ThinkingSection.vue","../../src/api/common-api-service.ts","../../src/components/chat/UserInputForm.vue","../../src/components/chat/ResponseSection.vue","../../src/components/chat/AssistantMessage.vue","../../src/components/chat/ChatMessage.vue","../../src/components/chat/composables/useChatMessages.ts","../../src/components/chat/composables/useScrollBehavior.ts","../../src/utils/plan-execution-manager.ts","../../src/components/chat/ChatContainer.vue","../../src/components/input/InputArea.vue","../../src/api/cron-api-service.ts","../../src/utils/cron-task-utils.ts","../../src/components/cron-task-modal/TaskDetailModal.vue","../../src/components/cron-task-modal/CronTaskModal.vue","../../src/views/direct/index.vue"],"sourcesContent":["/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface CoordinatorToolVO {\n  id?: number\n  toolName: string\n  toolDescription: string\n  planTemplateId: string\n  httpEndpoint?: string | undefined\n  mcpEndpoint?: string | undefined\n  inputSchema: string\n  serviceGroup?: string\n  enableInternalToolcall?: boolean\n  enableHttpService?: boolean\n  enableMcpService?: boolean\n  createTime?: string\n  updateTime?: string\n}\n\nexport interface CoordinatorToolConfig {\n  enabled: boolean\n  success: boolean\n  message?: string\n}\n\nexport class CoordinatorToolApiService {\n  private static readonly BASE_URL = '/api/coordinator-tools'\n\n  /**\n   * Get CoordinatorTool configuration information\n   */\n  public static async getCoordinatorToolConfig(): Promise<CoordinatorToolConfig> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/config`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n\n      if (!response.ok) {\n        throw new Error(`Failed to get coordinator tool config: ${response.status}`)\n      }\n\n      return await response.json()\n    } catch (error: any) {\n          console.error('Failed to get CoordinatorTool configuration:', error)\n          // Return default configuration\n      return {\n        enabled: true,\n        success: false,\n        message: error.message\n      }\n    }\n  }\n\n  /**\n   * Get all endpoint list\n   */\n  public static async getAllEndpoints(): Promise<string[]> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/endpoints`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n\n      if (!response.ok) {\n        throw new Error(`Failed to get endpoints: ${response.status}`)\n      }\n\n      return await response.json()\n    } catch (error: any) {\n      console.error('Failed to get endpoints:', error)\n      throw new Error('Failed to get endpoints: ' + error.message)\n    }\n  }\n\n  /**\n   * Get coordinator tool by plan template ID (only get existing ones)\n   */\n  public static async getCoordinatorToolsByTemplate(planTemplateId: string): Promise<CoordinatorToolVO | null> {\n        console.log('[CoordinatorToolApiService] Starting to get coordinator tool, planTemplateId:', planTemplateId)\n    console.log('[CoordinatorToolApiService] Request URL:', `${this.BASE_URL}/get-get-or-new-by-template/${planTemplateId}`)\n    \n    try {\n      const response = await fetch(`${this.BASE_URL}/get-or-new-by-template/${planTemplateId}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n\n      console.log('[CoordinatorToolApiService] Response status:', response.status)\n      console.log('[CoordinatorToolApiService] Response status text:', response.statusText)\n\n      if (response.status === 404) {\n        console.log('[CoordinatorToolApiService] 404')\n        return null\n      }\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        console.error('[CoordinatorToolApiService] Response error content:', errorText)\n        throw new Error(`Failed to get coordinator tools: ${response.status} - ${errorText}`)\n      }\n\n      const result = await response.json()\n      console.log('[CoordinatorToolApiService] Successfully got coordinator tool, result:', result)\n      return result\n    } catch (error: any) {\n      console.error('[CoordinatorToolApiService] Failed to get coordinator tool:', error)\n      throw new Error('Failed to get coordinator tool: ' + error.message)\n    }\n  }\n\n  /**\n   * Get or create coordinator tool by plan template ID\n   */\n  public static async getOrNewCoordinatorToolsByTemplate(planTemplateId: string): Promise<CoordinatorToolVO> {\n    console.log('[CoordinatorToolApiService] Starting to get or create coordinator tool, planTemplateId:', planTemplateId)\n    console.log('[CoordinatorToolApiService] Request URL:', `${this.BASE_URL}/get-or-new-by-template/${planTemplateId}`)\n    \n    try {\n      const response = await fetch(`${this.BASE_URL}/get-or-new-by-template/${planTemplateId}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n\n      console.log('[CoordinatorToolApiService] Response status:', response.status)\n      console.log('[CoordinatorToolApiService] Response status text:', response.statusText)\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        console.error('[CoordinatorToolApiService] Response error content:', errorText)\n        throw new Error(`Failed to get coordinator tools: ${response.status} - ${errorText}`)\n      }\n\n      const result = await response.json()\n      console.log('[CoordinatorToolApiService] Successfully got coordinator tool, result:', result)\n      return result\n    } catch (error: any) {\n      console.error('[CoordinatorToolApiService] Failed to get coordinator tool:', error)\n      throw new Error('Failed to get coordinator tool: ' + error.message)\n    }\n  }\n\n  /**\n   * Create coordinator tool\n   */\n  public static async createCoordinatorTool(tool: CoordinatorToolVO): Promise<CoordinatorToolVO> {\n    console.log('[CoordinatorToolApiService] Starting to create coordinator tool')\n    console.log('[CoordinatorToolApiService] Original data:', JSON.stringify(tool, null, 2))\n    console.log('[CoordinatorToolApiService] Request URL:', `${this.BASE_URL}`)\n    \n    // Only send necessary fields, excluding createTime and updateTime\n    const requestData = {\n      id: tool.id,\n      toolName: tool.toolName,\n      toolDescription: tool.toolDescription,\n      inputSchema: tool.inputSchema,\n      planTemplateId: tool.planTemplateId,\n      httpEndpoint: tool.httpEndpoint,\n      mcpEndpoint: tool.mcpEndpoint,\n      serviceGroup: tool.serviceGroup,\n      enableInternalToolcall: tool.enableInternalToolcall,\n      enableHttpService: tool.enableHttpService,\n      enableMcpService: tool.enableMcpService,\n    }\n    \n    console.log('[CoordinatorToolApiService] Cleaned sending data:', JSON.stringify(requestData, null, 2))\n    \n    try {\n      const response = await fetch(`${this.BASE_URL}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(requestData)\n      })\n\n      console.log('[CoordinatorToolApiService] Response status:', response.status)\n      console.log('[CoordinatorToolApiService] Response status text:', response.statusText)\n\n      if (!response.ok) {\n        let errorMessage = 'Unknown error'\n        try {\n          const errorData = await response.json()\n          errorMessage = errorData.message || errorData.error || errorMessage\n        } catch {\n          // If JSON parsing fails, try to get text\n          const errorText = await response.text()\n          errorMessage = errorText || errorMessage\n        }\n        console.error('[CoordinatorToolApiService] Response error content:', errorMessage)\n        throw new Error(`Failed to create coordinator tool: ${response.status} - ${errorMessage}`)\n      }\n\n      const result = await response.json()\n      console.log('[CoordinatorToolApiService] Created successfully, result:', result)\n      return result\n    } catch (error: any) {\n      console.error('[CoordinatorToolApiService] Failed to create coordinator tool:', error)\n      throw new Error('Failed to create coordinator tool: ' + error.message)\n    }\n  }\n\n  /**\n   * Update coordinator tool\n   */\n  public static async updateCoordinatorTool(id: number, tool: CoordinatorToolVO): Promise<CoordinatorToolVO> {\n    console.log('[CoordinatorToolApiService] Starting to update coordinator tool, ID:', id)\n    console.log('[CoordinatorToolApiService] Sending data:', tool)\n    console.log('[CoordinatorToolApiService] Request URL:', `${this.BASE_URL}/${id}`)\n    \n    // Only send necessary fields, excluding createTime and updateTime\n    const requestData = {\n      id: tool.id,\n      toolName: tool.toolName,\n      toolDescription: tool.toolDescription,\n      inputSchema: tool.inputSchema,\n      planTemplateId: tool.planTemplateId,\n      httpEndpoint: tool.httpEndpoint,\n      mcpEndpoint: tool.mcpEndpoint,\n      serviceGroup: tool.serviceGroup,\n      enableInternalToolcall: tool.enableInternalToolcall,\n      enableHttpService: tool.enableHttpService,\n      enableMcpService: tool.enableMcpService,\n    }\n    \n    console.log('[CoordinatorToolApiService] Cleaned sending data:', requestData)\n    \n    try {\n      const response = await fetch(`${this.BASE_URL}/${id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(requestData)\n      })\n\n      console.log('[CoordinatorToolApiService] Response status:', response.status)\n      console.log('[CoordinatorToolApiService] Response status text:', response.statusText)\n\n      if (!response.ok) {\n        let errorMessage = 'Unknown error'\n        try {\n          const errorData = await response.json()\n          errorMessage = errorData.message || errorData.error || errorMessage\n        } catch {\n          // If JSON parsing fails, try to get text\n          const errorText = await response.text()\n          errorMessage = errorText || errorMessage\n        }\n        console.error('[CoordinatorToolApiService] Response error content:', errorMessage)\n        throw new Error(`Failed to update coordinator tool: ${response.status} - ${errorMessage}`)\n      }\n\n      const result = await response.json()\n      console.log('[CoordinatorToolApiService] Updated successfully, result:', result)\n      return result\n    } catch (error: any) {\n      console.error('[CoordinatorToolApiService] Failed to update coordinator tool:', error)\n      throw new Error('Failed to update coordinator tool: ' + error.message)\n    }\n  }\n\n\n  /**\n   * Delete coordinator tool\n   */\n  public static async deleteCoordinatorTool(id: number): Promise<{ success: boolean; message: string }> {\n    console.log('[CoordinatorToolApiService] Starting to delete coordinator tool, ID:', id)\n    console.log('[CoordinatorToolApiService] Request URL:', `${this.BASE_URL}/${id}`)\n    \n    try {\n      const response = await fetch(`${this.BASE_URL}/${id}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n\n      console.log('[CoordinatorToolApiService] Response status:', response.status)\n      console.log('[CoordinatorToolApiService] Response status text:', response.statusText)\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        console.error('[CoordinatorToolApiService] Response error content:', errorText)\n        throw new Error(`Failed to delete coordinator tool: ${response.status} - ${errorText}`)\n      }\n\n      const result = await response.json()\n      console.log('[CoordinatorToolApiService] Deleted successfully, result:', result)\n      return result\n    } catch (error: any) {\n      console.error('[CoordinatorToolApiService] Failed to delete coordinator tool:', error)\n      throw new Error('Failed to delete coordinator tool: ' + error.message)\n    }\n  }\n} \n","/**\n * Plan Parameter API Service\n * Handles API calls for plan parameter requirements\n */\n\nexport interface ParameterRequirements {\n  parameters: string[]\n  hasParameters: boolean\n  requirements: string\n}\n\nexport class PlanParameterApiService {\n  private static readonly BASE_URL = '/api/plan-template'\n\n  /**\n   * Get parameter requirements for a plan template\n   * @param planTemplateId The plan template ID\n   * @returns Parameter requirements\n   */\n  static async getParameterRequirements(planTemplateId: string): Promise<ParameterRequirements> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${planTemplateId}/parameters`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error(`Failed to get parameter requirements: ${response.statusText}`)\n      }\n\n      const data = await response.json()\n      return data\n    } catch (error) {\n      console.error('Error getting parameter requirements:', error)\n      throw error\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Modal \n    v-model=\"showModal\" \n    :title=\"modalTitle\" \n    @confirm=\"handlePublish\" \n  >\n    <div class=\"modal-form wide-modal\">\n      <!-- Tool Name -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.toolNameRequired') }}</label>\n          <input\n            type=\"text\"\n            v-model=\"formData.serviceName\"\n            :placeholder=\"t('mcpService.toolNamePlaceholder')\"\n            :class=\"{ 'error': !formData.serviceName || !formData.serviceName.trim() }\"\n            required\n          />\n          <div class=\"field-description\">{{ t('mcpService.toolNameDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Tool Description -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.toolDescriptionRequired') }}</label>\n          <textarea\n            v-model=\"formData.userRequest\"\n            :placeholder=\"t('mcpService.toolDescriptionPlaceholder')\"\n            :class=\"{ 'error': !formData.userRequest || !formData.userRequest.trim() }\"\n            class=\"description-field\"\n            rows=\"4\"\n            required\n          />\n          <div class=\"field-description\">{{ t('mcpService.toolDescriptionDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Service Group -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.serviceGroup') }}</label>\n          <input\n            type=\"text\"\n            v-model=\"formData.serviceGroup\"\n            :placeholder=\"t('mcpService.serviceGroupPlaceholder')\"\n            :class=\"{ 'error': !formData.serviceGroup || !formData.serviceGroup.trim() }\"\n            required\n          />\n          <div class=\"field-description\">{{ t('mcpService.serviceGroupDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Parameter Configuration -->\n      <div class=\"form-section\">\n        <div class=\"section-title\">{{ t('mcpService.parameterConfig') }}</div>\n        \n        <!-- Parameter Requirements Help Text -->\n        <div v-if=\"parameterRequirements.hasParameters\" class=\"params-help-text\">\n          {{ t('sidebar.parameterRequirementsHelp') }}\n        </div>\n        \n        <div class=\"parameter-table\">\n          <table>\n            <thead>\n              <tr>\n                <th>{{ t('mcpService.parameterName') }}</th>\n                <th>{{ t('mcpService.parameterDescription') }}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(param, index) in formData.parameters\" :key=\"index\">\n                <td>\n                  <input\n                    type=\"text\"\n                    v-model=\"param.name\"\n                    :placeholder=\"t('mcpService.parameterName')\"\n                    class=\"parameter-input\"\n                    :readonly=\"parameterRequirements.hasParameters\"\n                    :class=\"{ 'readonly-input': parameterRequirements.hasParameters }\"\n                    required\n                  />\n                </td>\n                <td>\n                  <input\n                    type=\"text\"\n                    v-model=\"param.description\"\n                    :placeholder=\"t('mcpService.parameterDescription')\"\n                    class=\"parameter-input\"\n                    required\n                  />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- Service Publishing Options -->\n      <div class=\"form-section\">\n        <div class=\"service-publish-options\">\n          <!-- Internal Toolcall Publishing Option -->\n          <div class=\"internal-toolcall-publish-option\">\n            <label class=\"checkbox-label\">\n              <input\n                type=\"checkbox\"\n                v-model=\"publishAsInternalToolcall\"\n                class=\"checkbox-input\"\n              />\n              <span class=\"checkbox-text\">{{ t('mcpService.publishAsInternalToolcall') }}</span>\n            </label>\n            <div class=\"checkbox-description\">\n              {{ t('mcpService.publishAsInternalToolcallDescription') }}\n            </div>\n          </div>\n          \n          <!-- HTTP POST Service Publishing Option -->\n          <div class=\"http-publish-option\">\n            <label class=\"checkbox-label\">\n              <input\n                type=\"checkbox\"\n                v-model=\"publishAsHttpService\"\n                class=\"checkbox-input\"\n              />\n              <span class=\"checkbox-text\">{{ t('mcpService.publishAsHttpService') }}</span>\n            </label>\n            <div class=\"checkbox-description\">\n              {{ t('mcpService.publishAsHttpServiceDescription') }}\n            </div>\n            \n          </div>\n          \n        </div>\n      </div>\n\n    </div>\n\n    <template #footer>\n      <div class=\"button-container\">\n        <!-- Delete Button - Only shown when saved -->\n        <button \n          v-if=\"isSaved && currentTool?.id\" \n          class=\"action-btn danger\" \n          @click=\"handleDelete\" \n          :disabled=\"deleting\"\n        >\n          <Icon icon=\"carbon:loading\" v-if=\"deleting\" class=\"loading-icon\" />\n          <Icon icon=\"carbon:trash-can\" v-else />\n          {{ deleting ? t('mcpService.deleting') : t('mcpService.delete') }}\n        </button>\n        \n        <!-- Publish as Service Button - Always shown -->\n        <button class=\"action-btn primary\" @click=\"handlePublish\" :disabled=\"publishing\">\n          <Icon icon=\"carbon:loading\" v-if=\"publishing\" class=\"loading-icon\" />\n          <Icon icon=\"carbon:cloud-upload\" v-else />\n          {{ publishing ? t('mcpService.publishing') : t('mcpService.publishAsService') }}\n        </button>\n        \n      </div>\n    </template>\n  </Modal>\n\n  <!-- Error Toast -->\n  <div v-if=\"error\" class=\"error-toast\" @click=\"error = ''\">\n    <Icon icon=\"carbon:error\" />\n    {{ error }}\n  </div>\n\n  <!-- Success Toast -->\n  <div v-if=\"success\" class=\"success-toast\" @click=\"success = ''\">\n    <Icon icon=\"carbon:checkmark\" />\n    {{ success }}\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, onMounted, computed, watch } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { useI18n } from 'vue-i18n'\nimport Modal from '@/components/modal/index.vue'\nimport { CoordinatorToolApiService, type CoordinatorToolVO } from '@/api/coordinator-tool-api-service'\nimport { PlanParameterApiService, type ParameterRequirements } from '@/api/plan-parameter-api-service'\n\nconst { t } = useI18n()\n\n// Props\ninterface Props {\n  modelValue: boolean\n  planTemplateId?: string\n  planDescription?: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  modelValue: false,\n  planTemplateId: '',\n  planDescription: ''\n})\n\n// Emits\nconst emit = defineEmits<{\n  'update:modelValue': [value: boolean]\n  'published': [tool: CoordinatorToolVO | null]\n}>()\n\n// Reactive data\nconst showModal = computed({\n  get: () => props.modelValue,\n  set: (value) => emit('update:modelValue', value)\n})\n\nconst error = ref('')\nconst success = ref('')\nconst publishing = ref(false)\nconst deleting = ref(false)\n\n// Current tool data, used to determine whether to create or update\nconst currentTool = ref<CoordinatorToolVO | null>(null)\n\n// Publishing status\nconst isSaved = ref(false)\n\n// Service publishing options\nconst publishAsHttpService = ref(false)\nconst publishAsInternalToolcall = ref(true) // Default to true\n\n// Parameter requirements from plan template\nconst parameterRequirements = ref<ParameterRequirements>({\n  parameters: [],\n  hasParameters: false,\n  requirements: ''\n})\nconst isLoadingParameters = ref(false)\n\n\n\n\n\n// Form data\nconst formData = reactive({\n  serviceName: '',\n  userRequest: '',\n  endpoint: '',\n  serviceGroup: '',\n  parameters: [] as Array<{ name: string; description: string }>\n})\n\n// Calculate modal title\nconst modalTitle = computed(() => {\n  const isUpdate = currentTool.value?.id\n  return isUpdate ? t('mcpService.updateService') : t('mcpService.createService')\n})\n\n// Initialize form data\nconst initializeFormData = () => {\n  formData.serviceName = '' // Show empty when no entity\n  formData.userRequest = props.planDescription || ''\n  formData.endpoint = ''\n  formData.serviceGroup = ''\n  // Only reset parameters when not loaded from plan template\n  if (!parameterRequirements.value.hasParameters) {\n    formData.parameters = []\n  }\n  currentTool.value = null\n  isSaved.value = false\n}\n\n\n// Load parameter requirements from plan template\nconst loadParameterRequirements = async () => {\n  if (!props.planTemplateId) {\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: ''\n    }\n    return\n  }\n\n  isLoadingParameters.value = true\n  try {\n    const requirements = await PlanParameterApiService.getParameterRequirements(props.planTemplateId)\n    parameterRequirements.value = requirements\n    \n    // Initialize form parameters with extracted parameters\n    if (requirements.hasParameters) {\n      formData.parameters = requirements.parameters.map(param => ({\n        name: param,\n        description: ''\n      }))\n    }\n  } catch (error) {\n    console.error('[PublishModal] Failed to load parameter requirements:', error)\n    // Don't show error for 404 - template might not be ready yet\n    if (error instanceof Error && !error.message.includes('404')) {\n      console.warn('[PublishModal] Parameter requirements not available yet, will retry later')\n    }\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: ''\n    }\n  } finally {\n    isLoadingParameters.value = false\n  }\n}\n\n\n// Show message\nconst showMessage = (msg: string, type: 'success' | 'error' | 'info') => {\n  if (type === 'success') {\n    success.value = msg\n    setTimeout(() => {\n      success.value = ''\n    }, 3000)\n  } else if (type === 'error') {\n    error.value = msg\n    setTimeout(() => {\n      error.value = ''\n    }, 5000)\n  }\n}\n\n// Validate form\nconst validateForm = (): boolean => {\n  // Validate tool name\n  if (!formData.serviceName.trim()) {\n    showMessage(t('mcpService.toolNameRequiredError'), 'error')\n    return false\n  }\n  \n  // Validate tool description\n  if (!formData.userRequest.trim()) {\n    showMessage(t('mcpService.toolDescriptionRequiredError'), 'error')\n    return false\n  }\n  \n  // Validate service group\n  if (!formData.serviceGroup.trim()) {\n    showMessage(t('mcpService.serviceGroupRequiredError'), 'error')\n    return false\n  }\n  \n  \n  \n  // Ensure at least one service is selected\n  if (!publishAsInternalToolcall.value && !publishAsHttpService.value) {\n    showMessage('Please select at least one service type', 'error')\n    return false\n  }\n  \n  // Validate parameter names and descriptions\n  for (let i = 0; i < formData.parameters.length; i++) {\n    const param = formData.parameters[i]\n    if (param.name && !param.description.trim()) {\n      showMessage(`Parameter \"${param.name}\" description cannot be empty`, 'error')\n      return false\n    }\n    if (param.description && !param.name.trim()) {\n      showMessage(`Parameter description \"${param.description}\" corresponding name cannot be empty`, 'error')\n      return false\n    }\n  }\n  \n  return true\n}\n\n\n// Handle publishing\nconst handlePublish = async () => {\n  console.log('[PublishModal] Starting to handle publish request')\n  console.log('[PublishModal] Form data:', formData)\n  console.log('[PublishModal] Current tool:', currentTool.value)\n  console.log('[PublishModal] Publish as HTTP service:', publishAsHttpService.value)\n  \n  if (!validateForm()) {\n    console.log('[PublishModal] Form validation failed')\n    return\n  }\n\n  publishing.value = true\n  try {\n    // 1. If no current tool data, get or create first\n    if (!currentTool.value) {\n      console.log('[PublishModal] No current tool data, getting or creating first')\n      currentTool.value = await CoordinatorToolApiService.getOrNewCoordinatorToolsByTemplate(props.planTemplateId)\n    }\n\n    // 2. Update tool information\n    console.log('[PublishModal] Updating tool information')\n    currentTool.value.toolName = formData.serviceName.trim()\n    currentTool.value.toolDescription = formData.userRequest.trim()\n    currentTool.value.serviceGroup = formData.serviceGroup.trim()\n    currentTool.value.planTemplateId = props.planTemplateId // Ensure planTemplateId is set\n\n    // Set service enabled status and corresponding endpoint\n    currentTool.value.enableInternalToolcall = publishAsInternalToolcall.value\n    currentTool.value.enableHttpService = publishAsHttpService.value\n    currentTool.value.enableMcpService = false\n    \n    // Set corresponding endpoint\n    currentTool.value.mcpEndpoint = undefined\n    \n\n    // 3. Update inputSchema\n    const inputSchema = formData.parameters\n      .filter(param => param.name.trim() && param.description.trim())\n      .map(param => ({\n        name: param.name.trim(),\n        description: param.description.trim(),\n        type: 'string'\n      }))\n    \n    currentTool.value.inputSchema = JSON.stringify(inputSchema)\n    console.log('[PublishModal] Updated tool information:', currentTool.value)\n\n    // 4. Save tool\n    if (currentTool.value.id) {\n      console.log('[PublishModal] Updating existing tool, ID:', currentTool.value.id)\n      await CoordinatorToolApiService.updateCoordinatorTool(currentTool.value.id, currentTool.value)\n    } else {\n      console.log('[PublishModal] Creating new tool')\n      const savedTool = await CoordinatorToolApiService.createCoordinatorTool(currentTool.value)\n      currentTool.value = savedTool // Update current tool, including newly generated ID\n    }\n\n    // 5. Perform corresponding publishing operations based on publish type\n    const enabledServices = []\n    if (publishAsInternalToolcall.value) enabledServices.push('Internal Method Call')\n    if (publishAsHttpService.value) enabledServices.push('HTTP Service')\n    \n    if (enabledServices.length > 0) {\n      console.log('[PublishModal] Step 5: Publishing service, ID:', currentTool.value.id, 'Enabled services:', enabledServices.join(', '))\n      \n      // Build service URL information\n      const serviceUrls = []\n      if (publishAsInternalToolcall.value) {\n        serviceUrls.push(`Internal Call: ${formData.serviceName}`)\n      }\n      \n      \n      console.log('[PublishModal] Service published successfully')\n      showMessage(t('mcpService.publishSuccess'), 'success')\n      emit('published', currentTool.value)\n    } else {\n      // Just save, don't publish as any service\n      console.log('[PublishModal] Only saving tool, not publishing as any service')\n      showMessage(t('mcpService.saveSuccess'), 'success')\n      emit('published', currentTool.value)\n    }\n  } catch (err: any) {\n    console.error('[PublishModal] Failed to publish service:', err)\n    showMessage(t('mcpService.publishFailed') + ': ' + err.message, 'error')\n  } finally {\n    publishing.value = false\n  }\n}\n\n// Handle delete\nconst handleDelete = async () => {\n  if (deleting.value) return\n  \n  // Confirm deletion\n  if (!confirm(t('mcpService.deleteConfirmMessage'))) {\n    return\n  }\n  \n  if (!currentTool.value?.id) {\n    showMessage(t('mcpService.deleteFailed') + ': ' + t('mcpService.selectPlanTemplateFirst'), 'error')\n    return\n  }\n  \n  deleting.value = true\n  try {\n    console.log('[PublishModal] Starting to delete MCP service, ID:', currentTool.value.id)\n    \n    // Call delete API\n    const result = await CoordinatorToolApiService.deleteCoordinatorTool(currentTool.value.id)\n    \n    if (result.success) {\n      console.log('[PublishModal] Deleted successfully')\n      showMessage(t('mcpService.deleteSuccess'), 'success')\n      \n      // Close modal\n      showModal.value = false\n      \n      // Notify parent component of successful deletion\n      emit('published', null)\n    } else {\n      throw new Error(result.message)\n    }\n  } catch (error: any) {\n    console.error('[PublishModal] Failed to delete MCP service:', error)\n    showMessage(t('mcpService.deleteFailed') + ': ' + error.message, 'error')\n  } finally {\n    deleting.value = false\n  }\n}\n\n// Watch modal display state\nconst watchModal = async () => {\n  if (showModal.value) {\n    console.log('[PublishModal] Modal opened, starting to initialize data')\n    initializeFormData()\n    await loadCoordinatorToolData()\n  }\n}\n\n// Load coordinator tool data\nconst loadCoordinatorToolData = async () => {\n  if (!props.planTemplateId) {\n    console.log('[PublishModal] ' + t('mcpService.noPlanTemplateId'))\n    return\n  }\n  \n  try {\n    console.log('[PublishModal] Starting to load coordinator tool data, planTemplateId:', props.planTemplateId)\n    const tool = await CoordinatorToolApiService.getOrNewCoordinatorToolsByTemplate(props.planTemplateId)\n    console.log('[PublishModal] Get coordinator tool data result:', tool)\n    \n    // Save current tool data\n    currentTool.value = tool\n    \n    // Only existing tools (with ID) are set as saved\n    isSaved.value = !!(tool.id)\n    \n    // Build service URL information\n    const serviceUrls = []\n    if (tool.enableMcpService && tool.mcpEndpoint) {\n      const baseUrl = window.location.origin\n      serviceUrls.push(`MCP: ${baseUrl}/mcp${tool.mcpEndpoint}`)\n    }\n    if (tool.enableInternalToolcall) {\n      serviceUrls.push(`Internal Call: ${tool.toolName}`)\n    }\n    \n    \n    console.log('[PublishModal] Load tool data completed')\n    // Fill form data\n    formData.serviceName = tool.toolName || ''\n    formData.userRequest = tool.toolDescription || props.planDescription || ''\n    formData.serviceGroup = tool.serviceGroup ?? ''\n    \n    // Set form data based on service type\n    publishAsHttpService.value = tool.enableHttpService ?? false\n    publishAsInternalToolcall.value = tool.enableInternalToolcall ?? false\n    \n    \n    // Parse inputSchema as parameters\n    try {\n      if (tool.inputSchema) {\n        const parameters = JSON.parse(tool.inputSchema)\n        if (Array.isArray(parameters) && parameters.length > 0) {\n          // Only override when inputSchema has parameters, otherwise keep parameters loaded from plan template\n          formData.parameters = parameters.map(param => ({\n            name: param.name || '',\n            description: param.description || ''\n          }))\n          console.log('[PublishModal] Load parameters from inputSchema:', formData.parameters)\n        } else {\n          console.log('[PublishModal] inputSchema is empty, keeping existing parameters:', formData.parameters)\n        }\n      }\n    } catch (e) {\n      console.warn('[PublishModal] ' + t('mcpService.parseInputSchemaFailed') + ':', e)\n      // Don't clear parameters when parsing fails, keep existing parameters\n      console.log('[PublishModal] Parsing failed, keeping existing parameters:', formData.parameters)\n    }\n    \n    console.log('[PublishModal] Form data filled:', formData)\n  } catch (err: any) {\n    console.error('[PublishModal] ' + t('mcpService.loadToolDataFailed') + ':', err)\n    showMessage(t('mcpService.loadToolDataFailed') + ': ' + err.message, 'error')\n  }\n}\n\n// Watch props changes\nwatch(() => props.modelValue, watchModal)\n\n\n\n// Watch for planTemplateId changes\nwatch(() => props.planTemplateId, (newId, oldId) => {\n  if (newId && newId !== oldId) {\n    // If this is a new template ID (not from initial load), retry loading parameters\n    if (oldId && newId.startsWith('planTemplate-')) {\n      // Retry loading parameters with a delay for new templates\n      setTimeout(() => {\n        loadParameterRequirements()\n      }, 1000)\n    } else {\n      loadParameterRequirements()\n    }\n  }\n})\n\n// Initialize when component mounts\nonMounted(async () => {\n  if (showModal.value) {\n    console.log('[PublishModal] Initialize when component mounted')\n    initializeFormData()\n    await loadCoordinatorToolData()\n    await loadParameterRequirements()\n  }\n})\n\n// Expose methods for parent component\ndefineExpose({\n  loadParameterRequirements\n})\n</script>\n\n<style scoped>\n/* Wide modal styles */\n:deep(.wide-modal .modal-container) {\n  width: 90%;\n  max-width: 900px !important; /* Adjust width to 900px */\n}\n\n/* Form layout optimization - reference new Model modal styles */\n.modal-form {\n  display: flex;\n  flex-direction: column;\n  gap: 16px; /* Adjust to 16px, consistent with new Model modal */\n  width: 100%;\n}\n\n.form-section {\n  display: flex;\n  flex-direction: column;\n  gap: 8px; /* Adjust to 8px, optimize title and input spacing */\n  width: 100%;\n}\n\n.section-title {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  padding-bottom: 8px;\n}\n\n.form-item {\n  display: flex;\n  flex-direction: column;\n  gap: 8px; /* Adjust to 8px, optimize title and input spacing */\n}\n\n.form-item label {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  margin: 0; /* Remove default margin */\n}\n\n.required {\n  color: #ff6b6b;\n}\n\n/* Field description styles */\n.field-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  margin-top: 4px;\n  line-height: 1.4;\n  font-style: italic;\n}\n\n.form-item input,\n.form-item textarea {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n  font-family: inherit;\n  box-sizing: border-box;\n  min-height: 48px; /* Ensure consistent minimum height */\n}\n\n.form-item input {\n  height: 48px; /* Single line input fixed height */\n}\n\n.form-item input:focus,\n.form-item textarea:focus {\n  border-color: #667eea;\n  outline: none;\n  background: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);\n}\n\n.form-item input::placeholder,\n.form-item textarea::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n\n.description-field {\n  resize: vertical;\n  min-height: 80px;\n  line-height: 1.5;\n  width: 100%;\n}\n\n/* Parameter Requirements Help Text */\n.params-help-text {\n  margin-bottom: 12px;\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  padding: 6px 8px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 4px;\n}\n\n/* Parameter table responsive */\n.parameter-table {\n  margin-bottom: 16px;\n  width: 100%;\n  overflow-x: auto;\n}\n\n.parameter-table table {\n  width: 100%;\n  border-collapse: collapse;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  overflow: hidden;\n  min-width: 600px;\n}\n\n.parameter-table th {\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: 500;\n  padding: 12px;\n  text-align: left;\n  font-size: 14px;\n  white-space: nowrap;\n}\n\n.parameter-table td {\n  padding: 8px 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.parameter-input {\n  width: 100%;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n}\n\n.parameter-input:focus {\n  border-color: #667eea;\n  outline: none;\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.readonly-input {\n  background: rgba(255, 255, 255, 0.02) !important;\n  color: rgba(255, 255, 255, 0.6) !important;\n  cursor: not-allowed;\n  border-color: rgba(255, 255, 255, 0.05) !important;\n}\n\n\n/* Delete and add button styles removed */\n\n/* Endpoint component responsive - supports manual input */\n.custom-dropdown {\n  position: relative;\n  width: 100%;\n}\n\n.dropdown-input {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  box-sizing: border-box;\n  height: 48px; /* Ensure consistent height with other inputs */\n}\n\n.dropdown-input input {\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #fff;\n  font-size: 14px;\n  width: 100%;\n  cursor: text; /* Allow text input */\n  height: 100%;\n  padding: 0;\n}\n\n.dropdown-input input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.dropdown-input.active {\n  border-color: #667eea;\n  outline: none;\n  background-color: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);\n  transform: translateY(-1px);\n}\n\n.dropdown-input:hover {\n  border-color: rgba(255, 255, 255, 0.2);\n  background-color: rgba(255, 255, 255, 0.07);\n  transform: translateY(-1px);\n}\n\n.dropdown-arrow {\n  transition: transform 0.3s ease;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 16px;\n  flex-shrink: 0;\n  margin-left: 8px;\n}\n\n.dropdown-arrow.rotated {\n  transform: rotate(180deg);\n}\n\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: 100%;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n  max-height: 200px;\n  overflow-y: auto;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(10px);\n  z-index: 10;\n  margin-top: 4px;\n}\n\n.dropdown-item {\n  padding: 12px 16px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.dropdown-item:last-child {\n  border-bottom: none;\n}\n\n.dropdown-item:hover {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(102, 126, 234, 0.1));\n  color: #a8b3ff;\n  transform: translateX(4px);\n}\n\n.dropdown-item.selected {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(102, 126, 234, 0.2));\n  color: #a8b3ff;\n  font-weight: 500;\n}\n\n.dropdown-item.custom-input {\n  color: rgba(255, 255, 255, 0.6);\n  font-style: italic;\n  padding-left: 16px; /* Align with other items */\n}\n\n.dropdown-item.custom-input .custom-label {\n  color: rgba(255, 255, 255, 0.6);\n  margin-right: 4px;\n}\n\n/* Button container - reference screenshot styles */\n.button-container {\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n  margin-top: 0;\n  align-items: center;\n  padding: 16px 0;\n  min-height: 52px; /* Ensure container has fixed height, prevent jitter */\n  position: relative; /* Provide reference for absolutely positioned child elements */\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 14px;\n}\n\n.action-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.action-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.action-btn.primary {\n  background: rgba(102, 126, 234, 0.2);\n  border-color: rgba(102, 126, 234, 0.3);\n  color: #a8b3ff;\n}\n\n.action-btn.primary:hover:not(:disabled) {\n  background: rgba(102, 126, 234, 0.3);\n}\n\n.action-btn.danger {\n  background: rgba(234, 102, 102, 0.2);\n  border-color: rgba(234, 102, 102, 0.3);\n  color: #ff6b6b;\n}\n\n.action-btn.danger:hover:not(:disabled) {\n  background: rgba(234, 102, 102, 0.3);\n}\n\n.action-btn.danger:disabled {\n  background: rgba(234, 102, 102, 0.1);\n  border-color: rgba(234, 102, 102, 0.2);\n  color: rgba(255, 107, 107, 0.5);\n  cursor: not-allowed;\n}\n\n/* Read-only input styles */\n.readonly-input {\n  background: rgba(255, 255, 255, 0.03) !important;\n  color: rgba(255, 255, 255, 0.7) !important;\n  cursor: not-allowed !important;\n  opacity: 0.8;\n}\n\n.readonly-input::placeholder {\n  color: rgba(255, 255, 255, 0.4) !important;\n}\n\n/* Endpoint container layout */\n.endpoint-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n\n.endpoint-row {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  width: 100%;\n}\n\n/* Custom dropdown styles - reference screenshot three */\n.custom-select {\n  position: relative;\n  display: inline-block;\n  width: 100%; /* Adjust to 100% to fit new layout */\n  flex-shrink: 0;\n}\n\n.select-input-container {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  background: rgba(20, 20, 25, 0.95);\n  border: 2px solid rgba(102, 126, 234, 0.6);\n  border-radius: 12px;\n  color: #667eea;\n  transition: all 0.3s ease;\n  font-size: 14px;\n  font-weight: 600;\n  outline: none;\n  width: 100%;\n  justify-content: space-between;\n  height: 44px;\n  box-sizing: border-box;\n  box-shadow: 0 0 0 1px rgba(102, 126, 234, 0.3);\n  padding: 0 12px;\n}\n\n.select-input-container:hover {\n  border-color: rgba(102, 126, 234, 0.8);\n  background-color: rgba(20, 20, 25, 0.98);\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.4);\n}\n\n.select-input-container:focus-within {\n  border-color: rgba(102, 126, 234, 0.9);\n  outline: none;\n  background-color: rgba(20, 20, 25, 0.98);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);\n}\n\n.input-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  min-width: 0;\n}\n\n.input-icon {\n  color: #667eea;\n  flex-shrink: 0;\n}\n\n.select-input {\n  flex: 1;\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #667eea;\n  font-size: 14px;\n  font-weight: 600;\n  text-shadow: none;\n  display: flex;\n  align-items: center;\n  gap: 0;\n  min-width: 0;\n  height: 100%;\n}\n\n.select-input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.select-arrow-btn {\n  background: none;\n  border: none;\n  color: #667eea;\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 6px;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n}\n\n.select-arrow-btn:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.chevron {\n  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  opacity: 0.9;\n  filter: none;\n  width: 16px;\n  height: 16px;\n}\n\n.select-dropdown {\n  position: absolute;\n  top: 100%;\n  z-index: 99999;\n  margin-top: 6px;\n  background: rgba(15, 15, 20, 0.98);\n  backdrop-filter: blur(20px);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 12px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);\n  width: 280px; /* Keep consistent with select-btn width */\n  max-height: 280px;\n  overflow: hidden;\n  /* Ensure not occupying document flow */\n  pointer-events: auto;\n}\n\n.select-dropdown.dropdown-top {\n  top: auto;\n  bottom: 100%;\n  margin-top: 0;\n  margin-bottom: 4px;\n}\n\n.dropdown-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 14px 18px;\n  border-bottom: 1px solid rgba(102, 126, 234, 0.2);\n  font-size: 14px;\n  font-weight: 600;\n  color: #667eea;\n  background: rgba(102, 126, 234, 0.05);\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.select-options {\n  padding: 12px 0;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.select-option {\n  display: flex;\n  align-items: center;\n  gap: 0;\n  width: 100%;\n  padding: 12px 18px;\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  text-align: left;\n  font-size: 14px;\n}\n\n.select-option:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.select-option.active {\n  background: rgba(102, 126, 234, 0.2);\n  color: #667eea;\n  border-left: 3px solid #667eea;\n  padding-left: 15px;\n  font-weight: 500;\n}\n\n.select-option.custom-input {\n  color: rgba(255, 255, 255, 0.6);\n  font-style: italic;\n}\n\n.select-option.custom-input .custom-label {\n  color: rgba(255, 255, 255, 0.6);\n  margin-right: 4px;\n}\n\n.option-name {\n  flex: 1;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.check-icon {\n  color: #667eea;\n  opacity: 0.8;\n}\n\n/* Manual input area styles */\n.manual-input-section {\n  padding: 14px 18px;\n  border-top: 1px solid rgba(102, 126, 234, 0.2);\n  background: rgba(102, 126, 234, 0.03);\n}\n\n.manual-input-container {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  width: 100%;\n}\n\n.manual-input {\n  flex: 1;\n  padding: 8px 12px;\n  background: rgba(20, 20, 25, 0.8);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #667eea;\n  font-size: 14px;\n  transition: all 0.3s ease;\n}\n\n.manual-input:focus {\n  border-color: rgba(102, 126, 234, 0.8);\n  outline: none;\n  background: rgba(20, 20, 25, 0.9);\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.manual-input::placeholder {\n  color: rgba(102, 126, 234, 0.5);\n}\n\n.add-manual-btn {\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.15);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #667eea;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.add-manual-btn:hover {\n  background: rgba(102, 126, 234, 0.25);\n  border-color: rgba(102, 126, 234, 0.5);\n}\n\n/* Service publishing option styles */\n.service-publish-options {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.mcp-publish-option,\n.http-publish-option,\n.internal-toolcall-publish-option {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding: 16px;\n  background: rgba(255, 255, 255, 0.03);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n}\n\n/* .http-publish-option, .mcp-publish-option, .internal-toolcall-publish-option now use the same styles */\n\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  user-select: none;\n}\n\n.checkbox-input {\n  width: 16px;\n  height: 16px;\n  accent-color: #667eea;\n  cursor: pointer;\n}\n\n.checkbox-text {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n}\n\n.checkbox-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  margin-left: 24px;\n}\n\n/* HTTP service options now use the same styles as MCP service, no special handling needed */\n\n\n.endpoint-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  margin-bottom: 8px;\n}\n\n/* Two-column layout styles */\n.endpoint-url-row {\n  display: flex;\n  gap: 16px;\n  width: 100%;\n}\n\n.endpoint-url-row.single-item {\n  gap: 0;\n}\n\n.endpoint-url-row.single-item .endpoint-item {\n  flex: 0 0 50%; /* Maintain 50% width even when displayed alone */\n}\n\n.endpoint-item {\n  flex: 0 0 50%; /* Fixed width 50%, not responsive */\n  min-width: 0;\n}\n\n.url-item {\n  flex: 1;\n  min-width: 0;\n}\n\n/* URL display styles */\n.url-container {\n  width: 100%;\n}\n\n.url-display {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  min-height: 48px;\n}\n\n.url-display:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.url-text {\n  flex: 1;\n  font-size: 14px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  word-break: break-all;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.copy-icon {\n  color: rgba(255, 255, 255, 0.6);\n  margin-left: 8px;\n  flex-shrink: 0;\n  transition: all 0.3s ease;\n}\n\n.url-display:hover .copy-icon {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n\n.backdrop {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 99998;\n  background: transparent;\n}\n\n\n\n\n\n.slideDown-enter-active,\n.slideDown-leave-active {\n  transition: all 0.2s ease;\n  transform-origin: top;\n}\n\n.slideDown-enter-from,\n.slideDown-leave-to {\n  opacity: 0;\n  transform: translateY(-8px) scale(0.95);\n}\n\n\n\n/* Old save button styles removed */\n\n\n\n\n\n\n\n.loading-icon {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Required field styles */\n.required {\n  color: #ff4d4f;\n  margin-left: 4px;\n}\n\n/* Error state styles */\n.form-item input.error,\n.form-item textarea.error {\n  border-color: #ff4d4f;\n  box-shadow: 0 0 0 2px rgba(255, 77, 79, 0.1);\n}\n\n.form-item input.error:focus,\n.form-item textarea.error:focus {\n  border-color: #ff4d4f;\n  box-shadow: 0 0 0 2px rgba(255, 77, 79, 0.2);\n}\n\n/* Tooltip messages */\n.error-toast,\n.success-toast {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  border-radius: 8px;\n  color: #fff;\n  cursor: pointer;\n  z-index: 10000; /* Ensure above modal */\n  animation: slideIn 0.3s ease;\n}\n\n.error-toast {\n  background: rgba(234, 102, 102, 0.9);\n  border: 1px solid rgba(234, 102, 102, 0.5);\n}\n\n.success-toast {\n  background: rgba(102, 234, 102, 0.9);\n  border: 1px solid rgba(102, 234, 102, 0.5);\n}\n\n@keyframes slideIn {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n\n\n</style> \n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * File information interface matching FileUploadResult.FileInfo from Java\n */\nexport interface FileInfo {\n  originalName: string\n  size: number\n  type: string\n  uploadTime: string\n  success: boolean\n  error?: string\n}\n\n/**\n * File upload result interface matching FileUploadResult from Java\n */\nexport interface FileUploadResult {\n  success: boolean\n  message: string\n  uploadKey: string\n  uploadedFiles: FileInfo[]\n  totalFiles: number\n  successfulFiles: number\n  failedFiles: number\n}\n\n/**\n * Get uploaded files response interface\n */\nexport interface GetUploadedFilesResponse {\n  success: boolean\n  uploadKey: string\n  files: FileInfo[]\n  totalCount: number\n}\n\n/**\n * Delete file response interface\n */\nexport interface DeleteFileResponse {\n  success: boolean\n  message?: string\n  error?: string\n  uploadKey: string\n  fileName: string\n}\n\n/**\n * Upload configuration interface\n */\nexport interface UploadConfig {\n  success: boolean\n  maxFileSize: string\n  maxFiles: number\n  allowedTypes: string[]\n}\n\nexport class FileUploadApiService {\n  \n  /**\n   * Upload files\n   * @param files Files to upload\n   * @returns FileUploadResult with upload information\n   */\n  public static async uploadFiles(files: File[]): Promise<FileUploadResult> {\n    try {\n      console.log('[FileUploadApiService] Uploading files:', files.length)\n      \n      const formData = new FormData()\n      files.forEach(file => {\n        formData.append('files', file)\n      })\n      \n      const response = await fetch('/api/file-upload/upload', {\n        method: 'POST',\n        body: formData,\n      })\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: FileUploadResult = await response.json()\n      console.log('[FileUploadApiService] Files uploaded successfully:', result.successfulFiles, 'uploadKey:', result.uploadKey)\n      return result\n      \n    } catch (error) {\n      console.error('[FileUploadApiService] Error uploading files:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get uploaded files for a specific upload key\n   * @param uploadKey Upload key to get files for\n   * @returns GetUploadedFilesResponse with file information\n   */\n  public static async getUploadedFiles(uploadKey: string): Promise<GetUploadedFilesResponse> {\n    try {\n      console.log('[FileUploadApiService] Getting uploaded files for uploadKey:', uploadKey)\n      \n      const response = await fetch(`/api/file-upload/files/${encodeURIComponent(uploadKey)}`)\n      \n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: GetUploadedFilesResponse = await response.json()\n      console.log('[FileUploadApiService] Got uploaded files:', result.totalCount, 'for uploadKey:', uploadKey)\n      return result\n      \n    } catch (error) {\n      console.error('[FileUploadApiService] Error getting uploaded files:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Delete an uploaded file from a specific upload key directory\n   * @param uploadKey Upload key directory\n   * @param fileName File name to delete\n   * @returns DeleteFileResponse with deletion result\n   */\n  public static async deleteFile(uploadKey: string, fileName: string): Promise<DeleteFileResponse> {\n    try {\n      console.log('[FileUploadApiService] Deleting file:', fileName, 'from uploadKey:', uploadKey)\n      \n      const response = await fetch(`/api/file-upload/files/${encodeURIComponent(uploadKey)}/${encodeURIComponent(fileName)}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: DeleteFileResponse = await response.json()\n      console.log('[FileUploadApiService] File deleted successfully:', result.success)\n      return result\n      \n    } catch (error) {\n      console.error('[FileUploadApiService] Error deleting file:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get upload configuration and limits\n   * @returns UploadConfig with configuration information\n   */\n  public static async getUploadConfig(): Promise<UploadConfig> {\n    try {\n      console.log('[FileUploadApiService] Getting upload configuration')\n      \n      const response = await fetch('/api/file-upload/config')\n      \n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: UploadConfig = await response.json()\n      console.log('[FileUploadApiService] Got upload configuration:', result)\n      return result\n      \n    } catch (error) {\n      console.error('[FileUploadApiService] Error getting upload configuration:', error)\n      throw error\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"file-upload-component\">\n    <!-- Hidden file input -->\n    <input\n      ref=\"fileInputRef\"\n      type=\"file\"\n      multiple\n      style=\"display: none\"\n      @change=\"handleFileChange\"\n      :accept=\"acceptedFileTypes || ''\"\n    />\n\n    <!-- Uploaded files display with integrated upload button -->\n    <div class=\"uploaded-files\" :class=\"{ 'has-files': uploadedFiles.length > 0 }\">\n      <div class=\"files-header\" @click=\"handleFileUpload\">\n        <Icon icon=\"carbon:attachment\" />\n        <span v-if=\"uploadedFiles.length === 0\">{{ t('input.attachFile') }}</span>\n        <span v-else>{{ t('input.attachedFiles') }} ({{ uploadedFiles.length }})</span>\n      </div>\n      <div v-if=\"uploadedFiles.length > 0\" class=\"files-list\">\n        <div v-for=\"file in uploadedFiles\" :key=\"file.originalName\" class=\"file-item\">\n          <Icon icon=\"carbon:document\" class=\"file-icon\" />\n          <span class=\"file-name\">{{ file.originalName }}</span>\n          <span class=\"file-size\">({{ formatFileSize(file.size) }})</span>\n          <button @click=\"removeFile(file)\" class=\"remove-btn\" :title=\"t('input.removeFile')\">\n            <Icon icon=\"carbon:close\" />\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Upload progress indicator -->\n    <div v-if=\"isUploading\" class=\"upload-progress\">\n      <Icon icon=\"carbon:rotate--clockwise\" class=\"loading-icon\" />\n      <span>{{ t('input.uploading') }}</span>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onUnmounted, watch } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { useI18n } from 'vue-i18n'\nimport { FileInfo, FileUploadApiService, type DeleteFileResponse, type FileUploadResult } from \"@/api/file-upload-api-service\"\n\nconst { t } = useI18n()\n\ntype FileUploadProps = {\n  acceptedFileTypes?: string\n  disabled?: boolean\n}\n\ninterface Emits {\n  (e: 'files-uploaded', files: FileInfo[], uploadKey: string | null): void\n  (e: 'files-removed', files: FileInfo[]): void\n  (e: 'upload-key-changed', uploadKey: string | null): void\n  (e: 'upload-started'): void\n  (e: 'upload-completed'): void\n  (e: 'upload-error', error: any): void\n}\n\nconst props = withDefaults(defineProps<FileUploadProps>(), {\n  acceptedFileTypes: '.pdf,.txt,.md,.doc,.docx,.csv,.xlsx,.xls,.json,.xml,.html,.htm,.log,.java,.py,.js,.ts,.sql,.sh,.bat,.yaml,.yml,.properties,.conf,.ini,.jpg,.jpeg,.png,.gif',\n  disabled: false\n})\n\nconst emit = defineEmits<Emits>()\n\n// Reactive state\nconst fileInputRef = ref<HTMLInputElement>()\nconst uploadedFiles = ref<FileInfo[]>([])\nconst isUploading = ref(false)\nconst uploadKey = ref<string | null>(null)\n\n// Function to reset session when starting a new conversation session\nconst resetSession = () => {\n  console.log('[FileUpload] Resetting session and clearing uploadKey')\n  uploadedFiles.value = []\n  uploadKey.value = null\n  emit('upload-key-changed', null)\n}\n\n// Auto-reset session when component is unmounted to prevent memory leaks\nonUnmounted(() => {\n  resetSession()\n})\n\n// Watch for file changes to emit events\nwatch(() => uploadedFiles.value, (newFiles) => {\n  emit('files-removed', newFiles)\n}, { deep: true })\n\n// File upload handlers\nconst handleFileUpload = () => {\n  if (props.disabled) return\n  if (fileInputRef.value) {\n    fileInputRef.value.click()\n  }\n}\n\nconst handleFileChange = async (event: Event) => {\n  const target = event.target as HTMLInputElement\n  const files = target.files\n\n  if (!files || files.length === 0) return\n\n  // Convert FileList to Array and add to pending files (for batch upload)\n  const fileArray = Array.from(files)\n  console.log('[FileUpload] Selected files for upload:', fileArray.map(f => f.name))\n\n  // Immediately upload all selected files\n  await uploadFiles(fileArray)\n\n  // Reset file input\n  target.value = ''\n}\n\nconst uploadFiles = async (files: File[]) => {\n  if (files.length === 0) return\n\n  isUploading.value = true\n  emit('upload-started')\n\n  try {\n    // Upload files using the new API service\n    const result: FileUploadResult = await FileUploadApiService.uploadFiles(files)\n\n    if (result.success) {\n      // Set uploadKey for file management\n      if (!uploadKey.value && result.uploadKey) {\n        uploadKey.value = result.uploadKey\n        console.log('[FileUpload] Set uploadKey:', uploadKey.value)\n        // New upload session - replace entire array\n        uploadedFiles.value = result.uploadedFiles\n      } else if (uploadKey.value) {\n        console.log('[FileUpload] Using existing uploadKey:', uploadKey.value)\n        // Existing upload session - append to existing files\n        uploadedFiles.value = [...uploadedFiles.value, ...result.uploadedFiles]\n      } else {\n        console.warn('[FileUpload] No uploadKey returned from upload')\n        // Fallback - replace entire array\n        uploadedFiles.value = result.uploadedFiles\n      }\n\n      // Save uploadKey locally\n      if (result.uploadKey) {\n        uploadKey.value = result.uploadKey\n        console.log('[Input] Saved uploadKey locally:', result.uploadKey)\n        emit('upload-key-changed', uploadKey.value)\n      }\n\n      console.log('[Input] Updated global uploadedFiles state:', uploadedFiles.value)\n\n      // Emit files uploaded event\n      emit('files-uploaded', uploadedFiles.value, uploadKey.value)\n    }\n\n    // Show success message or update UI as needed\n    console.log('Files uploaded successfully:', result)\n    emit('upload-completed')\n\n  } catch (error) {\n    console.error('File upload error:', error)\n    emit('upload-error', error)\n  } finally {\n    isUploading.value = false\n  }\n}\n\n// File management functions\nconst removeFile = async (fileToRemove: FileInfo) => {\n  try {\n    console.log('🗑️ Removing file:', fileToRemove.originalName, 'from uploadKey:', uploadKey)\n\n    // Call backend API to delete the file from the server\n    if (uploadKey.value) {\n      const result: DeleteFileResponse = await FileUploadApiService.deleteFile(uploadKey.value, fileToRemove.originalName)\n      if (result.success) {\n        console.log('✅ File deleted from server successfully')\n      } else {\n        console.error('❌ Failed to delete file from server:', result.error)\n      }\n    }\n\n    // Update frontend state\n    uploadedFiles.value = uploadedFiles.value.filter(file => file.originalName !== fileToRemove.originalName)\n\n    // Clear uploadKey to force new plan for new files if no files remain\n    if (uploadedFiles.value.length === 0) {\n      console.log('[FileUpload] 🧹 Clearing uploadKey to force new plan for new files')\n      uploadKey.value = null\n      emit('upload-key-changed', null)\n    }\n\n    console.log('🎉 File removal completed, remaining files:', uploadedFiles.value.length)\n\n  } catch (error) {\n    console.error('❌ Error removing file:', error)\n    emit('upload-error', error)\n  }\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 Bytes'\n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n\n// Expose methods and state to parent component\ndefineExpose({\n  uploadedFiles,\n  uploadKey,\n  resetSession,\n  uploadFiles,\n  removeFile,\n  isUploading\n})\n</script>\n\n<style lang=\"less\" scoped>\n.file-upload-component {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n\n/* File upload styles */\n.uploaded-files {\n  padding: 8px;\n  border-radius: 8px;\n  transition: all 0.2s ease;\n  width: 100%;\n  box-sizing: border-box;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n\n  &.has-files {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.15);\n  }\n}\n\n.files-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.7);\n  font-weight: 500;\n  cursor: pointer;\n  padding: 4px 2px;\n  transition: all 0.2s ease;\n  user-select: none;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #007acc;\n  }\n\n  &:active {\n    transform: translateY(1px);\n  }\n}\n\n.files-list {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.file-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 6px 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 6px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.file-icon {\n  font-size: 14px;\n  color: #007acc;\n  flex-shrink: 0;\n}\n\n.file-name {\n  flex: 1;\n  font-size: 13px;\n  color: #ffffff;\n  font-weight: 500;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.file-size {\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.6);\n  flex-shrink: 0;\n}\n\n.remove-btn {\n  background: none;\n  border: none;\n  padding: 2px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.5);\n  transition: all 0.2s ease;\n  border-radius: 3px;\n  flex-shrink: 0;\n\n  &:hover {\n    color: #ff6b6b;\n    background: rgba(255, 107, 107, 0.1);\n  }\n}\n\n.upload-progress {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  background: rgba(0, 122, 204, 0.1);\n  border-radius: 6px;\n  border: 1px solid rgba(0, 122, 204, 0.2);\n  font-size: 12px;\n  color: #007acc;\n}\n\n.loading-icon {\n  font-size: 14px;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:play\" width=\"16\" />\n      <span>{{ t('sidebar.executionController') }}</span>\n    </div>\n    <div class=\"execution-content\">\n      <!-- Parameter Requirements Display -->\n      <div class=\"params-requirements-group\">\n        <label>{{ t('sidebar.parameterRequirements') }}</label>\n        <div class=\"params-help-text\">\n          {{ t('sidebar.parameterRequirementsHelp') }}\n        </div>\n        \n        <!-- Show parameter fields only if there are parameters -->\n        <div v-if=\"parameterRequirements.hasParameters\" class=\"parameter-fields\">\n          <div\n            v-for=\"param in parameterRequirements.parameters\"\n            :key=\"param\"\n            class=\"parameter-field\"\n          >\n            <label class=\"parameter-label\">\n              {{ param }}\n              <span class=\"required\">*</span>\n            </label>\n            <input\n              v-model=\"parameterValues[param]\"\n              class=\"parameter-input\"\n              :class=\"{ 'error': parameterErrors[param] }\"\n              :placeholder=\"t('sidebar.enterValueFor', { param })\"\n              @input=\"updateParameterValue(param, ($event.target as HTMLInputElement).value)\"\n              required\n            />\n            <div v-if=\"parameterErrors[param]\" class=\"parameter-error\">\n              {{ parameterErrors[param] }}\n            </div>\n          </div>\n        </div>\n        \n        <!-- Validation status message -->\n        <div v-if=\"parameterRequirements.hasParameters && !canExecute && !props.isExecuting && !props.isGenerating\" class=\"validation-message\">\n          <Icon icon=\"carbon:warning\" width=\"14\" />\n          {{ t('sidebar.fillAllRequiredParameters') }}\n        </div>\n        \n      </div>\n      \n      <!-- File Upload Component -->\n      <FileUploadComponent\n        ref=\"fileUploadRef\"\n        :disabled=\"props.isExecuting || props.isGenerating\"\n        @files-uploaded=\"handleFilesUploaded\"\n        @files-removed=\"handleFilesRemoved\"\n        @upload-key-changed=\"handleUploadKeyChanged\"\n        @upload-started=\"handleUploadStarted\"\n        @upload-completed=\"handleUploadCompleted\"\n        @upload-error=\"handleUploadError\"\n      />\n      \n      <button\n        class=\"btn btn-primary execute-btn\"\n        @click=\"handleExecutePlan\"\n        :disabled=\"!canExecute\"\n      >\n        <Icon\n          :icon=\"props.isExecuting ? 'carbon:circle-dash' : 'carbon:play'\"\n          width=\"16\"\n          :class=\"{ spinning: props.isExecuting }\"\n        />\n        {{ props.isExecuting ? t('sidebar.executing') : t('sidebar.executePlan') }}\n      </button>\n      <button\n        class=\"btn publish-mcp-btn\"\n        @click=\"handlePublishMcpService\"\n        :disabled=\"!currentPlanTemplateId\"\n        v-if=\"showPublishButton\"\n      >\n        <Icon icon=\"carbon:application\" width=\"16\" />\n        {{ buttonText }}\n      </button>\n      \n      <!-- Internal Call wrapper - only show when enableInternalToolcall is true -->\n      <div v-if=\"toolInfo?.enableInternalToolcall\" class=\"call-example-wrapper\">\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.internalCall') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.internalCallDescription') }}</p>\n        </div>\n        <div class=\"internal-call-wrapper\">\n          <div class=\"call-info\">\n            <div class=\"call-method\">{{ t('sidebar.internalMethodCall') }}</div>\n            <div class=\"call-endpoint\">{{ t('sidebar.toolName') }}: {{ toolInfo?.toolName || currentPlanTemplateId }}</div>\n            <div v-if=\"toolInfo?.serviceGroup\" class=\"call-endpoint\">{{ t('sidebar.serviceGroup') }}: {{ toolInfo.serviceGroup }}</div>\n            <div class=\"call-description\">{{ t('sidebar.internalCallUsage') }}</div>\n            <div class=\"call-example\">\n              <strong>{{ t('sidebar.usage') }}:</strong>\n              <pre class=\"example-code\">{{ t('sidebar.internalCallExample') }}</pre>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- HTTP API URLs wrapper with tabs - only show when enableHttpService is true -->\n      <div v-if=\"toolInfo?.enableHttpService\" class=\"call-example-wrapper\">\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.httpCallExample') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.httpCallDescription') }}</p>\n        </div>\n        <div class=\"http-api-urls-wrapper\">\n          <div class=\"tab-container\">\n            <div class=\"tab-header\">\n              <button \n                v-for=\"tab in apiTabs\" \n                :key=\"tab.id\"\n                :class=\"['tab-button', { active: activeTab === tab.id }]\"\n                @click=\"activeTab = tab.id\"\n              >\n                {{ tab.label }}\n              </button>\n            </div>\n            <div class=\"tab-content\">\n              <div v-for=\"tab in apiTabs\" :key=\"tab.id\" v-show=\"activeTab === tab.id\" class=\"tab-panel\">\n                <div class=\"http-api-url-display\">\n                  <div class=\"api-method\">{{ tab.method }}</div>\n                  <div class=\"api-endpoint\">{{ tab.endpoint }}</div>\n                  <div class=\"api-description\">{{ tab.description }}</div>\n                  <div v-if=\"tab.example\" class=\"api-example\">\n                    <strong>{{ t('sidebar.example') }}:</strong>\n                    <pre class=\"example-code\">{{ tab.example }}</pre>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- MCP Call wrapper - only show when enableMcpService is true -->\n      <div v-if=\"toolInfo?.enableMcpService\" class=\"call-example-wrapper\">\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.mcpCall') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.mcpCallDescription') }}</p>\n        </div>\n        <div class=\"mcp-call-wrapper\">\n          <div class=\"call-info\">\n            <div class=\"call-method\">{{ t('sidebar.mcpServiceCall') }}</div>\n            <div class=\"call-endpoint\">{{ t('sidebar.mcpEndpoint') }}: /mcp/execute</div>\n            <div class=\"call-description\">{{ t('sidebar.mcpCallUsage') }}</div>\n            <div class=\"call-example\">\n              <strong>{{ t('sidebar.usage') }}:</strong>\n              <pre class=\"example-code\">{{ t('sidebar.mcpCallExample') }}</pre>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, onMounted, computed } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { useI18n } from 'vue-i18n'\nimport { PlanParameterApiService, type ParameterRequirements } from '@/api/plan-parameter-api-service'\nimport type { CoordinatorToolVO } from '@/api/coordinator-tool-api-service'\nimport { FileInfo } from '@/api/file-upload-api-service'\nimport FileUploadComponent from '@/components/file-upload/FileUploadComponent.vue'\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution'\n\nconst { t } = useI18n()\n\n\n// Props\ninterface Props {\n  currentPlanTemplateId?: string\n  isExecuting?: boolean\n  isGenerating?: boolean\n  showPublishButton?: boolean\n  toolInfo?: CoordinatorToolVO\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  currentPlanTemplateId: '',\n  isExecuting: false,\n  isGenerating: false,\n  showPublishButton: true,\n  toolInfo: () => ({\n    toolName: '',\n    toolDescription: '',\n    planTemplateId: '',\n    inputSchema: '[]',\n    enableHttpService: false,\n    enableMcpService: false,\n    enableInternalToolcall: false,\n    serviceGroup: ''\n  })\n})\n\n// Emits\nconst emit = defineEmits<{\n  executePlan: [payload: PlanExecutionRequestPayload]\n  publishMcpService: []\n  clearParams: []\n  updateExecutionParams: [params: string]\n}>()\n\n// Local state\nconst executionParams = ref('')\nconst parameterRequirements = ref<ParameterRequirements>({\n  parameters: [],\n  hasParameters: false,\n  requirements: ''\n})\nconst parameterValues = ref<Record<string, string>>({})\nconst isLoadingParameters = ref(false)\nconst activeTab = ref('get-sync')\nconst parameterErrors = ref<Record<string, string>>({})\nconst isValidationError = ref(false)\nconst isExecutingPlan = ref(false) // Flag to prevent parameter reload during execution\n\n// File upload state\nconst fileUploadRef = ref<InstanceType<typeof FileUploadComponent>>()\nconst uploadedFiles = ref<string[]>([])\nconst uploadKey = ref<string | null>(null)\n\n// API tabs configuration\nconst apiTabs = ref([\n  {\n    id: 'get-sync',\n    label: 'GET + Sync',\n    method: 'GET',\n    endpoint: '/api/executor/executeByToolNameSync/{toolName}',\n    description: 'Synchronous GET request - returns execution result immediately',\n    example: `GET /api/executor/executeByToolNameSync/my-tool?allParams={\"rawParam\":\"test\"}\nResponse: {\n  \"status\": \"completed\",\n  \"result\": \"Execution result here\"\n}`\n  },\n  {\n    id: 'post-sync',\n    label: 'POST + Sync',\n    method: 'POST',\n    endpoint: '/api/executor/executeByToolNameSync',\n    description: 'Synchronous POST request - returns execution result immediately',\n    example: `POST /api/executor/executeByToolNameSync\nContent-Type: application/json\n\n{\n  \"toolName\": \"my-tool\",\n  \"replacementParams\": {\n    \"rawParam\": \"test\"\n  },\n  \"uploadedFiles\": []\n}\n\nResponse: {\n  \"status\": \"completed\",\n  \"result\": \"Execution result here\"\n}`\n  },\n  {\n    id: 'post-async',\n    label: 'POST + Async',\n    method: 'POST',\n    endpoint: '/api/executor/executeByToolNameAsync',\n    description: 'Asynchronous POST request - returns task ID, check status separately',\n    example: `POST /api/executor/executeByToolNameAsync\nContent-Type: application/json\n\n{\n  \"toolName\": \"my-tool\",\n  \"replacementParams\": {\n    \"rawParam\": \"test\"\n  },\n  \"uploadedFiles\": []\n}\n\nResponse: {\n  \"planId\": \"plan-123\",\n  \"status\": \"processing\",\n  \"message\": \"Task submitted, processing\",\n  \"memoryId\": \"ABC12345\",\n  \"toolName\": \"my-tool\",\n  \"planTemplateId\": \"template-456\"\n}\n\n# Check execution status and get detailed results:\nGET /api/executor/details/{planId}\nResponse: {\n  \"currentPlanId\": \"plan-123\",\n  \"title\": \"Plan Title\",\n  \"status\": \"completed\",\n  \"summary\": \"Execution completed successfully\",\n  \"agentExecutionSequence\": [...],\n  \"userInputWaitState\": null\n}`\n  }\n])\n\n// Computed properties\nconst isAnyServiceEnabled = computed(() => {\n  return props.toolInfo.enableInternalToolcall ?? \n         props.toolInfo.enableHttpService ?? \n         props.toolInfo.enableMcpService\n})\n\nconst buttonText = computed(() => {\n  return isAnyServiceEnabled.value ? t('sidebar.updateServiceStatus') : t('sidebar.publishMcpService')\n})\n\nconst canExecute = computed(() => {\n  if (props.isExecuting || props.isGenerating) {\n    return false\n  }\n  \n  if (parameterRequirements.value.hasParameters) {\n    // Check if all required parameters are filled\n    return parameterRequirements.value.parameters.every(param => \n      parameterValues.value[param].trim()\n    )\n  }\n  \n  return true\n})\n\n// File upload event handlers\nconst handleFilesUploaded = (files: FileInfo[], key: string | null) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  uploadKey.value = key\n  console.log('[ExecutionController] Files uploaded:', files.length, 'uploadKey:', key)\n}\n\nconst handleFilesRemoved = (files: FileInfo[]) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  console.log('[ExecutionController] Files removed, remaining:', files.length)\n}\n\nconst handleUploadKeyChanged = (key: string | null) => {\n  uploadKey.value = key\n  console.log('[ExecutionController] Upload key changed:', key)\n}\n\nconst handleUploadStarted = () => {\n  console.log('[ExecutionController] Upload started')\n}\n\nconst handleUploadCompleted = () => {\n  console.log('[ExecutionController] Upload completed')\n}\n\nconst handleUploadError = (error: any) => {\n  console.error('[ExecutionController] Upload error:', error)\n}\n\n// Methods\nconst handleExecutePlan = () => {\n  console.log('[ExecutionController] 🚀 Execute button clicked')\n  \n  // Set execution flag to prevent parameter reload\n  isExecutingPlan.value = true\n  console.log('[ExecutionController] 🔒 Set isExecutingPlan to true')\n  \n  // Validate parameters before execution\n  if (!validateParameters()) {\n    console.log('[ExecutionController] ❌ Parameter validation failed:', parameterErrors.value)\n    isExecutingPlan.value = false // Reset flag on validation failure\n    return\n  }\n  \n  // Pass replacement parameters if available\n  const replacementParams = parameterRequirements.value.hasParameters && Object.keys(parameterValues.value).length > 0 \n    ? parameterValues.value \n    : undefined\n  \n  console.log('[ExecutionController] 🔄 Replacement params:', replacementParams)\n  \n  const payload: PlanExecutionRequestPayload = {\n    title: '', // Will be set by the parent component\n    planData: {\n      title: '',\n      steps: [],\n      directResponse: false\n    }, // Will be set by the parent component\n    params: undefined, // Will be set by the parent component\n    replacementParams,\n    uploadedFiles: uploadedFiles.value,\n    uploadKey: uploadKey.value\n  }\n  \n  console.log('[ExecutionController] 📤 Emitting executePlan with payload:', JSON.stringify(payload, null, 2))\n  emit('executePlan', payload)\n}\n\nconst handlePublishMcpService = () => {\n  emit('publishMcpService')\n}\n\nconst clearExecutionParams = () => {\n  console.log('[ExecutionController] 🧹 clearExecutionParams called')\n  executionParams.value = ''\n  // Clear parameter values as well\n  parameterValues.value = {}\n  \n  // Reset execution flag after clearing\n  isExecutingPlan.value = false\n  console.log('[ExecutionController] 🔓 Reset isExecutingPlan to false')\n  \n  console.log('[ExecutionController] ✅ After clear - parameterValues cleared')\n  emit('clearParams')\n}\n\n// Load parameter requirements when plan template changes\nconst loadParameterRequirements = async () => {\n  console.log('[ExecutionController] 🔄 loadParameterRequirements called for templateId:', props.currentPlanTemplateId)\n  console.log('[ExecutionController] 📊 Current parameterRequirements before load:', JSON.stringify(parameterRequirements.value, null, 2))\n  \n  if (!props.currentPlanTemplateId) {\n    console.log('[ExecutionController] ❌ No template ID, resetting parameters')\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: ''\n    }\n    parameterValues.value = {}\n    return\n  }\n\n  // Clear previous data immediately to prevent stale data display\n  parameterRequirements.value = {\n    parameters: [],\n    hasParameters: false,\n    requirements: ''\n  }\n  parameterValues.value = {}\n  console.log('[ExecutionController] 🧹 Cleared previous data before loading new template')\n\n  isLoadingParameters.value = true\n  try {\n    console.log('[ExecutionController] 🌐 Fetching parameter requirements from API...')\n    const requirements = await PlanParameterApiService.getParameterRequirements(props.currentPlanTemplateId)\n    console.log('[ExecutionController] 📥 Received requirements from API:', JSON.stringify(requirements, null, 2))\n    \n    parameterRequirements.value = requirements\n    \n    // Initialize parameter values\n    const newValues: Record<string, string> = {}\n    requirements.parameters.forEach(param => {\n      newValues[param] = parameterValues.value[param] || ''\n    })\n    parameterValues.value = newValues\n    \n    console.log('[ExecutionController] ✅ Updated parameterRequirements:', JSON.stringify(parameterRequirements.value, null, 2))\n    console.log('[ExecutionController] ✅ Updated parameterValues:', JSON.stringify(parameterValues.value, null, 2))\n    \n    // Update execution params with current parameter values\n    updateExecutionParamsFromParameters()\n  } catch (error) {\n    console.error('[ExecutionController] ❌ Failed to load parameter requirements:', error)\n    // Don't show error for 404 - template might not be ready yet\n    if (error instanceof Error && !error.message.includes('404')) {\n      console.warn('[ExecutionController] ⚠️ Parameter requirements not available yet, will retry later')\n    }\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: ''\n    }\n    // Clear parameter values when there's an error to prevent stale data\n    parameterValues.value = {}\n    console.log('[ExecutionController] 🔄 Reset parameterRequirements due to error:', JSON.stringify(parameterRequirements.value, null, 2))\n    console.log('[ExecutionController] 🔄 Cleared parameterValues:', JSON.stringify(parameterValues.value, null, 2))\n  } finally {\n    isLoadingParameters.value = false\n    console.log('[ExecutionController] ✅ loadParameterRequirements completed')\n  }\n}\n\n// Update parameter value and sync with execution params\nconst updateParameterValue = (paramName: string, value: string) => {\n  parameterValues.value[paramName] = value\n  // Clear error for this parameter when user starts typing\n  if (parameterErrors.value[paramName]) {\n    delete parameterErrors.value[paramName]\n  }\n  updateExecutionParamsFromParameters()\n}\n\n// Validate all parameters\nconst validateParameters = (): boolean => {\n  parameterErrors.value = {}\n  isValidationError.value = false\n  \n  if (!parameterRequirements.value.hasParameters) {\n    return true\n  }\n  \n  let hasErrors = false\n  \n  parameterRequirements.value.parameters.forEach(param => {\n    const value = parameterValues.value[param].trim()\n    if (!value) {\n      parameterErrors.value[param] = `${param} is required`\n      hasErrors = true\n    }\n  })\n  \n  isValidationError.value = hasErrors\n  return !hasErrors\n}\n\n// Update execution params from parameter values\nconst updateExecutionParamsFromParameters = () => {\n  if (parameterRequirements.value.hasParameters) {\n    // Convert parameter values to JSON string for execution\n    executionParams.value = JSON.stringify(parameterValues.value, null, 2)\n  } else {\n    executionParams.value = ''\n  }\n  emit('updateExecutionParams', executionParams.value)\n}\n\n\n// Watch for changes in plan template ID\nwatch(() => props.currentPlanTemplateId, (newId, oldId) => {\n  \n  if (newId && newId !== oldId) {\n    // Skip parameter reload if we're currently executing a plan\n    if (isExecutingPlan.value) {\n      console.log('[ExecutionController] ⏸️ Skipping parameter reload - plan is executing')\n      return\n    }\n    \n    console.log('[ExecutionController] 🔄 Template ID changed, will reload parameters')\n    // If this is a new template ID (not from initial load), retry loading parameters\n    if (oldId && newId.startsWith('planTemplate-')) {\n      console.log('[ExecutionController] ⏰ New template detected, retrying with delay...')\n      // Retry loading parameters with a delay for new templates\n      setTimeout(() => {\n        console.log('[ExecutionController] ⏰ Delay timeout, calling loadParameterRequirements')\n        loadParameterRequirements()\n      }, 1000)\n    } else {\n      console.log('[ExecutionController] 🚀 Immediate reload of parameters')\n      loadParameterRequirements()\n    }\n  }\n})\n\n// Watch for changes in execution params (for backward compatibility)\nwatch(() => executionParams.value, (newValue) => {\n  emit('updateExecutionParams', newValue)\n})\n\n// Load parameters on mount\nonMounted(() => {\n  loadParameterRequirements()\n})\n\n// Expose methods for parent component\ndefineExpose({\n  executionParams,\n  clearExecutionParams,\n  loadParameterRequirements,\n  fileUploadRef,\n  uploadedFiles,\n  uploadKey\n})\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.execution-content {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.params-requirements-group {\n  label {\n    display: block;\n    margin-bottom: 6px;\n    font-size: 12px;\n    color: rgba(255, 255, 255, 0.8);\n    font-weight: 500;\n  }\n\n  .params-help-text {\n    margin-bottom: 12px;\n    font-size: 11px;\n    color: rgba(255, 255, 255, 0.6);\n    line-height: 1.4;\n    padding: 6px 8px;\n    background: rgba(102, 126, 234, 0.1);\n    border: 1px solid rgba(102, 126, 234, 0.2);\n    border-radius: 4px;\n  }\n\n  .parameter-fields {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    margin-bottom: 12px;\n  }\n\n  .parameter-field {\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n\n    .parameter-label {\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.8);\n      font-weight: 500;\n      display: flex;\n      align-items: center;\n      gap: 4px;\n\n      .required {\n        color: #ff6b6b;\n        font-weight: bold;\n      }\n    }\n\n    .parameter-input {\n      width: 100%;\n      background: rgba(0, 0, 0, 0.3);\n      border: 1px solid rgba(255, 255, 255, 0.2);\n      border-radius: 6px;\n      color: white;\n      font-size: 12px;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      padding: 8px 12px;\n      min-height: 36px;\n\n      &:focus {\n        outline: none;\n        border-color: #667eea;\n        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n      }\n\n      &::placeholder {\n        color: rgba(255, 255, 255, 0.4);\n      }\n\n      &.error {\n        border-color: #ff6b6b;\n        box-shadow: 0 0 0 2px rgba(255, 107, 107, 0.2);\n      }\n    }\n\n    .parameter-error {\n      color: #ff6b6b;\n      font-size: 11px;\n      margin-top: 4px;\n      display: block;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    }\n  }\n\n  .validation-message {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    color: #ffa726;\n    font-size: 14px;\n    margin-top: 8px;\n    padding: 8px 12px;\n    background: rgba(255, 167, 38, 0.1);\n    border: 1px solid rgba(255, 167, 38, 0.3);\n    border-radius: 4px;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  }\n\n}\n\n\n.call-example-wrapper {\n  margin-top: 12px;\n}\n\n.call-example-header {\n  margin-bottom: 12px;\n}\n\n.call-example-title {\n  color: #667eea;\n  font-size: 14px;\n  font-weight: 600;\n  margin: 0 0 6px 0;\n}\n\n.call-example-description {\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 12px;\n  line-height: 1.4;\n  margin: 0;\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 6px;\n}\n\n.http-api-urls-wrapper {\n  margin-top: 0;\n}\n\n.internal-call-wrapper,\n.mcp-call-wrapper {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.call-info {\n  font-size: 11px;\n\n  .call-method {\n    display: inline-block;\n    padding: 2px 6px;\n    background: #667eea;\n    color: white;\n    border-radius: 3px;\n    font-size: 10px;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .call-endpoint {\n    color: #64b5f6;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 12px;\n    margin-bottom: 8px;\n    word-break: break-all;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid rgba(100, 181, 246, 0.2);\n  }\n\n  .call-description {\n    color: rgba(255, 255, 255, 0.8);\n    margin-bottom: 8px;\n    line-height: 1.4;\n  }\n\n  .call-example {\n    margin-top: 8px;\n\n    strong {\n      color: rgba(255, 255, 255, 0.9);\n      font-size: 10px;\n      display: block;\n      margin-bottom: 4px;\n    }\n\n    .example-code {\n      background: rgba(0, 0, 0, 0.4);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 4px;\n      padding: 8px;\n      color: #e0e0e0;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 10px;\n      line-height: 1.3;\n      white-space: pre-wrap;\n      word-break: break-all;\n      overflow-x: auto;\n    }\n  }\n}\n\n.tab-container {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.tab-header {\n  display: flex;\n  background: rgba(0, 0, 0, 0.3);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.tab-button {\n  flex: 1;\n  padding: 8px 12px;\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 11px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n\n  &:last-child {\n    border-right: none;\n  }\n\n  &:hover {\n    background: rgba(102, 126, 234, 0.1);\n    color: rgba(255, 255, 255, 0.8);\n  }\n\n  &.active {\n    background: rgba(102, 126, 234, 0.2);\n    color: #667eea;\n    font-weight: 600;\n  }\n}\n\n.tab-content {\n  padding: 0;\n}\n\n.tab-panel {\n  padding: 0;\n}\n\n.http-api-url-display {\n  padding: 12px;\n  font-size: 11px;\n\n  .api-method {\n    display: inline-block;\n    padding: 2px 6px;\n    background: #667eea;\n    color: white;\n    border-radius: 3px;\n    font-size: 10px;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .api-endpoint {\n    color: #64b5f6;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 12px;\n    margin-bottom: 8px;\n    word-break: break-all;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid rgba(100, 181, 246, 0.2);\n  }\n\n  .api-description {\n    color: rgba(255, 255, 255, 0.8);\n    margin-bottom: 8px;\n    line-height: 1.4;\n  }\n\n  .api-example {\n    margin-top: 8px;\n\n    strong {\n      color: rgba(255, 255, 255, 0.9);\n      font-size: 10px;\n      display: block;\n      margin-bottom: 4px;\n    }\n\n    .example-code {\n      background: rgba(0, 0, 0, 0.4);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 4px;\n      padding: 8px;\n      color: #e0e0e0;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 10px;\n      line-height: 1.3;\n      white-space: pre-wrap;\n      word-break: break-all;\n      overflow-x: auto;\n    }\n  }\n}\n\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n\n  &.btn-primary {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-1px);\n      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n    }\n  }\n\n  &.publish-mcp-btn {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #ffffff;\n    border: none;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-2px);\n      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);\n    }\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none !important;\n    box-shadow: none !important;\n  }\n\n  .spinning {\n    animation: spin 1s linear infinite;\n  }\n}\n\n.execute-btn,\n.publish-mcp-btn {\n  padding: 10px 16px;\n  font-size: 13px;\n  font-weight: 500;\n  width: 100%;\n  margin-bottom: 8px;\n}\n\n.publish-mcp-btn {\n  margin-bottom: 0;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { reactive, computed, watch, ref } from 'vue'\n// import { useI18n } from 'vue-i18n' // Currently unused\nimport type { StepData, DisplayPlanData } from '@/types/plan-execution'\n\nexport interface JsonEditorProps {\n  jsonContent: string\n  canRollback: boolean\n  canRestore: boolean\n  isGenerating: boolean\n  isExecuting: boolean\n  hiddenFields?: string[]\n  currentPlanTemplateId: string\n}\n\nexport interface JsonEditorEmits {\n  (e: 'rollback'): void\n  (e: 'restore'): void\n  (e: 'save'): void\n  (e: 'update:jsonContent', value: string): void\n}\n\n/**\n * Business logic for JsonEditor component\n */\nexport function useJsonEditor(props: JsonEditorProps, emit: JsonEditorEmits) {\n  // I18n\n  // const { t } = useI18n() // Currently unused\n  \n  // State\n  const showJsonPreview = ref(false)\n\n  // Reactive display data - Based on DynamicAgentExecutionPlan structure\n  const displayData = reactive<DisplayPlanData>({\n    title: '',\n    steps: [],\n    directResponse: false, // Always false for dynamic agent planning\n    planTemplateId: props.currentPlanTemplateId || '',\n    planType: 'dynamic_agent'\n  })\n\n  /**\n   * Parse JSON content into visual data\n   * Maps backend DynamicAgentExecutionPlan structure to frontend DisplayPlanData\n   */\n  const parseJsonToVisual = (jsonContent: string) => {\n    console.log('[JsonEditorLogic] parseJsonToVisual called with jsonContent:', jsonContent)\n    console.log('[JsonEditorLogic] parseJsonToVisual called with currentPlanTemplateId:', props.currentPlanTemplateId)\n    \n    try {\n      if (!jsonContent) {\n        console.log('[JsonEditorLogic] No jsonContent, resetting to default')\n        // Reset to default - matches DynamicAgentExecutionPlan structure\n        Object.assign(displayData, {\n          title: '',\n          steps: [],\n          directResponse: false,\n          planTemplateId: props.currentPlanTemplateId || '',\n          planType: 'dynamic_agent'\n        })\n        console.log('[JsonEditorLogic] Reset displayData to:', displayData)\n        return\n      }\n\n      const parsed = JSON.parse(jsonContent)\n      console.log('[JsonEditorLogic] Parsed JSON:', parsed)\n      \n      // Map basic fields from DynamicAgentExecutionPlan\n      displayData.title = parsed.title || ''\n      displayData.directResponse = false // Always false for dynamic agent planning\n      displayData.planTemplateId = parsed.planTemplateId || props.currentPlanTemplateId || ''\n      displayData.planType = parsed.planType || 'dynamic_agent'\n      \n      // Parse steps - maps ExecutionStep structure\n      displayData.steps = (parsed.steps || []).map((step: any) => ({\n        stepRequirement: step.stepRequirement || '',\n        agentName: step.agentName || '',\n        modelName: step.modelName || null, // Default to null if not specified\n        selectedToolKeys: step.selectedToolKeys || [],\n        terminateColumns: step.terminateColumns || ''\n      }))\n      \n      console.log('[JsonEditorLogic] Updated displayData to:', displayData)\n    } catch (error) {\n      console.warn('Failed to parse JSON content:', error)\n      // Reset to default when parsing fails to prevent stale data\n      Object.assign(displayData, {\n        title: '',\n        steps: [],\n        directResponse: false,\n        planTemplateId: props.currentPlanTemplateId || '',\n        planType: 'dynamic_agent'\n      })\n      console.log('[JsonEditorLogic] Error occurred, reset displayData to:', displayData)\n    }\n  }\n\n  /**\n   * Convert visual data back to JSON\n   * Maps frontend DisplayPlanData to backend DynamicAgentExecutionPlan structure\n   */\n  const convertVisualToJson = (): string => {\n    try {\n      const result: any = {\n        title: displayData.title,\n        steps: displayData.steps.map(step => ({\n          stepRequirement: step.stepRequirement,\n          agentName: step.agentName,\n          modelName: step.modelName ?? '', // Convert null to empty string for JSON\n          selectedToolKeys: step.selectedToolKeys,\n          terminateColumns: step.terminateColumns\n        })),\n        directResponse: displayData.directResponse,\n        planTemplateId: displayData.planTemplateId,\n        planType: displayData.planType\n      }\n      \n      return JSON.stringify(result, null, 2)\n    } catch (error) {\n      console.error('Failed to convert visual data to JSON:', error)\n      return '{}'\n    }\n  }\n\n  // Computed properties\n  const formattedJsonOutput = computed(() => convertVisualToJson())\n\n  // Watch for JSON content changes\n  watch(() => props.jsonContent, (newContent, oldContent) => {\n    console.log('[JsonEditorLogic] Watch triggered - jsonContent changed from', oldContent, 'to', newContent)\n    parseJsonToVisual(newContent)\n  }, { immediate: true })\n\n  // Watch for display data changes and emit updates\n  watch(displayData, () => {\n    const jsonOutput = convertVisualToJson()\n    emit('update:jsonContent', jsonOutput)\n  }, { deep: true })\n\n  // Watch for currentPlanTemplateId changes\n  watch(() => props.currentPlanTemplateId, (newId) => {\n    if (newId) {\n      displayData.planTemplateId = newId\n    }\n  })\n\n  // Step management functions\n  const addStep = () => {\n    const newStep: StepData = {\n      stepRequirement: '',\n      agentName: 'ConfigurableDynaAgent', // Default agent name\n      modelName: null, // Default to null (no model selected)\n      selectedToolKeys: [],\n      terminateColumns: '',\n      agentType: '',\n      stepContent: ''\n    }\n    displayData.steps.push(newStep)\n  }\n\n  const removeStep = (index: number) => {\n    if (index >= 0 && index < displayData.steps.length) {\n      displayData.steps.splice(index, 1)\n    }\n  }\n\n  const moveStepUp = (index: number) => {\n    if (index > 0) {\n      const step = displayData.steps.splice(index, 1)[0]\n      displayData.steps.splice(index - 1, 0, step)\n    }\n  }\n\n  const moveStepDown = (index: number) => {\n    if (index < displayData.steps.length - 1) {\n      const step = displayData.steps.splice(index, 1)[0]\n      displayData.steps.splice(index + 1, 0, step)\n    }\n  }\n\n  // JSON preview functions\n  const toggleJsonPreview = () => {\n    showJsonPreview.value = !showJsonPreview.value\n  }\n\n  const closeJsonPreview = () => {\n    showJsonPreview.value = false\n  }\n\n  // Action handlers\n  const handleRollback = () => {\n    emit('rollback')\n  }\n\n  const handleRestore = () => {\n    emit('restore')\n  }\n\n  const handleSave = () => {\n    emit('save')\n  }\n\n  return {\n    // State\n    showJsonPreview,\n    displayData,\n    formattedJsonOutput,\n    \n    // Step management\n    addStep,\n    removeStep,\n    moveStepUp,\n    moveStepDown,\n    \n    // JSON preview\n    toggleJsonPreview,\n    closeJsonPreview,\n    \n    // Actions\n    handleRollback,\n    handleRestore,\n    handleSave\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by appl.form-select:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.form-select:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.form-textarea {law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:code\" width=\"16\" />\n      <span>{{ $t('sidebar.jsonTemplate') }}</span>\n    </div>\n    <!-- Visual JSON Editor -->\n    <div class=\"visual-editor\">\n      <!-- Plan Basic Info -->\n      <div class=\"plan-basic-info\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.title') }}</label>\n          <input\n            v-model=\"displayData.title\"\n            type=\"text\"\n            class=\"form-input\"\n            :placeholder=\"$t('sidebar.titlePlaceholder')\"\n          />\n        </div>\n      </div>\n\n      <!-- Steps Editor -->\n      <div class=\"steps-section\">\n        <div class=\"steps-header\">\n          <label class=\"form-label\">{{ $t('sidebar.tasks') }}</label>\n        </div>\n\n        <div class=\"steps-container\">\n          <div v-for=\"(step, index) in displayData.steps\" :key=\"index\" class=\"step-item\">\n            <div class=\"step-header\">\n              <span class=\"step-number\">{{ $t('sidebar.subtask') }} {{ index + 1 }}</span>\n              <div class=\"step-actions\">\n                <button\n                  @click=\"moveStepUp(index)\"\n                  :disabled=\"index === 0\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveUp')\"\n                >\n                  <Icon icon=\"carbon:chevron-up\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"moveStepDown(index)\"\n                  :disabled=\"index === displayData.steps.length - 1\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveDown')\"\n                >\n                  <Icon icon=\"carbon:chevron-down\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"removeStep(index)\"\n                  class=\"btn btn-xs btn-danger\"\n                  :title=\"$t('sidebar.removeStep')\"\n                >\n                  <Icon icon=\"carbon:trash-can\" width=\"12\" />\n                </button>\n              </div>\n            </div>\n\n            <div class=\"step-content\">\n              <!-- Agent Selection -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.agent') }}</label>\n                <div class=\"agent-selector\">\n                  <select v-model=\"step.agentName\" class=\"form-select agent-select\">\n                    <option value=\"\">{{ $t('sidebar.selectAgent') }}</option>\n                    <option value=\"DEFAULT_AGENT\">DEFAULT_AGENT</option>\n                    <option value=\"BROWSER_AGENT\">BROWSER_AGENT</option>\n                    <option value=\"TEXT_FILE_AGENT\">TEXT_FILE_AGENT</option>\n                    <option value=\"JSX_GENERATOR_AGENT\">JSX_GENERATOR_AGENT</option>\n                    <option value=\"FILE_MANAGER_AGENT\">FILE_MANAGER_AGENT</option>\n                  </select>\n\n                  <!-- Add step button -->\n                  <button\n                    @click=\"addStep\"\n                    class=\"btn btn-sm btn-add-step\"\n                    :title=\"$t('sidebar.addStep')\"\n                  >\n                    <Icon icon=\"carbon:add\" width=\"14\" />\n                  </button>\n                </div>\n              </div>\n\n              <!-- Step Requirement -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.stepRequirement') }}</label>\n                <textarea\n                  v-model=\"step.stepContent\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.stepRequirementPlaceholder')\"\n                  rows=\"4\"\n                  @input=\"autoResizeTextarea($event)\"\n                ></textarea>\n              </div>\n\n              <!-- Terminate Columns -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.terminateColumns') }}</label>\n                <input\n                  v-model=\"step.terminateColumns\"\n                  type=\"text\"\n                  class=\"form-input\"\n                  :placeholder=\"$t('sidebar.terminateColumnsPlaceholder')\"\n                />\n              </div>\n            </div>\n          </div>\n\n          <!-- Empty State -->\n          <div v-if=\"displayData.steps.length === 0\" class=\"empty-steps\">\n            <Icon icon=\"carbon:add-alt\" width=\"32\" class=\"empty-icon\" />\n            <p>{{ $t('sidebar.noSteps') }}</p>\n            <button @click=\"addStep\" class=\"btn btn-primary\">\n              <Icon icon=\"carbon:add\" width=\"14\" />\n              {{ $t('sidebar.addFirstStep') }}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- Plan ID Section -->\n      <div class=\"plan-id-section\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.planId') }}</label>\n          <input\n            v-model=\"displayData.planTemplateId\"\n            type=\"text\"\n            class=\"form-input\"\n            placeholder=\"planTemplate-1756109892045\"\n          />\n        </div>\n      </div>\n\n      <!-- JSON Preview (Optional) -->\n      <div class=\"json-preview\" v-if=\"showJsonPreview\">\n        <div class=\"preview-header\">\n          <label class=\"form-label\">{{ $t('sidebar.jsonPreview') }}</label>\n          <button @click=\"closeJsonPreview\" class=\"btn btn-xs\">\n            <Icon icon=\"carbon:close\" width=\"12\" />\n          </button>\n        </div>\n        <pre class=\"json-code\">{{ formattedJsonOutput }}</pre>\n      </div>\n\n      <!-- Toggle JSON Preview -->\n      <div class=\"editor-footer\">\n        <button @click=\"toggleJsonPreview\" class=\"btn btn-sm btn-secondary\">\n          <Icon icon=\"carbon:code\" width=\"14\" />\n          {{ showJsonPreview ? $t('sidebar.hideJson') : $t('sidebar.showJson') }}\n        </button>\n        <div class=\"section-actions\">\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRollback\"\n            :disabled=\"!(canRollback ?? false)\"\n            :title=\"$t('sidebar.rollback')\"\n          >\n            <Icon icon=\"carbon:undo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRestore\"\n            :disabled=\"!(canRestore ?? false)\"\n            :title=\"$t('sidebar.restore')\"\n          >\n            <Icon icon=\"carbon:redo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-primary\"\n            @click=\"handleSave\"\n            :disabled=\"isGenerating || isExecuting\"\n          >\n            <Icon icon=\"carbon:save\" width=\"14\" />\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useJsonEditor, type JsonEditorProps } from './json-editor-logic'\n\n// Props\n// eslint-disable-next-line vue/no-unused-properties\nconst props = withDefaults(defineProps<JsonEditorProps>(), {\n  currentPlanTemplateId: '',\n  hiddenFields: () => [],\n})\n\n// Emits\nconst emit = defineEmits<{\n  rollback: []\n  restore: []\n  save: []\n  'update:jsonContent': [value: string]\n}>()\n\nconst {\n  showJsonPreview,\n  displayData,\n  formattedJsonOutput,\n  addStep,\n  removeStep,\n  moveStepUp,\n  moveStepDown,\n  handleRollback,\n  handleRestore,\n  handleSave,\n  toggleJsonPreview,\n  closeJsonPreview,\n} = useJsonEditor(props, emit)\n\nconst autoResizeTextarea = (event: Event) => {\n  const textarea = event.target as HTMLTextAreaElement\n\n  textarea.style.height = 'auto'\n\n  const lineHeight = 20\n  const lines = Math.ceil(textarea.scrollHeight / lineHeight)\n\n  const minRows = 4\n  const maxRows = 12\n  const targetRows = Math.max(minRows, Math.min(maxRows, lines))\n\n  const newHeight = targetRows * lineHeight\n  textarea.style.height = `${newHeight}px`\n  textarea.rows = targetRows\n\n  if (lines > maxRows) {\n    textarea.style.overflowY = 'auto'\n  } else {\n    textarea.style.overflowY = 'hidden'\n  }\n}\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.section-actions {\n  margin-left: auto;\n  display: flex;\n  gap: 6px;\n}\n\n/* Visual Editor Styles */\n.visual-editor {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 16px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.plan-basic-info {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  margin-bottom: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.form-label {\n  font-size: 10px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input,\n.form-select,\n.form-textarea {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 11px;\n  font-family: inherit;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus,\n.form-select:focus,\n.form-textarea:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.form-textarea {\n  resize: vertical;\n  min-height: 80px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  line-height: 1.4;\n}\n\n.form-textarea.auto-resize {\n  resize: none;\n  transition: height 0.2s ease;\n  overflow-y: auto;\n  max-height: 240px;\n}\n\n.checkbox-wrapper {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n}\n\n.form-checkbox {\n  width: 16px;\n  height: 16px;\n  accent-color: #667eea;\n}\n\n.checkbox-label {\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.8);\n}\n\n/* Steps Section */\n.steps-section {\n  margin-bottom: 20px;\n}\n\n/* Plan ID Section */\n.plan-id-section {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.steps-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 16px;\n}\n\n.steps-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.agent-count-badge {\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.6);\n  background: rgba(255, 255, 255, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n}\n\n.error-badge {\n  font-size: 10px;\n  color: #ef4444;\n  background: rgba(239, 68, 68, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n  display: flex;\n  align-items: center;\n  gap: 2px;\n}\n\n.error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.step-item {\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.step-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 9px 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.step-number {\n  font-weight: 600;\n  color: #667eea;\n  font-size: 11px;\n  min-width: 20px;\n}\n\n.step-actions {\n  display: flex;\n  gap: 4px;\n}\n\n.step-content {\n  padding: 16px;\n}\n\n.agent-selector {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.agent-select {\n  flex: 1;\n}\n\n.btn-add-step {\n  padding: 6px 8px;\n  min-width: auto;\n}\n\n/* Empty State */\n.empty-steps {\n  text-align: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.empty-icon {\n  color: rgba(255, 255, 255, 0.3);\n  margin-bottom: 12px;\n}\n\n/* JSON Preview */\n.json-preview {\n  margin-bottom: 16px;\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 6px;\n  overflow: hidden;\n}\n\n.preview-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.json-code {\n  padding: 12px;\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.8);\n  background: transparent;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n.editor-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n/* Button Styles */\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n  color: white;\n  transform: translateY(-1px);\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none !important;\n  box-shadow: none !important;\n}\n\n.btn-sm {\n  padding: 4px 8px;\n  font-size: 11px;\n}\n\n.btn-xs {\n  padding: 2px 4px;\n  font-size: 10px;\n  min-width: auto;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.btn-add {\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  color: white;\n}\n\n.btn-add:hover:not(:disabled) {\n  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);\n}\n\n/* Legacy styles for compatibility */\n.json-editor {\n  width: 100%;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: white;\n  font-size: 11px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  padding: 8px;\n  resize: vertical;\n  min-height: 200px;\n  line-height: 1.5;\n  white-space: pre-wrap;\n  overflow-wrap: break-word;\n  word-break: break-word;\n  tab-size: 2;\n  font-variant-ligatures: none;\n}\n\n.json-editor:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.json-editor::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n</style>\n","'use strict';\n\nexport default function bind(fn, thisArg) {\n  return function wrap() {\n    return fn.apply(thisArg, arguments);\n  };\n}\n","'use strict';\n\nimport bind from './helpers/bind.js';\n\n// utils is a library of generic helper functions non-specific to axios\n\nconst {toString} = Object.prototype;\nconst {getPrototypeOf} = Object;\nconst {iterator, toStringTag} = Symbol;\n\nconst kindOf = (cache => thing => {\n    const str = toString.call(thing);\n    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());\n})(Object.create(null));\n\nconst kindOfTest = (type) => {\n  type = type.toLowerCase();\n  return (thing) => kindOf(thing) === type\n}\n\nconst typeOfTest = type => thing => typeof thing === type;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n *\n * @returns {boolean} True if value is an Array, otherwise false\n */\nconst {isArray} = Array;\n\n/**\n * Determine if a value is undefined\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nconst isUndefined = typeOfTest('undefined');\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nconst isArrayBuffer = kindOfTest('ArrayBuffer');\n\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  let result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a String, otherwise false\n */\nconst isString = typeOfTest('string');\n\n/**\n * Determine if a value is a Function\n *\n * @param {*} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nconst isFunction = typeOfTest('function');\n\n/**\n * Determine if a value is a Number\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Number, otherwise false\n */\nconst isNumber = typeOfTest('number');\n\n/**\n * Determine if a value is an Object\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an Object, otherwise false\n */\nconst isObject = (thing) => thing !== null && typeof thing === 'object';\n\n/**\n * Determine if a value is a Boolean\n *\n * @param {*} thing The value to test\n * @returns {boolean} True if value is a Boolean, otherwise false\n */\nconst isBoolean = thing => thing === true || thing === false;\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a plain Object, otherwise false\n */\nconst isPlainObject = (val) => {\n  if (kindOf(val) !== 'object') {\n    return false;\n  }\n\n  const prototype = getPrototypeOf(val);\n  return (prototype === null || prototype === Object.prototype || Object.getPrototypeOf(prototype) === null) && !(toStringTag in val) && !(iterator in val);\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Date, otherwise false\n */\nconst isDate = kindOfTest('Date');\n\n/**\n * Determine if a value is a File\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFile = kindOfTest('File');\n\n/**\n * Determine if a value is a Blob\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nconst isBlob = kindOfTest('Blob');\n\n/**\n * Determine if a value is a FileList\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFileList = kindOfTest('FileList');\n\n/**\n * Determine if a value is a Stream\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nconst isStream = (val) => isObject(val) && isFunction(val.pipe);\n\n/**\n * Determine if a value is a FormData\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nconst isFormData = (thing) => {\n  let kind;\n  return thing && (\n    (typeof FormData === 'function' && thing instanceof FormData) || (\n      isFunction(thing.append) && (\n        (kind = kindOf(thing)) === 'formdata' ||\n        // detect form-data instance\n        (kind === 'object' && isFunction(thing.toString) && thing.toString() === '[object FormData]')\n      )\n    )\n  )\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nconst isURLSearchParams = kindOfTest('URLSearchParams');\n\nconst [isReadableStream, isRequest, isResponse, isHeaders] = ['ReadableStream', 'Request', 'Response', 'Headers'].map(kindOfTest);\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n *\n * @returns {String} The String freed of excess whitespace\n */\nconst trim = (str) => str.trim ?\n  str.trim() : str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n *\n * @param {Boolean} [allOwnKeys = false]\n * @returns {any}\n */\nfunction forEach(obj, fn, {allOwnKeys = false} = {}) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  let i;\n  let l;\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);\n    const len = keys.length;\n    let key;\n\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      fn.call(null, obj[key], key, obj);\n    }\n  }\n}\n\nfunction findKey(obj, key) {\n  key = key.toLowerCase();\n  const keys = Object.keys(obj);\n  let i = keys.length;\n  let _key;\n  while (i-- > 0) {\n    _key = keys[i];\n    if (key === _key.toLowerCase()) {\n      return _key;\n    }\n  }\n  return null;\n}\n\nconst _global = (() => {\n  /*eslint no-undef:0*/\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  return typeof self !== \"undefined\" ? self : (typeof window !== 'undefined' ? window : global)\n})();\n\nconst isContextDefined = (context) => !isUndefined(context) && context !== _global;\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n *\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  const {caseless} = isContextDefined(this) && this || {};\n  const result = {};\n  const assignValue = (val, key) => {\n    const targetKey = caseless && findKey(result, key) || key;\n    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {\n      result[targetKey] = merge(result[targetKey], val);\n    } else if (isPlainObject(val)) {\n      result[targetKey] = merge({}, val);\n    } else if (isArray(val)) {\n      result[targetKey] = val.slice();\n    } else {\n      result[targetKey] = val;\n    }\n  }\n\n  for (let i = 0, l = arguments.length; i < l; i++) {\n    arguments[i] && forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n *\n * @param {Boolean} [allOwnKeys]\n * @returns {Object} The resulting value of object a\n */\nconst extend = (a, b, thisArg, {allOwnKeys}= {}) => {\n  forEach(b, (val, key) => {\n    if (thisArg && isFunction(val)) {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  }, {allOwnKeys});\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n *\n * @returns {string} content value without BOM\n */\nconst stripBOM = (content) => {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\n/**\n * Inherit the prototype methods from one constructor into another\n * @param {function} constructor\n * @param {function} superConstructor\n * @param {object} [props]\n * @param {object} [descriptors]\n *\n * @returns {void}\n */\nconst inherits = (constructor, superConstructor, props, descriptors) => {\n  constructor.prototype = Object.create(superConstructor.prototype, descriptors);\n  constructor.prototype.constructor = constructor;\n  Object.defineProperty(constructor, 'super', {\n    value: superConstructor.prototype\n  });\n  props && Object.assign(constructor.prototype, props);\n}\n\n/**\n * Resolve object with deep prototype chain to a flat object\n * @param {Object} sourceObj source object\n * @param {Object} [destObj]\n * @param {Function|Boolean} [filter]\n * @param {Function} [propFilter]\n *\n * @returns {Object}\n */\nconst toFlatObject = (sourceObj, destObj, filter, propFilter) => {\n  let props;\n  let i;\n  let prop;\n  const merged = {};\n\n  destObj = destObj || {};\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  if (sourceObj == null) return destObj;\n\n  do {\n    props = Object.getOwnPropertyNames(sourceObj);\n    i = props.length;\n    while (i-- > 0) {\n      prop = props[i];\n      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {\n        destObj[prop] = sourceObj[prop];\n        merged[prop] = true;\n      }\n    }\n    sourceObj = filter !== false && getPrototypeOf(sourceObj);\n  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);\n\n  return destObj;\n}\n\n/**\n * Determines whether a string ends with the characters of a specified string\n *\n * @param {String} str\n * @param {String} searchString\n * @param {Number} [position= 0]\n *\n * @returns {boolean}\n */\nconst endsWith = (str, searchString, position) => {\n  str = String(str);\n  if (position === undefined || position > str.length) {\n    position = str.length;\n  }\n  position -= searchString.length;\n  const lastIndex = str.indexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\n/**\n * Returns new array from array like object or null if failed\n *\n * @param {*} [thing]\n *\n * @returns {?Array}\n */\nconst toArray = (thing) => {\n  if (!thing) return null;\n  if (isArray(thing)) return thing;\n  let i = thing.length;\n  if (!isNumber(i)) return null;\n  const arr = new Array(i);\n  while (i-- > 0) {\n    arr[i] = thing[i];\n  }\n  return arr;\n}\n\n/**\n * Checking if the Uint8Array exists and if it does, it returns a function that checks if the\n * thing passed in is an instance of Uint8Array\n *\n * @param {TypedArray}\n *\n * @returns {Array}\n */\n// eslint-disable-next-line func-names\nconst isTypedArray = (TypedArray => {\n  // eslint-disable-next-line func-names\n  return thing => {\n    return TypedArray && thing instanceof TypedArray;\n  };\n})(typeof Uint8Array !== 'undefined' && getPrototypeOf(Uint8Array));\n\n/**\n * For each entry in the object, call the function with the key and value.\n *\n * @param {Object<any, any>} obj - The object to iterate over.\n * @param {Function} fn - The function to call for each entry.\n *\n * @returns {void}\n */\nconst forEachEntry = (obj, fn) => {\n  const generator = obj && obj[iterator];\n\n  const _iterator = generator.call(obj);\n\n  let result;\n\n  while ((result = _iterator.next()) && !result.done) {\n    const pair = result.value;\n    fn.call(obj, pair[0], pair[1]);\n  }\n}\n\n/**\n * It takes a regular expression and a string, and returns an array of all the matches\n *\n * @param {string} regExp - The regular expression to match against.\n * @param {string} str - The string to search.\n *\n * @returns {Array<boolean>}\n */\nconst matchAll = (regExp, str) => {\n  let matches;\n  const arr = [];\n\n  while ((matches = regExp.exec(str)) !== null) {\n    arr.push(matches);\n  }\n\n  return arr;\n}\n\n/* Checking if the kindOfTest function returns true when passed an HTMLFormElement. */\nconst isHTMLForm = kindOfTest('HTMLFormElement');\n\nconst toCamelCase = str => {\n  return str.toLowerCase().replace(/[-_\\s]([a-z\\d])(\\w*)/g,\n    function replacer(m, p1, p2) {\n      return p1.toUpperCase() + p2;\n    }\n  );\n};\n\n/* Creating a function that will check if an object has a property. */\nconst hasOwnProperty = (({hasOwnProperty}) => (obj, prop) => hasOwnProperty.call(obj, prop))(Object.prototype);\n\n/**\n * Determine if a value is a RegExp object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a RegExp object, otherwise false\n */\nconst isRegExp = kindOfTest('RegExp');\n\nconst reduceDescriptors = (obj, reducer) => {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  const reducedDescriptors = {};\n\n  forEach(descriptors, (descriptor, name) => {\n    let ret;\n    if ((ret = reducer(descriptor, name, obj)) !== false) {\n      reducedDescriptors[name] = ret || descriptor;\n    }\n  });\n\n  Object.defineProperties(obj, reducedDescriptors);\n}\n\n/**\n * Makes all methods read-only\n * @param {Object} obj\n */\n\nconst freezeMethods = (obj) => {\n  reduceDescriptors(obj, (descriptor, name) => {\n    // skip restricted props in strict mode\n    if (isFunction(obj) && ['arguments', 'caller', 'callee'].indexOf(name) !== -1) {\n      return false;\n    }\n\n    const value = obj[name];\n\n    if (!isFunction(value)) return;\n\n    descriptor.enumerable = false;\n\n    if ('writable' in descriptor) {\n      descriptor.writable = false;\n      return;\n    }\n\n    if (!descriptor.set) {\n      descriptor.set = () => {\n        throw Error('Can not rewrite read-only method \\'' + name + '\\'');\n      };\n    }\n  });\n}\n\nconst toObjectSet = (arrayOrString, delimiter) => {\n  const obj = {};\n\n  const define = (arr) => {\n    arr.forEach(value => {\n      obj[value] = true;\n    });\n  }\n\n  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));\n\n  return obj;\n}\n\nconst noop = () => {}\n\nconst toFiniteNumber = (value, defaultValue) => {\n  return value != null && Number.isFinite(value = +value) ? value : defaultValue;\n}\n\n/**\n * If the thing is a FormData object, return true, otherwise return false.\n *\n * @param {unknown} thing - The thing to check.\n *\n * @returns {boolean}\n */\nfunction isSpecCompliantForm(thing) {\n  return !!(thing && isFunction(thing.append) && thing[toStringTag] === 'FormData' && thing[iterator]);\n}\n\nconst toJSONObject = (obj) => {\n  const stack = new Array(10);\n\n  const visit = (source, i) => {\n\n    if (isObject(source)) {\n      if (stack.indexOf(source) >= 0) {\n        return;\n      }\n\n      if(!('toJSON' in source)) {\n        stack[i] = source;\n        const target = isArray(source) ? [] : {};\n\n        forEach(source, (value, key) => {\n          const reducedValue = visit(value, i + 1);\n          !isUndefined(reducedValue) && (target[key] = reducedValue);\n        });\n\n        stack[i] = undefined;\n\n        return target;\n      }\n    }\n\n    return source;\n  }\n\n  return visit(obj, 0);\n}\n\nconst isAsyncFn = kindOfTest('AsyncFunction');\n\nconst isThenable = (thing) =>\n  thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);\n\n// original code\n// https://github.com/DigitalBrainJS/AxiosPromise/blob/16deab13710ec09779922131f3fa5954320f83ab/lib/utils.js#L11-L34\n\nconst _setImmediate = ((setImmediateSupported, postMessageSupported) => {\n  if (setImmediateSupported) {\n    return setImmediate;\n  }\n\n  return postMessageSupported ? ((token, callbacks) => {\n    _global.addEventListener(\"message\", ({source, data}) => {\n      if (source === _global && data === token) {\n        callbacks.length && callbacks.shift()();\n      }\n    }, false);\n\n    return (cb) => {\n      callbacks.push(cb);\n      _global.postMessage(token, \"*\");\n    }\n  })(`axios@${Math.random()}`, []) : (cb) => setTimeout(cb);\n})(\n  typeof setImmediate === 'function',\n  isFunction(_global.postMessage)\n);\n\nconst asap = typeof queueMicrotask !== 'undefined' ?\n  queueMicrotask.bind(_global) : ( typeof process !== 'undefined' && process.nextTick || _setImmediate);\n\n// *********************\n\n\nconst isIterable = (thing) => thing != null && isFunction(thing[iterator]);\n\n\nexport default {\n  isArray,\n  isArrayBuffer,\n  isBuffer,\n  isFormData,\n  isArrayBufferView,\n  isString,\n  isNumber,\n  isBoolean,\n  isObject,\n  isPlainObject,\n  isReadableStream,\n  isRequest,\n  isResponse,\n  isHeaders,\n  isUndefined,\n  isDate,\n  isFile,\n  isBlob,\n  isRegExp,\n  isFunction,\n  isStream,\n  isURLSearchParams,\n  isTypedArray,\n  isFileList,\n  forEach,\n  merge,\n  extend,\n  trim,\n  stripBOM,\n  inherits,\n  toFlatObject,\n  kindOf,\n  kindOfTest,\n  endsWith,\n  toArray,\n  forEachEntry,\n  matchAll,\n  isHTMLForm,\n  hasOwnProperty,\n  hasOwnProp: hasOwnProperty, // an alias to avoid ESLint no-prototype-builtins detection\n  reduceDescriptors,\n  freezeMethods,\n  toObjectSet,\n  toCamelCase,\n  noop,\n  toFiniteNumber,\n  findKey,\n  global: _global,\n  isContextDefined,\n  isSpecCompliantForm,\n  toJSONObject,\n  isAsyncFn,\n  isThenable,\n  setImmediate: _setImmediate,\n  asap,\n  isIterable\n};\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [config] The config.\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n *\n * @returns {Error} The created error.\n */\nfunction AxiosError(message, code, config, request, response) {\n  Error.call(this);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n\n  this.message = message;\n  this.name = 'AxiosError';\n  code && (this.code = code);\n  config && (this.config = config);\n  request && (this.request = request);\n  if (response) {\n    this.response = response;\n    this.status = response.status ? response.status : null;\n  }\n}\n\nutils.inherits(AxiosError, Error, {\n  toJSON: function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: utils.toJSONObject(this.config),\n      code: this.code,\n      status: this.status\n    };\n  }\n});\n\nconst prototype = AxiosError.prototype;\nconst descriptors = {};\n\n[\n  'ERR_BAD_OPTION_VALUE',\n  'ERR_BAD_OPTION',\n  'ECONNABORTED',\n  'ETIMEDOUT',\n  'ERR_NETWORK',\n  'ERR_FR_TOO_MANY_REDIRECTS',\n  'ERR_DEPRECATED',\n  'ERR_BAD_RESPONSE',\n  'ERR_BAD_REQUEST',\n  'ERR_CANCELED',\n  'ERR_NOT_SUPPORT',\n  'ERR_INVALID_URL'\n// eslint-disable-next-line func-names\n].forEach(code => {\n  descriptors[code] = {value: code};\n});\n\nObject.defineProperties(AxiosError, descriptors);\nObject.defineProperty(prototype, 'isAxiosError', {value: true});\n\n// eslint-disable-next-line func-names\nAxiosError.from = (error, code, config, request, response, customProps) => {\n  const axiosError = Object.create(prototype);\n\n  utils.toFlatObject(error, axiosError, function filter(obj) {\n    return obj !== Error.prototype;\n  }, prop => {\n    return prop !== 'isAxiosError';\n  });\n\n  AxiosError.call(axiosError, error.message, code, config, request, response);\n\n  axiosError.cause = error;\n\n  axiosError.name = error.name;\n\n  customProps && Object.assign(axiosError, customProps);\n\n  return axiosError;\n};\n\nexport default AxiosError;\n","// eslint-disable-next-line strict\nexport default null;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n","'use strict';\n\nimport toFormData from './toFormData.js';\n\n/**\n * It encodes a string by replacing all characters that are not in the unreserved set with\n * their percent-encoded equivalents\n *\n * @param {string} str - The string to encode.\n *\n * @returns {string} The encoded string.\n */\nfunction encode(str) {\n  const charMap = {\n    '!': '%21',\n    \"'\": '%27',\n    '(': '%28',\n    ')': '%29',\n    '~': '%7E',\n    '%20': '+',\n    '%00': '\\x00'\n  };\n  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {\n    return charMap[match];\n  });\n}\n\n/**\n * It takes a params object and converts it to a FormData object\n *\n * @param {Object<string, any>} params - The parameters to be converted to a FormData object.\n * @param {Object<string, any>} options - The options object passed to the Axios constructor.\n *\n * @returns {void}\n */\nfunction AxiosURLSearchParams(params, options) {\n  this._pairs = [];\n\n  params && toFormData(params, this, options);\n}\n\nconst prototype = AxiosURLSearchParams.prototype;\n\nprototype.append = function append(name, value) {\n  this._pairs.push([name, value]);\n};\n\nprototype.toString = function toString(encoder) {\n  const _encode = encoder ? function(value) {\n    return encoder.call(this, value, encode);\n  } : encode;\n\n  return this._pairs.map(function each(pair) {\n    return _encode(pair[0]) + '=' + _encode(pair[1]);\n  }, '').join('&');\n};\n\nexport default AxiosURLSearchParams;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosURLSearchParams from '../helpers/AxiosURLSearchParams.js';\n\n/**\n * It replaces all instances of the characters `:`, `$`, `,`, `+`, `[`, and `]` with their\n * URI encoded counterparts\n *\n * @param {string} val The value to be encoded.\n *\n * @returns {string} The encoded value.\n */\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @param {?(object|Function)} options\n *\n * @returns {string} The formatted url\n */\nexport default function buildURL(url, params, options) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n  \n  const _encode = options && options.encode || encode;\n\n  if (utils.isFunction(options)) {\n    options = {\n      serialize: options\n    };\n  } \n\n  const serializeFn = options && options.serialize;\n\n  let serializedParams;\n\n  if (serializeFn) {\n    serializedParams = serializeFn(params, options);\n  } else {\n    serializedParams = utils.isURLSearchParams(params) ?\n      params.toString() :\n      new AxiosURLSearchParams(params, options).toString(_encode);\n  }\n\n  if (serializedParams) {\n    const hashmarkIndex = url.indexOf(\"#\");\n\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\nclass InterceptorManager {\n  constructor() {\n    this.handlers = [];\n  }\n\n  /**\n   * Add a new interceptor to the stack\n   *\n   * @param {Function} fulfilled The function to handle `then` for a `Promise`\n   * @param {Function} rejected The function to handle `reject` for a `Promise`\n   *\n   * @return {Number} An ID used to remove interceptor later\n   */\n  use(fulfilled, rejected, options) {\n    this.handlers.push({\n      fulfilled,\n      rejected,\n      synchronous: options ? options.synchronous : false,\n      runWhen: options ? options.runWhen : null\n    });\n    return this.handlers.length - 1;\n  }\n\n  /**\n   * Remove an interceptor from the stack\n   *\n   * @param {Number} id The ID that was returned by `use`\n   *\n   * @returns {Boolean} `true` if the interceptor was removed, `false` otherwise\n   */\n  eject(id) {\n    if (this.handlers[id]) {\n      this.handlers[id] = null;\n    }\n  }\n\n  /**\n   * Clear all interceptors from the stack\n   *\n   * @returns {void}\n   */\n  clear() {\n    if (this.handlers) {\n      this.handlers = [];\n    }\n  }\n\n  /**\n   * Iterate over all the registered interceptors\n   *\n   * This method is particularly useful for skipping over any\n   * interceptors that may have become `null` calling `eject`.\n   *\n   * @param {Function} fn The function to call for each interceptor\n   *\n   * @returns {void}\n   */\n  forEach(fn) {\n    utils.forEach(this.handlers, function forEachHandler(h) {\n      if (h !== null) {\n        fn(h);\n      }\n    });\n  }\n}\n\nexport default InterceptorManager;\n","'use strict';\n\nexport default {\n  silentJSONParsing: true,\n  forcedJSONParsing: true,\n  clarifyTimeoutError: false\n};\n","'use strict';\n\nimport AxiosURLSearchParams from '../../../helpers/AxiosURLSearchParams.js';\nexport default typeof URLSearchParams !== 'undefined' ? URLSearchParams : AxiosURLSearchParams;\n","'use strict';\n\nexport default typeof FormData !== 'undefined' ? FormData : null;\n","'use strict'\n\nexport default typeof Blob !== 'undefined' ? Blob : null\n","import URLSearchParams from './classes/URLSearchParams.js'\nimport FormData from './classes/FormData.js'\nimport Blob from './classes/Blob.js'\n\nexport default {\n  isBrowser: true,\n  classes: {\n    URLSearchParams,\n    FormData,\n    Blob\n  },\n  protocols: ['http', 'https', 'file', 'blob', 'url', 'data']\n};\n","const hasBrowserEnv = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nconst _navigator = typeof navigator === 'object' && navigator || undefined;\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n *\n * @returns {boolean}\n */\nconst hasStandardBrowserEnv = hasBrowserEnv &&\n  (!_navigator || ['ReactNative', 'NativeScript', 'NS'].indexOf(_navigator.product) < 0);\n\n/**\n * Determine if we're running in a standard browser webWorker environment\n *\n * Although the `isStandardBrowserEnv` method indicates that\n * `allows axios to run in a web worker`, the WebWorker will still be\n * filtered out due to its judgment standard\n * `typeof window !== 'undefined' && typeof document !== 'undefined'`.\n * This leads to a problem when axios post `FormData` in webWorker\n */\nconst hasStandardBrowserWebWorkerEnv = (() => {\n  return (\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // eslint-disable-next-line no-undef\n    self instanceof WorkerGlobalScope &&\n    typeof self.importScripts === 'function'\n  );\n})();\n\nconst origin = hasBrowserEnv && window.location.href || 'http://localhost';\n\nexport {\n  hasBrowserEnv,\n  hasStandardBrowserWebWorkerEnv,\n  hasStandardBrowserEnv,\n  _navigator as navigator,\n  origin\n}\n","import platform from './node/index.js';\nimport * as utils from './common/utils.js';\n\nexport default {\n  ...utils,\n  ...platform\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport toFormData from './toFormData.js';\nimport platform from '../platform/index.js';\n\nexport default function toURLEncodedForm(data, options) {\n  return toFormData(data, new platform.classes.URLSearchParams(), Object.assign({\n    visitor: function(value, key, path, helpers) {\n      if (platform.isNode && utils.isBuffer(value)) {\n        this.append(key, value.toString('base64'));\n        return false;\n      }\n\n      return helpers.defaultVisitor.apply(this, arguments);\n    }\n  }, options));\n}\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * It takes a string like `foo[x][y][z]` and returns an array like `['foo', 'x', 'y', 'z']\n *\n * @param {string} name - The name of the property to get.\n *\n * @returns An array of strings.\n */\nfunction parsePropPath(name) {\n  // foo[x][y][z]\n  // foo.x.y.z\n  // foo-x-y-z\n  // foo x y z\n  return utils.matchAll(/\\w+|\\[(\\w*)]/g, name).map(match => {\n    return match[0] === '[]' ? '' : match[1] || match[0];\n  });\n}\n\n/**\n * Convert an array to an object.\n *\n * @param {Array<any>} arr - The array to convert to an object.\n *\n * @returns An object with the same keys and values as the array.\n */\nfunction arrayToObject(arr) {\n  const obj = {};\n  const keys = Object.keys(arr);\n  let i;\n  const len = keys.length;\n  let key;\n  for (i = 0; i < len; i++) {\n    key = keys[i];\n    obj[key] = arr[key];\n  }\n  return obj;\n}\n\n/**\n * It takes a FormData object and returns a JavaScript object\n *\n * @param {string} formData The FormData object to convert to JSON.\n *\n * @returns {Object<string, any> | null} The converted object.\n */\nfunction formDataToJSON(formData) {\n  function buildPath(path, value, target, index) {\n    let name = path[index++];\n\n    if (name === '__proto__') return true;\n\n    const isNumericKey = Number.isFinite(+name);\n    const isLast = index >= path.length;\n    name = !name && utils.isArray(target) ? target.length : name;\n\n    if (isLast) {\n      if (utils.hasOwnProp(target, name)) {\n        target[name] = [target[name], value];\n      } else {\n        target[name] = value;\n      }\n\n      return !isNumericKey;\n    }\n\n    if (!target[name] || !utils.isObject(target[name])) {\n      target[name] = [];\n    }\n\n    const result = buildPath(path, value, target[name], index);\n\n    if (result && utils.isArray(target[name])) {\n      target[name] = arrayToObject(target[name]);\n    }\n\n    return !isNumericKey;\n  }\n\n  if (utils.isFormData(formData) && utils.isFunction(formData.entries)) {\n    const obj = {};\n\n    utils.forEachEntry(formData, (name, value) => {\n      buildPath(parsePropPath(name), value, obj, 0);\n    });\n\n    return obj;\n  }\n\n  return null;\n}\n\nexport default formDataToJSON;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\nimport transitionalDefaults from './transitional.js';\nimport toFormData from '../helpers/toFormData.js';\nimport toURLEncodedForm from '../helpers/toURLEncodedForm.js';\nimport platform from '../platform/index.js';\nimport formDataToJSON from '../helpers/formDataToJSON.js';\n\n/**\n * It takes a string, tries to parse it, and if it fails, it returns the stringified version\n * of the input\n *\n * @param {any} rawValue - The value to be stringified.\n * @param {Function} parser - A function that parses a string into a JavaScript object.\n * @param {Function} encoder - A function that takes a value and returns a string.\n *\n * @returns {string} A stringified version of the rawValue.\n */\nfunction stringifySafely(rawValue, parser, encoder) {\n  if (utils.isString(rawValue)) {\n    try {\n      (parser || JSON.parse)(rawValue);\n      return utils.trim(rawValue);\n    } catch (e) {\n      if (e.name !== 'SyntaxError') {\n        throw e;\n      }\n    }\n  }\n\n  return (encoder || JSON.stringify)(rawValue);\n}\n\nconst defaults = {\n\n  transitional: transitionalDefaults,\n\n  adapter: ['xhr', 'http', 'fetch'],\n\n  transformRequest: [function transformRequest(data, headers) {\n    const contentType = headers.getContentType() || '';\n    const hasJSONContentType = contentType.indexOf('application/json') > -1;\n    const isObjectPayload = utils.isObject(data);\n\n    if (isObjectPayload && utils.isHTMLForm(data)) {\n      data = new FormData(data);\n    }\n\n    const isFormData = utils.isFormData(data);\n\n    if (isFormData) {\n      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;\n    }\n\n    if (utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data) ||\n      utils.isReadableStream(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      headers.setContentType('application/x-www-form-urlencoded;charset=utf-8', false);\n      return data.toString();\n    }\n\n    let isFileList;\n\n    if (isObjectPayload) {\n      if (contentType.indexOf('application/x-www-form-urlencoded') > -1) {\n        return toURLEncodedForm(data, this.formSerializer).toString();\n      }\n\n      if ((isFileList = utils.isFileList(data)) || contentType.indexOf('multipart/form-data') > -1) {\n        const _FormData = this.env && this.env.FormData;\n\n        return toFormData(\n          isFileList ? {'files[]': data} : data,\n          _FormData && new _FormData(),\n          this.formSerializer\n        );\n      }\n    }\n\n    if (isObjectPayload || hasJSONContentType ) {\n      headers.setContentType('application/json', false);\n      return stringifySafely(data);\n    }\n\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    const transitional = this.transitional || defaults.transitional;\n    const forcedJSONParsing = transitional && transitional.forcedJSONParsing;\n    const JSONRequested = this.responseType === 'json';\n\n    if (utils.isResponse(data) || utils.isReadableStream(data)) {\n      return data;\n    }\n\n    if (data && utils.isString(data) && ((forcedJSONParsing && !this.responseType) || JSONRequested)) {\n      const silentJSONParsing = transitional && transitional.silentJSONParsing;\n      const strictJSONParsing = !silentJSONParsing && JSONRequested;\n\n      try {\n        return JSON.parse(data);\n      } catch (e) {\n        if (strictJSONParsing) {\n          if (e.name === 'SyntaxError') {\n            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);\n          }\n          throw e;\n        }\n      }\n    }\n\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  env: {\n    FormData: platform.classes.FormData,\n    Blob: platform.classes.Blob\n  },\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  },\n\n  headers: {\n    common: {\n      'Accept': 'application/json, text/plain, */*',\n      'Content-Type': undefined\n    }\n  }\n};\n\nutils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch'], (method) => {\n  defaults.headers[method] = {};\n});\n\nexport default defaults;\n","'use strict';\n\nimport utils from './../utils.js';\n\n// RawAxiosHeaders whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nconst ignoreDuplicateOf = utils.toObjectSet([\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n]);\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} rawHeaders Headers needing to be parsed\n *\n * @returns {Object} Headers parsed into an object\n */\nexport default rawHeaders => {\n  const parsed = {};\n  let key;\n  let val;\n  let i;\n\n  rawHeaders && rawHeaders.split('\\n').forEach(function parser(line) {\n    i = line.indexOf(':');\n    key = line.substring(0, i).trim().toLowerCase();\n    val = line.substring(i + 1).trim();\n\n    if (!key || (parsed[key] && ignoreDuplicateOf[key])) {\n      return;\n    }\n\n    if (key === 'set-cookie') {\n      if (parsed[key]) {\n        parsed[key].push(val);\n      } else {\n        parsed[key] = [val];\n      }\n    } else {\n      parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nimport utils from '../utils.js';\nimport parseHeaders from '../helpers/parseHeaders.js';\n\nconst $internals = Symbol('internals');\n\nfunction normalizeHeader(header) {\n  return header && String(header).trim().toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (value === false || value == null) {\n    return value;\n  }\n\n  return utils.isArray(value) ? value.map(normalizeValue) : String(value);\n}\n\nfunction parseTokens(str) {\n  const tokens = Object.create(null);\n  const tokensRE = /([^\\s,;=]+)\\s*(?:=\\s*([^,;]+))?/g;\n  let match;\n\n  while ((match = tokensRE.exec(str))) {\n    tokens[match[1]] = match[2];\n  }\n\n  return tokens;\n}\n\nconst isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());\n\nfunction matchHeaderValue(context, value, header, filter, isHeaderNameFilter) {\n  if (utils.isFunction(filter)) {\n    return filter.call(this, value, header);\n  }\n\n  if (isHeaderNameFilter) {\n    value = header;\n  }\n\n  if (!utils.isString(value)) return;\n\n  if (utils.isString(filter)) {\n    return value.indexOf(filter) !== -1;\n  }\n\n  if (utils.isRegExp(filter)) {\n    return filter.test(value);\n  }\n}\n\nfunction formatHeader(header) {\n  return header.trim()\n    .toLowerCase().replace(/([a-z\\d])(\\w*)/g, (w, char, str) => {\n      return char.toUpperCase() + str;\n    });\n}\n\nfunction buildAccessors(obj, header) {\n  const accessorName = utils.toCamelCase(' ' + header);\n\n  ['get', 'set', 'has'].forEach(methodName => {\n    Object.defineProperty(obj, methodName + accessorName, {\n      value: function(arg1, arg2, arg3) {\n        return this[methodName].call(this, header, arg1, arg2, arg3);\n      },\n      configurable: true\n    });\n  });\n}\n\nclass AxiosHeaders {\n  constructor(headers) {\n    headers && this.set(headers);\n  }\n\n  set(header, valueOrRewrite, rewrite) {\n    const self = this;\n\n    function setHeader(_value, _header, _rewrite) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!lHeader) {\n        throw new Error('header name must be a non-empty string');\n      }\n\n      const key = utils.findKey(self, lHeader);\n\n      if(!key || self[key] === undefined || _rewrite === true || (_rewrite === undefined && self[key] !== false)) {\n        self[key || _header] = normalizeValue(_value);\n      }\n    }\n\n    const setHeaders = (headers, _rewrite) =>\n      utils.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));\n\n    if (utils.isPlainObject(header) || header instanceof this.constructor) {\n      setHeaders(header, valueOrRewrite)\n    } else if(utils.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {\n      setHeaders(parseHeaders(header), valueOrRewrite);\n    } else if (utils.isObject(header) && utils.isIterable(header)) {\n      let obj = {}, dest, key;\n      for (const entry of header) {\n        if (!utils.isArray(entry)) {\n          throw TypeError('Object iterator must return a key-value pair');\n        }\n\n        obj[key = entry[0]] = (dest = obj[key]) ?\n          (utils.isArray(dest) ? [...dest, entry[1]] : [dest, entry[1]]) : entry[1];\n      }\n\n      setHeaders(obj, valueOrRewrite)\n    } else {\n      header != null && setHeader(valueOrRewrite, header, rewrite);\n    }\n\n    return this;\n  }\n\n  get(header, parser) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      if (key) {\n        const value = this[key];\n\n        if (!parser) {\n          return value;\n        }\n\n        if (parser === true) {\n          return parseTokens(value);\n        }\n\n        if (utils.isFunction(parser)) {\n          return parser.call(this, value, key);\n        }\n\n        if (utils.isRegExp(parser)) {\n          return parser.exec(value);\n        }\n\n        throw new TypeError('parser must be boolean|regexp|function');\n      }\n    }\n  }\n\n  has(header, matcher) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      return !!(key && this[key] !== undefined && (!matcher || matchHeaderValue(this, this[key], key, matcher)));\n    }\n\n    return false;\n  }\n\n  delete(header, matcher) {\n    const self = this;\n    let deleted = false;\n\n    function deleteHeader(_header) {\n      _header = normalizeHeader(_header);\n\n      if (_header) {\n        const key = utils.findKey(self, _header);\n\n        if (key && (!matcher || matchHeaderValue(self, self[key], key, matcher))) {\n          delete self[key];\n\n          deleted = true;\n        }\n      }\n    }\n\n    if (utils.isArray(header)) {\n      header.forEach(deleteHeader);\n    } else {\n      deleteHeader(header);\n    }\n\n    return deleted;\n  }\n\n  clear(matcher) {\n    const keys = Object.keys(this);\n    let i = keys.length;\n    let deleted = false;\n\n    while (i--) {\n      const key = keys[i];\n      if(!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {\n        delete this[key];\n        deleted = true;\n      }\n    }\n\n    return deleted;\n  }\n\n  normalize(format) {\n    const self = this;\n    const headers = {};\n\n    utils.forEach(this, (value, header) => {\n      const key = utils.findKey(headers, header);\n\n      if (key) {\n        self[key] = normalizeValue(value);\n        delete self[header];\n        return;\n      }\n\n      const normalized = format ? formatHeader(header) : String(header).trim();\n\n      if (normalized !== header) {\n        delete self[header];\n      }\n\n      self[normalized] = normalizeValue(value);\n\n      headers[normalized] = true;\n    });\n\n    return this;\n  }\n\n  concat(...targets) {\n    return this.constructor.concat(this, ...targets);\n  }\n\n  toJSON(asStrings) {\n    const obj = Object.create(null);\n\n    utils.forEach(this, (value, header) => {\n      value != null && value !== false && (obj[header] = asStrings && utils.isArray(value) ? value.join(', ') : value);\n    });\n\n    return obj;\n  }\n\n  [Symbol.iterator]() {\n    return Object.entries(this.toJSON())[Symbol.iterator]();\n  }\n\n  toString() {\n    return Object.entries(this.toJSON()).map(([header, value]) => header + ': ' + value).join('\\n');\n  }\n\n  getSetCookie() {\n    return this.get(\"set-cookie\") || [];\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'AxiosHeaders';\n  }\n\n  static from(thing) {\n    return thing instanceof this ? thing : new this(thing);\n  }\n\n  static concat(first, ...targets) {\n    const computed = new this(first);\n\n    targets.forEach((target) => computed.set(target));\n\n    return computed;\n  }\n\n  static accessor(header) {\n    const internals = this[$internals] = (this[$internals] = {\n      accessors: {}\n    });\n\n    const accessors = internals.accessors;\n    const prototype = this.prototype;\n\n    function defineAccessor(_header) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!accessors[lHeader]) {\n        buildAccessors(prototype, _header);\n        accessors[lHeader] = true;\n      }\n    }\n\n    utils.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);\n\n    return this;\n  }\n}\n\nAxiosHeaders.accessor(['Content-Type', 'Content-Length', 'Accept', 'Accept-Encoding', 'User-Agent', 'Authorization']);\n\n// reserved names hotfix\nutils.reduceDescriptors(AxiosHeaders.prototype, ({value}, key) => {\n  let mapped = key[0].toUpperCase() + key.slice(1); // map `set` => `Set`\n  return {\n    get: () => value,\n    set(headerValue) {\n      this[mapped] = headerValue;\n    }\n  }\n});\n\nutils.freezeMethods(AxiosHeaders);\n\nexport default AxiosHeaders;\n","'use strict';\n\nimport utils from './../utils.js';\nimport defaults from '../defaults/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Array|Function} fns A single function or Array of functions\n * @param {?Object} response The response object\n *\n * @returns {*} The resulting transformed data\n */\nexport default function transformData(fns, response) {\n  const config = this || defaults;\n  const context = response || config;\n  const headers = AxiosHeaders.from(context.headers);\n  let data = context.data;\n\n  utils.forEach(fns, function transform(fn) {\n    data = fn.call(config, data, headers.normalize(), response ? response.status : undefined);\n  });\n\n  headers.normalize();\n\n  return data;\n}\n","'use strict';\n\nexport default function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n","'use strict';\n\nimport AxiosError from '../core/AxiosError.js';\nimport utils from '../utils.js';\n\n/**\n * A `CanceledError` is an object that is thrown when an operation is canceled.\n *\n * @param {string=} message The message.\n * @param {Object=} config The config.\n * @param {Object=} request The request.\n *\n * @returns {CanceledError} The created error.\n */\nfunction CanceledError(message, config, request) {\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED, config, request);\n  this.name = 'CanceledError';\n}\n\nutils.inherits(CanceledError, AxiosError, {\n  __CANCEL__: true\n});\n\nexport default CanceledError;\n","'use strict';\n\nimport AxiosError from './AxiosError.js';\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n *\n * @returns {object} The response.\n */\nexport default function settle(resolve, reject, response) {\n  const validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(new AxiosError(\n      'Request failed with status code ' + response.status,\n      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],\n      response.config,\n      response.request,\n      response\n    ));\n  }\n}\n","'use strict';\n\nexport default function parseProtocol(url) {\n  const match = /^([-+\\w]{1,25})(:?\\/\\/|:)/.exec(url);\n  return match && match[1] || '';\n}\n","'use strict';\n\n/**\n * Calculate data maxRate\n * @param {Number} [samplesCount= 10]\n * @param {Number} [min= 1000]\n * @returns {Function}\n */\nfunction speedometer(samplesCount, min) {\n  samplesCount = samplesCount || 10;\n  const bytes = new Array(samplesCount);\n  const timestamps = new Array(samplesCount);\n  let head = 0;\n  let tail = 0;\n  let firstSampleTS;\n\n  min = min !== undefined ? min : 1000;\n\n  return function push(chunkLength) {\n    const now = Date.now();\n\n    const startedAt = timestamps[tail];\n\n    if (!firstSampleTS) {\n      firstSampleTS = now;\n    }\n\n    bytes[head] = chunkLength;\n    timestamps[head] = now;\n\n    let i = tail;\n    let bytesCount = 0;\n\n    while (i !== head) {\n      bytesCount += bytes[i++];\n      i = i % samplesCount;\n    }\n\n    head = (head + 1) % samplesCount;\n\n    if (head === tail) {\n      tail = (tail + 1) % samplesCount;\n    }\n\n    if (now - firstSampleTS < min) {\n      return;\n    }\n\n    const passed = startedAt && now - startedAt;\n\n    return passed ? Math.round(bytesCount * 1000 / passed) : undefined;\n  };\n}\n\nexport default speedometer;\n","/**\n * Throttle decorator\n * @param {Function} fn\n * @param {Number} freq\n * @return {Function}\n */\nfunction throttle(fn, freq) {\n  let timestamp = 0;\n  let threshold = 1000 / freq;\n  let lastArgs;\n  let timer;\n\n  const invoke = (args, now = Date.now()) => {\n    timestamp = now;\n    lastArgs = null;\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    fn.apply(null, args);\n  }\n\n  const throttled = (...args) => {\n    const now = Date.now();\n    const passed = now - timestamp;\n    if ( passed >= threshold) {\n      invoke(args, now);\n    } else {\n      lastArgs = args;\n      if (!timer) {\n        timer = setTimeout(() => {\n          timer = null;\n          invoke(lastArgs)\n        }, threshold - passed);\n      }\n    }\n  }\n\n  const flush = () => lastArgs && invoke(lastArgs);\n\n  return [throttled, flush];\n}\n\nexport default throttle;\n","import speedometer from \"./speedometer.js\";\nimport throttle from \"./throttle.js\";\nimport utils from \"../utils.js\";\n\nexport const progressEventReducer = (listener, isDownloadStream, freq = 3) => {\n  let bytesNotified = 0;\n  const _speedometer = speedometer(50, 250);\n\n  return throttle(e => {\n    const loaded = e.loaded;\n    const total = e.lengthComputable ? e.total : undefined;\n    const progressBytes = loaded - bytesNotified;\n    const rate = _speedometer(progressBytes);\n    const inRange = loaded <= total;\n\n    bytesNotified = loaded;\n\n    const data = {\n      loaded,\n      total,\n      progress: total ? (loaded / total) : undefined,\n      bytes: progressBytes,\n      rate: rate ? rate : undefined,\n      estimated: rate && total && inRange ? (total - loaded) / rate : undefined,\n      event: e,\n      lengthComputable: total != null,\n      [isDownloadStream ? 'download' : 'upload']: true\n    };\n\n    listener(data);\n  }, freq);\n}\n\nexport const progressEventDecorator = (total, throttled) => {\n  const lengthComputable = total != null;\n\n  return [(loaded) => throttled[0]({\n    lengthComputable,\n    total,\n    loaded\n  }), throttled[1]];\n}\n\nexport const asyncDecorator = (fn) => (...args) => utils.asap(() => fn(...args));\n","import platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ? ((origin, isMSIE) => (url) => {\n  url = new URL(url, platform.origin);\n\n  return (\n    origin.protocol === url.protocol &&\n    origin.host === url.host &&\n    (isMSIE || origin.port === url.port)\n  );\n})(\n  new URL(platform.origin),\n  platform.navigator && /(msie|trident)/i.test(platform.navigator.userAgent)\n) : () => true;\n","import utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ?\n\n  // Standard browser envs support document.cookie\n  {\n    write(name, value, expires, path, domain, secure) {\n      const cookie = [name + '=' + encodeURIComponent(value)];\n\n      utils.isNumber(expires) && cookie.push('expires=' + new Date(expires).toGMTString());\n\n      utils.isString(path) && cookie.push('path=' + path);\n\n      utils.isString(domain) && cookie.push('domain=' + domain);\n\n      secure === true && cookie.push('secure');\n\n      document.cookie = cookie.join('; ');\n    },\n\n    read(name) {\n      const match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n      return (match ? decodeURIComponent(match[3]) : null);\n    },\n\n    remove(name) {\n      this.write(name, '', Date.now() - 86400000);\n    }\n  }\n\n  :\n\n  // Non-standard browser env (web workers, react-native) lack needed support.\n  {\n    write() {},\n    read() {\n      return null;\n    },\n    remove() {}\n  };\n\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n *\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nexport default function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i.test(url);\n}\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n *\n * @returns {string} The combined URL\n */\nexport default function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/?\\/$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n}\n","'use strict';\n\nimport isAbsoluteURL from '../helpers/isAbsoluteURL.js';\nimport combineURLs from '../helpers/combineURLs.js';\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n *\n * @returns {string} The combined full path\n */\nexport default function buildFullPath(baseURL, requestedURL, allowAbsoluteUrls) {\n  let isRelativeUrl = !isAbsoluteURL(requestedURL);\n  if (baseURL && (isRelativeUrl || allowAbsoluteUrls == false)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosHeaders from \"./AxiosHeaders.js\";\n\nconst headersToObject = (thing) => thing instanceof AxiosHeaders ? { ...thing } : thing;\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n *\n * @returns {Object} New object resulting from merging config2 to config1\n */\nexport default function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  const config = {};\n\n  function getMergedValue(target, source, prop, caseless) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge.call({caseless}, target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDeepProperties(a, b, prop , caseless) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(a, b, prop , caseless);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a, prop , caseless);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function valueFromConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function defaultToConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDirectKeys(a, b, prop) {\n    if (prop in config2) {\n      return getMergedValue(a, b);\n    } else if (prop in config1) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  const mergeMap = {\n    url: valueFromConfig2,\n    method: valueFromConfig2,\n    data: valueFromConfig2,\n    baseURL: defaultToConfig2,\n    transformRequest: defaultToConfig2,\n    transformResponse: defaultToConfig2,\n    paramsSerializer: defaultToConfig2,\n    timeout: defaultToConfig2,\n    timeoutMessage: defaultToConfig2,\n    withCredentials: defaultToConfig2,\n    withXSRFToken: defaultToConfig2,\n    adapter: defaultToConfig2,\n    responseType: defaultToConfig2,\n    xsrfCookieName: defaultToConfig2,\n    xsrfHeaderName: defaultToConfig2,\n    onUploadProgress: defaultToConfig2,\n    onDownloadProgress: defaultToConfig2,\n    decompress: defaultToConfig2,\n    maxContentLength: defaultToConfig2,\n    maxBodyLength: defaultToConfig2,\n    beforeRedirect: defaultToConfig2,\n    transport: defaultToConfig2,\n    httpAgent: defaultToConfig2,\n    httpsAgent: defaultToConfig2,\n    cancelToken: defaultToConfig2,\n    socketPath: defaultToConfig2,\n    responseEncoding: defaultToConfig2,\n    validateStatus: mergeDirectKeys,\n    headers: (a, b , prop) => mergeDeepProperties(headersToObject(a), headersToObject(b),prop, true)\n  };\n\n  utils.forEach(Object.keys(Object.assign({}, config1, config2)), function computeConfigValue(prop) {\n    const merge = mergeMap[prop] || mergeDeepProperties;\n    const configValue = merge(config1[prop], config2[prop], prop);\n    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);\n  });\n\n  return config;\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport isURLSameOrigin from \"./isURLSameOrigin.js\";\nimport cookies from \"./cookies.js\";\nimport buildFullPath from \"../core/buildFullPath.js\";\nimport mergeConfig from \"../core/mergeConfig.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport buildURL from \"./buildURL.js\";\n\nexport default (config) => {\n  const newConfig = mergeConfig({}, config);\n\n  let {data, withXSRFToken, xsrfHeaderName, xsrfCookieName, headers, auth} = newConfig;\n\n  newConfig.headers = headers = AxiosHeaders.from(headers);\n\n  newConfig.url = buildURL(buildFullPath(newConfig.baseURL, newConfig.url, newConfig.allowAbsoluteUrls), config.params, config.paramsSerializer);\n\n  // HTTP basic authentication\n  if (auth) {\n    headers.set('Authorization', 'Basic ' +\n      btoa((auth.username || '') + ':' + (auth.password ? unescape(encodeURIComponent(auth.password)) : ''))\n    );\n  }\n\n  let contentType;\n\n  if (utils.isFormData(data)) {\n    if (platform.hasStandardBrowserEnv || platform.hasStandardBrowserWebWorkerEnv) {\n      headers.setContentType(undefined); // Let the browser set it\n    } else if ((contentType = headers.getContentType()) !== false) {\n      // fix semicolon duplication issue for ReactNative FormData implementation\n      const [type, ...tokens] = contentType ? contentType.split(';').map(token => token.trim()).filter(Boolean) : [];\n      headers.setContentType([type || 'multipart/form-data', ...tokens].join('; '));\n    }\n  }\n\n  // Add xsrf header\n  // This is only done if running in a standard browser environment.\n  // Specifically not if we're in a web worker, or react-native.\n\n  if (platform.hasStandardBrowserEnv) {\n    withXSRFToken && utils.isFunction(withXSRFToken) && (withXSRFToken = withXSRFToken(newConfig));\n\n    if (withXSRFToken || (withXSRFToken !== false && isURLSameOrigin(newConfig.url))) {\n      // Add xsrf header\n      const xsrfValue = xsrfHeaderName && xsrfCookieName && cookies.read(xsrfCookieName);\n\n      if (xsrfValue) {\n        headers.set(xsrfHeaderName, xsrfValue);\n      }\n    }\n  }\n\n  return newConfig;\n}\n\n","import utils from './../utils.js';\nimport settle from './../core/settle.js';\nimport transitionalDefaults from '../defaults/transitional.js';\nimport AxiosError from '../core/AxiosError.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport parseProtocol from '../helpers/parseProtocol.js';\nimport platform from '../platform/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport {progressEventReducer} from '../helpers/progressEventReducer.js';\nimport resolveConfig from \"../helpers/resolveConfig.js\";\n\nconst isXHRAdapterSupported = typeof XMLHttpRequest !== 'undefined';\n\nexport default isXHRAdapterSupported && function (config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    const _config = resolveConfig(config);\n    let requestData = _config.data;\n    const requestHeaders = AxiosHeaders.from(_config.headers).normalize();\n    let {responseType, onUploadProgress, onDownloadProgress} = _config;\n    let onCanceled;\n    let uploadThrottled, downloadThrottled;\n    let flushUpload, flushDownload;\n\n    function done() {\n      flushUpload && flushUpload(); // flush events\n      flushDownload && flushDownload(); // flush events\n\n      _config.cancelToken && _config.cancelToken.unsubscribe(onCanceled);\n\n      _config.signal && _config.signal.removeEventListener('abort', onCanceled);\n    }\n\n    let request = new XMLHttpRequest();\n\n    request.open(_config.method.toUpperCase(), _config.url, true);\n\n    // Set the request timeout in MS\n    request.timeout = _config.timeout;\n\n    function onloadend() {\n      if (!request) {\n        return;\n      }\n      // Prepare the response\n      const responseHeaders = AxiosHeaders.from(\n        'getAllResponseHeaders' in request && request.getAllResponseHeaders()\n      );\n      const responseData = !responseType || responseType === 'text' || responseType === 'json' ?\n        request.responseText : request.response;\n      const response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config,\n        request\n      };\n\n      settle(function _resolve(value) {\n        resolve(value);\n        done();\n      }, function _reject(err) {\n        reject(err);\n        done();\n      }, response);\n\n      // Clean up request\n      request = null;\n    }\n\n    if ('onloadend' in request) {\n      // Use onloadend if available\n      request.onloadend = onloadend;\n    } else {\n      // Listen for ready state to emulate onloadend\n      request.onreadystatechange = function handleLoad() {\n        if (!request || request.readyState !== 4) {\n          return;\n        }\n\n        // The request errored out and we didn't get a response, this will be\n        // handled by onerror instead\n        // With one exception: request that using file: protocol, most browsers\n        // will return status as 0 even though it's a successful request\n        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n          return;\n        }\n        // readystate handler is calling before onerror or ontimeout handlers,\n        // so we should call onloadend on the next 'tick'\n        setTimeout(onloadend);\n      };\n    }\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      let timeoutErrorMessage = _config.timeout ? 'timeout of ' + _config.timeout + 'ms exceeded' : 'timeout exceeded';\n      const transitional = _config.transitional || transitionalDefaults;\n      if (_config.timeoutErrorMessage) {\n        timeoutErrorMessage = _config.timeoutErrorMessage;\n      }\n      reject(new AxiosError(\n        timeoutErrorMessage,\n        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,\n        config,\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Remove Content-Type if data is undefined\n    requestData === undefined && requestHeaders.setContentType(null);\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {\n        request.setRequestHeader(key, val);\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(_config.withCredentials)) {\n      request.withCredentials = !!_config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (responseType && responseType !== 'json') {\n      request.responseType = _config.responseType;\n    }\n\n    // Handle progress if needed\n    if (onDownloadProgress) {\n      ([downloadThrottled, flushDownload] = progressEventReducer(onDownloadProgress, true));\n      request.addEventListener('progress', downloadThrottled);\n    }\n\n    // Not all browsers support upload events\n    if (onUploadProgress && request.upload) {\n      ([uploadThrottled, flushUpload] = progressEventReducer(onUploadProgress));\n\n      request.upload.addEventListener('progress', uploadThrottled);\n\n      request.upload.addEventListener('loadend', flushUpload);\n    }\n\n    if (_config.cancelToken || _config.signal) {\n      // Handle cancellation\n      // eslint-disable-next-line func-names\n      onCanceled = cancel => {\n        if (!request) {\n          return;\n        }\n        reject(!cancel || cancel.type ? new CanceledError(null, config, request) : cancel);\n        request.abort();\n        request = null;\n      };\n\n      _config.cancelToken && _config.cancelToken.subscribe(onCanceled);\n      if (_config.signal) {\n        _config.signal.aborted ? onCanceled() : _config.signal.addEventListener('abort', onCanceled);\n      }\n    }\n\n    const protocol = parseProtocol(_config.url);\n\n    if (protocol && platform.protocols.indexOf(protocol) === -1) {\n      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));\n      return;\n    }\n\n\n    // Send the request\n    request.send(requestData || null);\n  });\n}\n","import CanceledError from \"../cancel/CanceledError.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport utils from '../utils.js';\n\nconst composeSignals = (signals, timeout) => {\n  const {length} = (signals = signals ? signals.filter(Boolean) : []);\n\n  if (timeout || length) {\n    let controller = new AbortController();\n\n    let aborted;\n\n    const onabort = function (reason) {\n      if (!aborted) {\n        aborted = true;\n        unsubscribe();\n        const err = reason instanceof Error ? reason : this.reason;\n        controller.abort(err instanceof AxiosError ? err : new CanceledError(err instanceof Error ? err.message : err));\n      }\n    }\n\n    let timer = timeout && setTimeout(() => {\n      timer = null;\n      onabort(new AxiosError(`timeout ${timeout} of ms exceeded`, AxiosError.ETIMEDOUT))\n    }, timeout)\n\n    const unsubscribe = () => {\n      if (signals) {\n        timer && clearTimeout(timer);\n        timer = null;\n        signals.forEach(signal => {\n          signal.unsubscribe ? signal.unsubscribe(onabort) : signal.removeEventListener('abort', onabort);\n        });\n        signals = null;\n      }\n    }\n\n    signals.forEach((signal) => signal.addEventListener('abort', onabort));\n\n    const {signal} = controller;\n\n    signal.unsubscribe = () => utils.asap(unsubscribe);\n\n    return signal;\n  }\n}\n\nexport default composeSignals;\n","\nexport const streamChunk = function* (chunk, chunkSize) {\n  let len = chunk.byteLength;\n\n  if (!chunkSize || len < chunkSize) {\n    yield chunk;\n    return;\n  }\n\n  let pos = 0;\n  let end;\n\n  while (pos < len) {\n    end = pos + chunkSize;\n    yield chunk.slice(pos, end);\n    pos = end;\n  }\n}\n\nexport const readBytes = async function* (iterable, chunkSize) {\n  for await (const chunk of readStream(iterable)) {\n    yield* streamChunk(chunk, chunkSize);\n  }\n}\n\nconst readStream = async function* (stream) {\n  if (stream[Symbol.asyncIterator]) {\n    yield* stream;\n    return;\n  }\n\n  const reader = stream.getReader();\n  try {\n    for (;;) {\n      const {done, value} = await reader.read();\n      if (done) {\n        break;\n      }\n      yield value;\n    }\n  } finally {\n    await reader.cancel();\n  }\n}\n\nexport const trackStream = (stream, chunkSize, onProgress, onFinish) => {\n  const iterator = readBytes(stream, chunkSize);\n\n  let bytes = 0;\n  let done;\n  let _onFinish = (e) => {\n    if (!done) {\n      done = true;\n      onFinish && onFinish(e);\n    }\n  }\n\n  return new ReadableStream({\n    async pull(controller) {\n      try {\n        const {done, value} = await iterator.next();\n\n        if (done) {\n         _onFinish();\n          controller.close();\n          return;\n        }\n\n        let len = value.byteLength;\n        if (onProgress) {\n          let loadedBytes = bytes += len;\n          onProgress(loadedBytes);\n        }\n        controller.enqueue(new Uint8Array(value));\n      } catch (err) {\n        _onFinish(err);\n        throw err;\n      }\n    },\n    cancel(reason) {\n      _onFinish(reason);\n      return iterator.return();\n    }\n  }, {\n    highWaterMark: 2\n  })\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport composeSignals from \"../helpers/composeSignals.js\";\nimport {trackStream} from \"../helpers/trackStream.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport {progressEventReducer, progressEventDecorator, asyncDecorator} from \"../helpers/progressEventReducer.js\";\nimport resolveConfig from \"../helpers/resolveConfig.js\";\nimport settle from \"../core/settle.js\";\n\nconst isFetchSupported = typeof fetch === 'function' && typeof Request === 'function' && typeof Response === 'function';\nconst isReadableStreamSupported = isFetchSupported && typeof ReadableStream === 'function';\n\n// used only inside the fetch adapter\nconst encodeText = isFetchSupported && (typeof TextEncoder === 'function' ?\n    ((encoder) => (str) => encoder.encode(str))(new TextEncoder()) :\n    async (str) => new Uint8Array(await new Response(str).arrayBuffer())\n);\n\nconst test = (fn, ...args) => {\n  try {\n    return !!fn(...args);\n  } catch (e) {\n    return false\n  }\n}\n\nconst supportsRequestStream = isReadableStreamSupported && test(() => {\n  let duplexAccessed = false;\n\n  const hasContentType = new Request(platform.origin, {\n    body: new ReadableStream(),\n    method: 'POST',\n    get duplex() {\n      duplexAccessed = true;\n      return 'half';\n    },\n  }).headers.has('Content-Type');\n\n  return duplexAccessed && !hasContentType;\n});\n\nconst DEFAULT_CHUNK_SIZE = 64 * 1024;\n\nconst supportsResponseStream = isReadableStreamSupported &&\n  test(() => utils.isReadableStream(new Response('').body));\n\n\nconst resolvers = {\n  stream: supportsResponseStream && ((res) => res.body)\n};\n\nisFetchSupported && (((res) => {\n  ['text', 'arrayBuffer', 'blob', 'formData', 'stream'].forEach(type => {\n    !resolvers[type] && (resolvers[type] = utils.isFunction(res[type]) ? (res) => res[type]() :\n      (_, config) => {\n        throw new AxiosError(`Response type '${type}' is not supported`, AxiosError.ERR_NOT_SUPPORT, config);\n      })\n  });\n})(new Response));\n\nconst getBodyLength = async (body) => {\n  if (body == null) {\n    return 0;\n  }\n\n  if(utils.isBlob(body)) {\n    return body.size;\n  }\n\n  if(utils.isSpecCompliantForm(body)) {\n    const _request = new Request(platform.origin, {\n      method: 'POST',\n      body,\n    });\n    return (await _request.arrayBuffer()).byteLength;\n  }\n\n  if(utils.isArrayBufferView(body) || utils.isArrayBuffer(body)) {\n    return body.byteLength;\n  }\n\n  if(utils.isURLSearchParams(body)) {\n    body = body + '';\n  }\n\n  if(utils.isString(body)) {\n    return (await encodeText(body)).byteLength;\n  }\n}\n\nconst resolveBodyLength = async (headers, body) => {\n  const length = utils.toFiniteNumber(headers.getContentLength());\n\n  return length == null ? getBodyLength(body) : length;\n}\n\nexport default isFetchSupported && (async (config) => {\n  let {\n    url,\n    method,\n    data,\n    signal,\n    cancelToken,\n    timeout,\n    onDownloadProgress,\n    onUploadProgress,\n    responseType,\n    headers,\n    withCredentials = 'same-origin',\n    fetchOptions\n  } = resolveConfig(config);\n\n  responseType = responseType ? (responseType + '').toLowerCase() : 'text';\n\n  let composedSignal = composeSignals([signal, cancelToken && cancelToken.toAbortSignal()], timeout);\n\n  let request;\n\n  const unsubscribe = composedSignal && composedSignal.unsubscribe && (() => {\n      composedSignal.unsubscribe();\n  });\n\n  let requestContentLength;\n\n  try {\n    if (\n      onUploadProgress && supportsRequestStream && method !== 'get' && method !== 'head' &&\n      (requestContentLength = await resolveBodyLength(headers, data)) !== 0\n    ) {\n      let _request = new Request(url, {\n        method: 'POST',\n        body: data,\n        duplex: \"half\"\n      });\n\n      let contentTypeHeader;\n\n      if (utils.isFormData(data) && (contentTypeHeader = _request.headers.get('content-type'))) {\n        headers.setContentType(contentTypeHeader)\n      }\n\n      if (_request.body) {\n        const [onProgress, flush] = progressEventDecorator(\n          requestContentLength,\n          progressEventReducer(asyncDecorator(onUploadProgress))\n        );\n\n        data = trackStream(_request.body, DEFAULT_CHUNK_SIZE, onProgress, flush);\n      }\n    }\n\n    if (!utils.isString(withCredentials)) {\n      withCredentials = withCredentials ? 'include' : 'omit';\n    }\n\n    // Cloudflare Workers throws when credentials are defined\n    // see https://github.com/cloudflare/workerd/issues/902\n    const isCredentialsSupported = \"credentials\" in Request.prototype;\n    request = new Request(url, {\n      ...fetchOptions,\n      signal: composedSignal,\n      method: method.toUpperCase(),\n      headers: headers.normalize().toJSON(),\n      body: data,\n      duplex: \"half\",\n      credentials: isCredentialsSupported ? withCredentials : undefined\n    });\n\n    let response = await fetch(request);\n\n    const isStreamResponse = supportsResponseStream && (responseType === 'stream' || responseType === 'response');\n\n    if (supportsResponseStream && (onDownloadProgress || (isStreamResponse && unsubscribe))) {\n      const options = {};\n\n      ['status', 'statusText', 'headers'].forEach(prop => {\n        options[prop] = response[prop];\n      });\n\n      const responseContentLength = utils.toFiniteNumber(response.headers.get('content-length'));\n\n      const [onProgress, flush] = onDownloadProgress && progressEventDecorator(\n        responseContentLength,\n        progressEventReducer(asyncDecorator(onDownloadProgress), true)\n      ) || [];\n\n      response = new Response(\n        trackStream(response.body, DEFAULT_CHUNK_SIZE, onProgress, () => {\n          flush && flush();\n          unsubscribe && unsubscribe();\n        }),\n        options\n      );\n    }\n\n    responseType = responseType || 'text';\n\n    let responseData = await resolvers[utils.findKey(resolvers, responseType) || 'text'](response, config);\n\n    !isStreamResponse && unsubscribe && unsubscribe();\n\n    return await new Promise((resolve, reject) => {\n      settle(resolve, reject, {\n        data: responseData,\n        headers: AxiosHeaders.from(response.headers),\n        status: response.status,\n        statusText: response.statusText,\n        config,\n        request\n      })\n    })\n  } catch (err) {\n    unsubscribe && unsubscribe();\n\n    if (err && err.name === 'TypeError' && /Load failed|fetch/i.test(err.message)) {\n      throw Object.assign(\n        new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request),\n        {\n          cause: err.cause || err\n        }\n      )\n    }\n\n    throw AxiosError.from(err, err && err.code, config, request);\n  }\n});\n\n\n","import utils from '../utils.js';\nimport httpAdapter from './http.js';\nimport xhrAdapter from './xhr.js';\nimport fetchAdapter from './fetch.js';\nimport AxiosError from \"../core/AxiosError.js\";\n\nconst knownAdapters = {\n  http: httpAdapter,\n  xhr: xhrAdapter,\n  fetch: fetchAdapter\n}\n\nutils.forEach(knownAdapters, (fn, value) => {\n  if (fn) {\n    try {\n      Object.defineProperty(fn, 'name', {value});\n    } catch (e) {\n      // eslint-disable-next-line no-empty\n    }\n    Object.defineProperty(fn, 'adapterName', {value});\n  }\n});\n\nconst renderReason = (reason) => `- ${reason}`;\n\nconst isResolvedHandle = (adapter) => utils.isFunction(adapter) || adapter === null || adapter === false;\n\nexport default {\n  getAdapter: (adapters) => {\n    adapters = utils.isArray(adapters) ? adapters : [adapters];\n\n    const {length} = adapters;\n    let nameOrAdapter;\n    let adapter;\n\n    const rejectedReasons = {};\n\n    for (let i = 0; i < length; i++) {\n      nameOrAdapter = adapters[i];\n      let id;\n\n      adapter = nameOrAdapter;\n\n      if (!isResolvedHandle(nameOrAdapter)) {\n        adapter = knownAdapters[(id = String(nameOrAdapter)).toLowerCase()];\n\n        if (adapter === undefined) {\n          throw new AxiosError(`Unknown adapter '${id}'`);\n        }\n      }\n\n      if (adapter) {\n        break;\n      }\n\n      rejectedReasons[id || '#' + i] = adapter;\n    }\n\n    if (!adapter) {\n\n      const reasons = Object.entries(rejectedReasons)\n        .map(([id, state]) => `adapter ${id} ` +\n          (state === false ? 'is not supported by the environment' : 'is not available in the build')\n        );\n\n      let s = length ?\n        (reasons.length > 1 ? 'since :\\n' + reasons.map(renderReason).join('\\n') : ' ' + renderReason(reasons[0])) :\n        'as no adapter specified';\n\n      throw new AxiosError(\n        `There is no suitable adapter to dispatch the request ` + s,\n        'ERR_NOT_SUPPORT'\n      );\n    }\n\n    return adapter;\n  },\n  adapters: knownAdapters\n}\n","'use strict';\n\nimport transformData from './transformData.js';\nimport isCancel from '../cancel/isCancel.js';\nimport defaults from '../defaults/index.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport adapters from \"../adapters/adapters.js\";\n\n/**\n * Throws a `CanceledError` if cancellation has been requested.\n *\n * @param {Object} config The config that is to be used for the request\n *\n * @returns {void}\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n\n  if (config.signal && config.signal.aborted) {\n    throw new CanceledError(null, config);\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n *\n * @returns {Promise} The Promise to be fulfilled\n */\nexport default function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  config.headers = AxiosHeaders.from(config.headers);\n\n  // Transform request data\n  config.data = transformData.call(\n    config,\n    config.transformRequest\n  );\n\n  if (['post', 'put', 'patch'].indexOf(config.method) !== -1) {\n    config.headers.setContentType('application/x-www-form-urlencoded', false);\n  }\n\n  const adapter = adapters.getAdapter(config.adapter || defaults.adapter);\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData.call(\n      config,\n      config.transformResponse,\n      response\n    );\n\n    response.headers = AxiosHeaders.from(response.headers);\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData.call(\n          config,\n          config.transformResponse,\n          reason.response\n        );\n        reason.response.headers = AxiosHeaders.from(reason.response.headers);\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n}\n","export const VERSION = \"1.9.0\";","'use strict';\n\nimport {VERSION} from '../env/data.js';\nimport AxiosError from '../core/AxiosError.js';\n\nconst validators = {};\n\n// eslint-disable-next-line func-names\n['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {\n  validators[type] = function validator(thing) {\n    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;\n  };\n});\n\nconst deprecatedWarnings = {};\n\n/**\n * Transitional option validator\n *\n * @param {function|boolean?} validator - set to false if the transitional option has been removed\n * @param {string?} version - deprecated version / removed since version\n * @param {string?} message - some message with additional info\n *\n * @returns {function}\n */\nvalidators.transitional = function transitional(validator, version, message) {\n  function formatMessage(opt, desc) {\n    return '[Axios v' + VERSION + '] Transitional option \\'' + opt + '\\'' + desc + (message ? '. ' + message : '');\n  }\n\n  // eslint-disable-next-line func-names\n  return (value, opt, opts) => {\n    if (validator === false) {\n      throw new AxiosError(\n        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),\n        AxiosError.ERR_DEPRECATED\n      );\n    }\n\n    if (version && !deprecatedWarnings[opt]) {\n      deprecatedWarnings[opt] = true;\n      // eslint-disable-next-line no-console\n      console.warn(\n        formatMessage(\n          opt,\n          ' has been deprecated since v' + version + ' and will be removed in the near future'\n        )\n      );\n    }\n\n    return validator ? validator(value, opt, opts) : true;\n  };\n};\n\nvalidators.spelling = function spelling(correctSpelling) {\n  return (value, opt) => {\n    // eslint-disable-next-line no-console\n    console.warn(`${opt} is likely a misspelling of ${correctSpelling}`);\n    return true;\n  }\n};\n\n/**\n * Assert object's properties type\n *\n * @param {object} options\n * @param {object} schema\n * @param {boolean?} allowUnknown\n *\n * @returns {object}\n */\n\nfunction assertOptions(options, schema, allowUnknown) {\n  if (typeof options !== 'object') {\n    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);\n  }\n  const keys = Object.keys(options);\n  let i = keys.length;\n  while (i-- > 0) {\n    const opt = keys[i];\n    const validator = schema[opt];\n    if (validator) {\n      const value = options[opt];\n      const result = value === undefined || validator(value, opt, options);\n      if (result !== true) {\n        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);\n      }\n      continue;\n    }\n    if (allowUnknown !== true) {\n      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);\n    }\n  }\n}\n\nexport default {\n  assertOptions,\n  validators\n};\n","'use strict';\n\nimport utils from './../utils.js';\nimport buildURL from '../helpers/buildURL.js';\nimport InterceptorManager from './InterceptorManager.js';\nimport dispatchRequest from './dispatchRequest.js';\nimport mergeConfig from './mergeConfig.js';\nimport buildFullPath from './buildFullPath.js';\nimport validator from '../helpers/validator.js';\nimport AxiosHeaders from './AxiosHeaders.js';\n\nconst validators = validator.validators;\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n *\n * @return {Axios} A new instance of Axios\n */\nclass Axios {\n  constructor(instanceConfig) {\n    this.defaults = instanceConfig || {};\n    this.interceptors = {\n      request: new InterceptorManager(),\n      response: new InterceptorManager()\n    };\n  }\n\n  /**\n   * Dispatch a request\n   *\n   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)\n   * @param {?Object} config\n   *\n   * @returns {Promise} The Promise to be fulfilled\n   */\n  async request(configOrUrl, config) {\n    try {\n      return await this._request(configOrUrl, config);\n    } catch (err) {\n      if (err instanceof Error) {\n        let dummy = {};\n\n        Error.captureStackTrace ? Error.captureStackTrace(dummy) : (dummy = new Error());\n\n        // slice off the Error: ... line\n        const stack = dummy.stack ? dummy.stack.replace(/^.+\\n/, '') : '';\n        try {\n          if (!err.stack) {\n            err.stack = stack;\n            // match without the 2 top stack lines\n          } else if (stack && !String(err.stack).endsWith(stack.replace(/^.+\\n.+\\n/, ''))) {\n            err.stack += '\\n' + stack\n          }\n        } catch (e) {\n          // ignore the case where \"stack\" is an un-writable property\n        }\n      }\n\n      throw err;\n    }\n  }\n\n  _request(configOrUrl, config) {\n    /*eslint no-param-reassign:0*/\n    // Allow for axios('example/url'[, config]) a la fetch API\n    if (typeof configOrUrl === 'string') {\n      config = config || {};\n      config.url = configOrUrl;\n    } else {\n      config = configOrUrl || {};\n    }\n\n    config = mergeConfig(this.defaults, config);\n\n    const {transitional, paramsSerializer, headers} = config;\n\n    if (transitional !== undefined) {\n      validator.assertOptions(transitional, {\n        silentJSONParsing: validators.transitional(validators.boolean),\n        forcedJSONParsing: validators.transitional(validators.boolean),\n        clarifyTimeoutError: validators.transitional(validators.boolean)\n      }, false);\n    }\n\n    if (paramsSerializer != null) {\n      if (utils.isFunction(paramsSerializer)) {\n        config.paramsSerializer = {\n          serialize: paramsSerializer\n        }\n      } else {\n        validator.assertOptions(paramsSerializer, {\n          encode: validators.function,\n          serialize: validators.function\n        }, true);\n      }\n    }\n\n    // Set config.allowAbsoluteUrls\n    if (config.allowAbsoluteUrls !== undefined) {\n      // do nothing\n    } else if (this.defaults.allowAbsoluteUrls !== undefined) {\n      config.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls;\n    } else {\n      config.allowAbsoluteUrls = true;\n    }\n\n    validator.assertOptions(config, {\n      baseUrl: validators.spelling('baseURL'),\n      withXsrfToken: validators.spelling('withXSRFToken')\n    }, true);\n\n    // Set config.method\n    config.method = (config.method || this.defaults.method || 'get').toLowerCase();\n\n    // Flatten headers\n    let contextHeaders = headers && utils.merge(\n      headers.common,\n      headers[config.method]\n    );\n\n    headers && utils.forEach(\n      ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n      (method) => {\n        delete headers[method];\n      }\n    );\n\n    config.headers = AxiosHeaders.concat(contextHeaders, headers);\n\n    // filter out skipped interceptors\n    const requestInterceptorChain = [];\n    let synchronousRequestInterceptors = true;\n    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n      if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {\n        return;\n      }\n\n      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;\n\n      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    const responseInterceptorChain = [];\n    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    let promise;\n    let i = 0;\n    let len;\n\n    if (!synchronousRequestInterceptors) {\n      const chain = [dispatchRequest.bind(this), undefined];\n      chain.unshift.apply(chain, requestInterceptorChain);\n      chain.push.apply(chain, responseInterceptorChain);\n      len = chain.length;\n\n      promise = Promise.resolve(config);\n\n      while (i < len) {\n        promise = promise.then(chain[i++], chain[i++]);\n      }\n\n      return promise;\n    }\n\n    len = requestInterceptorChain.length;\n\n    let newConfig = config;\n\n    i = 0;\n\n    while (i < len) {\n      const onFulfilled = requestInterceptorChain[i++];\n      const onRejected = requestInterceptorChain[i++];\n      try {\n        newConfig = onFulfilled(newConfig);\n      } catch (error) {\n        onRejected.call(this, error);\n        break;\n      }\n    }\n\n    try {\n      promise = dispatchRequest.call(this, newConfig);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n\n    i = 0;\n    len = responseInterceptorChain.length;\n\n    while (i < len) {\n      promise = promise.then(responseInterceptorChain[i++], responseInterceptorChain[i++]);\n    }\n\n    return promise;\n  }\n\n  getUri(config) {\n    config = mergeConfig(this.defaults, config);\n    const fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);\n    return buildURL(fullPath, config.params, config.paramsSerializer);\n  }\n}\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method,\n      url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n\n  function generateHTTPMethod(isForm) {\n    return function httpMethod(url, data, config) {\n      return this.request(mergeConfig(config || {}, {\n        method,\n        headers: isForm ? {\n          'Content-Type': 'multipart/form-data'\n        } : {},\n        url,\n        data\n      }));\n    };\n  }\n\n  Axios.prototype[method] = generateHTTPMethod();\n\n  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);\n});\n\nexport default Axios;\n","'use strict';\n\nimport CanceledError from './CanceledError.js';\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @param {Function} executor The executor function.\n *\n * @returns {CancelToken}\n */\nclass CancelToken {\n  constructor(executor) {\n    if (typeof executor !== 'function') {\n      throw new TypeError('executor must be a function.');\n    }\n\n    let resolvePromise;\n\n    this.promise = new Promise(function promiseExecutor(resolve) {\n      resolvePromise = resolve;\n    });\n\n    const token = this;\n\n    // eslint-disable-next-line func-names\n    this.promise.then(cancel => {\n      if (!token._listeners) return;\n\n      let i = token._listeners.length;\n\n      while (i-- > 0) {\n        token._listeners[i](cancel);\n      }\n      token._listeners = null;\n    });\n\n    // eslint-disable-next-line func-names\n    this.promise.then = onfulfilled => {\n      let _resolve;\n      // eslint-disable-next-line func-names\n      const promise = new Promise(resolve => {\n        token.subscribe(resolve);\n        _resolve = resolve;\n      }).then(onfulfilled);\n\n      promise.cancel = function reject() {\n        token.unsubscribe(_resolve);\n      };\n\n      return promise;\n    };\n\n    executor(function cancel(message, config, request) {\n      if (token.reason) {\n        // Cancellation has already been requested\n        return;\n      }\n\n      token.reason = new CanceledError(message, config, request);\n      resolvePromise(token.reason);\n    });\n  }\n\n  /**\n   * Throws a `CanceledError` if cancellation has been requested.\n   */\n  throwIfRequested() {\n    if (this.reason) {\n      throw this.reason;\n    }\n  }\n\n  /**\n   * Subscribe to the cancel signal\n   */\n\n  subscribe(listener) {\n    if (this.reason) {\n      listener(this.reason);\n      return;\n    }\n\n    if (this._listeners) {\n      this._listeners.push(listener);\n    } else {\n      this._listeners = [listener];\n    }\n  }\n\n  /**\n   * Unsubscribe from the cancel signal\n   */\n\n  unsubscribe(listener) {\n    if (!this._listeners) {\n      return;\n    }\n    const index = this._listeners.indexOf(listener);\n    if (index !== -1) {\n      this._listeners.splice(index, 1);\n    }\n  }\n\n  toAbortSignal() {\n    const controller = new AbortController();\n\n    const abort = (err) => {\n      controller.abort(err);\n    };\n\n    this.subscribe(abort);\n\n    controller.signal.unsubscribe = () => this.unsubscribe(abort);\n\n    return controller.signal;\n  }\n\n  /**\n   * Returns an object that contains a new `CancelToken` and a function that, when called,\n   * cancels the `CancelToken`.\n   */\n  static source() {\n    let cancel;\n    const token = new CancelToken(function executor(c) {\n      cancel = c;\n    });\n    return {\n      token,\n      cancel\n    };\n  }\n}\n\nexport default CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n *\n * @returns {Function}\n */\nexport default function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n *\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nexport default function isAxiosError(payload) {\n  return utils.isObject(payload) && (payload.isAxiosError === true);\n}\n","const HttpStatusCode = {\n  Continue: 100,\n  SwitchingProtocols: 101,\n  Processing: 102,\n  EarlyHints: 103,\n  Ok: 200,\n  Created: 201,\n  Accepted: 202,\n  NonAuthoritativeInformation: 203,\n  NoContent: 204,\n  ResetContent: 205,\n  PartialContent: 206,\n  MultiStatus: 207,\n  AlreadyReported: 208,\n  ImUsed: 226,\n  MultipleChoices: 300,\n  MovedPermanently: 301,\n  Found: 302,\n  SeeOther: 303,\n  NotModified: 304,\n  UseProxy: 305,\n  Unused: 306,\n  TemporaryRedirect: 307,\n  PermanentRedirect: 308,\n  BadRequest: 400,\n  Unauthorized: 401,\n  PaymentRequired: 402,\n  Forbidden: 403,\n  NotFound: 404,\n  MethodNotAllowed: 405,\n  NotAcceptable: 406,\n  ProxyAuthenticationRequired: 407,\n  RequestTimeout: 408,\n  Conflict: 409,\n  Gone: 410,\n  LengthRequired: 411,\n  PreconditionFailed: 412,\n  PayloadTooLarge: 413,\n  UriTooLong: 414,\n  UnsupportedMediaType: 415,\n  RangeNotSatisfiable: 416,\n  ExpectationFailed: 417,\n  ImATeapot: 418,\n  MisdirectedRequest: 421,\n  UnprocessableEntity: 422,\n  Locked: 423,\n  FailedDependency: 424,\n  TooEarly: 425,\n  UpgradeRequired: 426,\n  PreconditionRequired: 428,\n  TooManyRequests: 429,\n  RequestHeaderFieldsTooLarge: 431,\n  UnavailableForLegalReasons: 451,\n  InternalServerError: 500,\n  NotImplemented: 501,\n  BadGateway: 502,\n  ServiceUnavailable: 503,\n  GatewayTimeout: 504,\n  HttpVersionNotSupported: 505,\n  VariantAlsoNegotiates: 506,\n  InsufficientStorage: 507,\n  LoopDetected: 508,\n  NotExtended: 510,\n  NetworkAuthenticationRequired: 511,\n};\n\nObject.entries(HttpStatusCode).forEach(([key, value]) => {\n  HttpStatusCode[value] = key;\n});\n\nexport default HttpStatusCode;\n","'use strict';\n\nimport utils from './utils.js';\nimport bind from './helpers/bind.js';\nimport Axios from './core/Axios.js';\nimport mergeConfig from './core/mergeConfig.js';\nimport defaults from './defaults/index.js';\nimport formDataToJSON from './helpers/formDataToJSON.js';\nimport CanceledError from './cancel/CanceledError.js';\nimport CancelToken from './cancel/CancelToken.js';\nimport isCancel from './cancel/isCancel.js';\nimport {VERSION} from './env/data.js';\nimport toFormData from './helpers/toFormData.js';\nimport AxiosError from './core/AxiosError.js';\nimport spread from './helpers/spread.js';\nimport isAxiosError from './helpers/isAxiosError.js';\nimport AxiosHeaders from \"./core/AxiosHeaders.js\";\nimport adapters from './adapters/adapters.js';\nimport HttpStatusCode from './helpers/HttpStatusCode.js';\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n *\n * @returns {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  const context = new Axios(defaultConfig);\n  const instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context, {allOwnKeys: true});\n\n  // Copy context to instance\n  utils.extend(instance, context, null, {allOwnKeys: true});\n\n  // Factory for creating new instances\n  instance.create = function create(instanceConfig) {\n    return createInstance(mergeConfig(defaultConfig, instanceConfig));\n  };\n\n  return instance;\n}\n\n// Create the default instance to be exported\nconst axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Expose Cancel & CancelToken\naxios.CanceledError = CanceledError;\naxios.CancelToken = CancelToken;\naxios.isCancel = isCancel;\naxios.VERSION = VERSION;\naxios.toFormData = toFormData;\n\n// Expose AxiosError class\naxios.AxiosError = AxiosError;\n\n// alias for CanceledError for backward compatibility\naxios.Cancel = axios.CanceledError;\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\n\naxios.spread = spread;\n\n// Expose isAxiosError\naxios.isAxiosError = isAxiosError;\n\n// Expose mergeConfig\naxios.mergeConfig = mergeConfig;\n\naxios.AxiosHeaders = AxiosHeaders;\n\naxios.formToJSON = thing => formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);\n\naxios.getAdapter = adapters.getAdapter;\n\naxios.HttpStatusCode = HttpStatusCode;\n\naxios.default = axios;\n\n// this module should only have a default export\nexport default axios\n","import axios from './lib/axios.js';\n\n// This module is intended to unwrap Axios default export as named.\n// Keep top-level export same with static properties\n// so that it can keep same with es module or cjs\nconst {\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n} = axios;\n\nexport {\n  axios as default,\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n}\n","import type { AxiosResponse } from 'axios'\nimport axios from 'axios'\n\nexport interface ModelOption {\n  value: string\n  label: string\n}\n\nexport interface AvailableModelsResponse {\n  options: ModelOption[]\n  total: number\n}\n\nexport class ConfigApiService {\n  /**\n   * Get available model list\n   */\n  public static async getAvailableModels(): Promise<AvailableModelsResponse> {\n    try {\n      const response: AxiosResponse<AvailableModelsResponse> = await axios({\n        url: '/api/models/available-models',\n        method: 'GET',\n        baseURL: '' // Override the default /api/v1 baseURL\n      })\n      return response.data\n    } catch (error) {\n      console.error('Failed to fetch available models:', error)\n      return { options: [], total: 0 }\n    }\n  }\n} \n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"assigned-tools\">\n    <div class=\"section-header\">\n      <span>{{ title }} ({{ filteredSelectedToolIds.length }})</span>\n      <button \n        class=\"action-btn small\"\n        @click=\"$emit('add-tools')\"\n        v-if=\"showAddButton\"\n      >\n        <Icon icon=\"carbon:add\" />\n        {{ addButtonText }}\n      </button>\n    </div>\n\n    <div class=\"tools-grid\" :class=\"{ 'grid-layout': useGridLayout }\">\n      <div\n        v-for=\"toolId in filteredSelectedToolIds\" \n        :key=\"toolId\"\n        class=\"tool-item assigned\"\n      >\n        <div class=\"tool-info\">\n          <span class=\"tool-name\">{{ getToolDisplayName(toolId) }}</span>\n          <span class=\"tool-desc\">{{ getToolDescription(toolId) }}</span>\n        </div>\n      </div>\n\n      <div v-if=\"filteredSelectedToolIds.length === 0\" class=\"no-tools\">\n        <Icon icon=\"carbon:tool-box\" />\n        <span>{{ emptyText }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { computed, watch } from 'vue'\n\n// Props\ninterface Props {\n  title: string\n  selectedToolIds: string[]\n  availableTools: Array<{\n    key: string\n    name: string\n    description: string\n    enabled: boolean\n    serviceGroup: string\n    selectable: boolean\n  }>\n  addButtonText?: string\n  emptyText?: string\n  showAddButton?: boolean\n  useGridLayout?: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  addButtonText: 'Add/Remove Tools',\n  emptyText: 'No tools assigned',\n  showAddButton: true,\n  useGridLayout: false\n})\n\n// Emits\nconst emit = defineEmits<{\n  'add-tools': []\n  'tools-filtered': [filteredToolIds: string[]]\n}>()\n\n// Computed property to filter out tools that are not in availableTools\nconst filteredSelectedToolIds = computed(() => {\n  return props.selectedToolIds.filter(toolId => \n    props.availableTools.some(tool => tool.key === toolId)\n  )\n})\n\n// Watch for changes in filtered tools and emit event\nwatch(filteredSelectedToolIds, (newFilteredTools) => {\n  // Only emit if there's a difference (some tools were filtered out)\n  if (newFilteredTools.length !== props.selectedToolIds.length) {\n    emit('tools-filtered', newFilteredTools)\n  }\n}, { immediate: true })\n\n// Methods\nconst getToolDisplayName = (toolId: string): string => {\n  const tool = props.availableTools.find(t => t.key === toolId)\n  return tool ? tool.name : toolId\n}\n\nconst getToolDescription = (toolId: string): string => {\n  const tool = props.availableTools.find(t => t.key === toolId)\n  return tool ? tool.description : ''\n}\n</script>\n\n<style scoped>\n.assigned-tools {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.section-header span {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 14px;\n}\n\n.action-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.action-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.action-btn.small {\n  padding: 6px 10px;\n  font-size: 11px;\n}\n\n.tools-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.tools-grid.grid-layout {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 12px;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.tool-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  transition: all 0.3s ease;\n}\n\n.tools-grid.grid-layout .tool-item {\n  padding: 12px;\n  justify-content: flex-start;\n}\n\n.tool-item:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.tool-item.assigned {\n  border-color: rgba(102, 126, 234, 0.3);\n  background: rgba(102, 126, 234, 0.1);\n}\n\n.tool-info {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  flex: 1;\n}\n\n.tool-name {\n  display: block;\n  font-weight: 500;\n  margin-bottom: 4px;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n}\n\n.tool-desc {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.3;\n}\n\n.no-tools {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  padding: 40px;\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.tools-grid.grid-layout .no-tools {\n  padding: 16px;\n  font-size: 12px;\n  grid-column: 1 / -1;\n}\n\n.no-tools svg {\n  width: 20px;\n  height: 20px;\n  opacity: 0.5;\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Modal\n    v-model=\"visible\"\n    :title=\"$t('toolSelection.title')\"\n    @confirm=\"handleConfirm\"\n    @update:model-value=\"handleCancel\"\n  >\n    <div class=\"tool-selection-content\">\n      <!-- Search and Sort -->\n      <div class=\"tool-controls\">\n        <div class=\"search-container\">\n          <input\n            v-model=\"searchQuery\"\n            type=\"text\"\n            class=\"search-input\"\n            :placeholder=\"$t('toolSelection.searchPlaceholder')\"\n          />\n        </div>\n        <div class=\"sort-container\">\n          <select v-model=\"sortBy\" class=\"sort-select\">\n            <option value=\"group\">{{ $t('toolSelection.sortByGroup') }}</option>\n            <option value=\"name\">{{ $t('toolSelection.sortByName') }}</option>\n            <option value=\"enabled\">{{ $t('toolSelection.sortByStatus') }}</option>\n          </select>\n        </div>\n      </div>\n\n      <!-- Tool Statistics -->\n      <div class=\"tool-summary\">\n        <span class=\"summary-text\">\n          {{ $t('toolSelection.summary', {\n            groups: groupedTools.size,\n            tools: totalTools,\n            selected: selectedTools.length\n          }) }}\n        </span>\n      </div>\n\n      <!-- Tool Group List -->\n      <div class=\"tool-groups\" v-if=\"groupedTools.size > 0\">\n        <div\n          v-for=\"[groupName, tools] in groupedTools\"\n          :key=\"groupName\"\n          class=\"tool-group\"\n        >\n          <!-- Group Header -->\n          <div\n            class=\"tool-group-header\"\n            :class=\"{ collapsed: collapsedGroups.has(groupName) }\"\n            @click=\"toggleGroupCollapse(groupName)\"\n          >\n            <div class=\"group-title-area\">\n              <Icon\n                :icon=\"collapsedGroups.has(groupName) ? 'carbon:chevron-right' : 'carbon:chevron-down'\"\n                class=\"collapse-icon\"\n              />\n              <Icon icon=\"carbon:folder\" class=\"group-icon\" />\n              <span class=\"group-name\">{{ groupName }}</span>\n              <span class=\"group-count\">\n                ({{ getSelectedToolsInGroup(tools).length }}/{{ tools.length }})\n              </span>\n            </div>\n            <div class=\"group-actions\" @click.stop>\n              <label class=\"group-enable-all\">\n                <input\n                  type=\"checkbox\"\n                  class=\"group-enable-checkbox\"\n                  :checked=\"isGroupFullySelected(tools)\"\n                  @change=\"toggleGroupSelection(tools, $event)\"\n                  :data-group=\"groupName\"\n                />\n                <span class=\"enable-label\">{{ $t('toolSelection.enableAll') }}</span>\n              </label>\n            </div>\n          </div>\n\n          <!-- Group Content -->\n          <div\n            class=\"tool-group-content\"\n            :class=\"{ collapsed: collapsedGroups.has(groupName) }\"\n          >\n            <div\n              v-for=\"tool in tools\"\n              :key=\"tool.key\"\n              class=\"tool-selection-item\"\n            >\n              <div class=\"tool-info\">\n                <div class=\"tool-selection-name\">{{ tool.name }}</div>\n                <div v-if=\"tool.description\" class=\"tool-selection-desc\">\n                  {{ tool.description }}\n                </div>\n              </div>\n              <div class=\"tool-actions\">\n                <label class=\"tool-enable-switch\" @click.stop>\n                  <input\n                    type=\"checkbox\"\n                    class=\"tool-enable-checkbox\"\n                    :checked=\"isToolSelected(tool.key)\"\n                    @change=\"toggleToolSelection(tool.key, $event)\"\n                  />\n                  <span class=\"tool-enable-slider\"></span>\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Empty State -->\n      <div v-else class=\"empty-state\">\n        <Icon icon=\"carbon:tools\" class=\"empty-icon\" />\n        <p>{{ $t('toolSelection.noToolsFound') }}</p>\n      </div>\n    </div>\n  </Modal>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch, nextTick } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport Modal from '../modal/index.vue'\nimport type { Tool } from '@/api/agent-api-service'\n\ninterface Props {\n  modelValue: boolean\n  tools: Tool[]\n  selectedToolIds: string[]\n}\n\ninterface Emits {\n  (e: 'update:modelValue', value: boolean): void\n  (e: 'confirm', selectedToolIds: string[]): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Reactive state\nconst visible = computed({\n  get: () => props.modelValue,\n  set: (value) => emit('update:modelValue', value)\n})\n\nconst searchQuery = ref('')\nconst sortBy = ref<'group' | 'name' | 'enabled'>('group')\nconst collapsedGroups = ref(new Set<string>())\nconst selectedTools = ref<string[]>([])\n\n// Set group checkbox indeterminate state\nconst updateGroupCheckboxState = (groupName: string, tools: Tool[]) => {\n  const checkbox = document.querySelector(`input[data-group=\"${groupName}\"]`) as HTMLInputElement | null\n  if (checkbox) {\n    checkbox.indeterminate = isGroupPartiallySelected(tools)\n  }\n}\n\n// Initialize the selected tools\nwatch(\n  () => props.selectedToolIds,\n  (newIds) => {\n    selectedTools.value = [...newIds]\n  },\n  { immediate: true }\n)\n\n// Filtered and sorted tools\nconst filteredTools = computed(() => {\n  let filtered = props.tools.filter(tool => tool.key) // Filter out invalid tools\n  \n  // Filter out non-selectable tools\n  filtered = filtered.filter(tool => tool.selectable === true)\n\n  // Search filter\n  if (searchQuery.value) {\n    const query = searchQuery.value.toLowerCase()\n    filtered = filtered.filter(\n      tool =>\n        tool.name.toLowerCase().includes(query) ||\n        tool.description.toLowerCase().includes(query) ||\n        tool.serviceGroup.toLowerCase().includes(query)\n    )\n  }\n\n  // Sorting\n  switch (sortBy.value) {\n    case 'name':\n      filtered = [...filtered].sort((a, b) => a.name.localeCompare(b.name))\n      break\n    case 'enabled':\n      filtered = [...filtered].sort((a, b) => {\n        const aSelected = selectedTools.value.includes(a.key)\n        const bSelected = selectedTools.value.includes(b.key)\n        if (aSelected && !bSelected) return -1\n        if (!aSelected && bSelected) return 1\n        return a.name.localeCompare(b.name)\n      })\n      break\n    case 'group':\n    default:\n      filtered = [...filtered].sort((a, b) => {\n        const groupA = a.serviceGroup || 'Ungrouped'\n        const groupB = b.serviceGroup || 'Ungrouped'\n        if (groupA !== groupB) {\n          return groupA.localeCompare(groupB)\n        }\n        return a.name.localeCompare(b.name)\n      })\n      break\n  }\n\n  return filtered\n})\n\n// Tools grouped by service group\nconst groupedTools = computed(() => {\n  const groups = new Map<string, Tool[]>()\n\n  filteredTools.value.forEach(tool => {\n    const groupName = tool.serviceGroup || 'Ungrouped'\n    if (!groups.has(groupName)) {\n      groups.set(groupName, [])\n    }\n    groups.get(groupName)!.push(tool)\n  })\n\n  // Sort the groups\n  return new Map([...groups.entries()].sort())\n})\n\n// Total number of tools\nconst totalTools = computed(() => filteredTools.value.length)\n\n// Watch for changes in the selected state and update the indeterminate state of group checkboxes\nwatch(\n  [selectedTools, groupedTools],\n  () => {\n    nextTick(() => {\n      for (const [groupName, tools] of groupedTools.value) {\n        updateGroupCheckboxState(groupName, tools)\n      }\n    })\n  },\n  { flush: 'post', deep: false }\n)\n\n// Tool selection logic\nconst isToolSelected = (toolKey: string) => {\n  return selectedTools.value.includes(toolKey)\n}\n\nconst toggleToolSelection = (toolKey: string, event: Event) => {\n  event.stopPropagation()\n  const target = event.target as HTMLInputElement\n  const isChecked = target.checked\n\n  // Prevent undefined toolKey\n  if (!toolKey) {\n    console.error('toolKey is undefined, cannot proceed')\n    return\n  }\n\n  if (isChecked) {\n    // Add the tool to the selected list\n    if (!selectedTools.value.includes(toolKey)) {\n      selectedTools.value = [...selectedTools.value, toolKey]\n    }\n  } else {\n    // Remove the tool from the selected list\n    selectedTools.value = selectedTools.value.filter(id => id !== toolKey)\n  }\n}\n\n// Group selection logic\nconst getSelectedToolsInGroup = (tools: Tool[]) => {\n  return tools.filter(tool => selectedTools.value.includes(tool.key))\n}\n\nconst isGroupFullySelected = (tools: Tool[]) => {\n  return tools.length > 0 && tools.every(tool => selectedTools.value.includes(tool.key))\n}\n\nconst isGroupPartiallySelected = (tools: Tool[]) => {\n  const selectedCount = getSelectedToolsInGroup(tools).length\n  return selectedCount > 0 && selectedCount < tools.length\n}\n\nconst toggleGroupSelection = (tools: Tool[], event: Event) => {\n  event.stopPropagation()\n  const target = event.target as HTMLInputElement\n  const isChecked = target.checked\n  const toolKeys = tools.map(tool => tool.key)\n\n  if (isChecked) {\n    // Select all tools in the group - Use a new array to avoid reference issues\n    const newSelected = [...selectedTools.value]\n    toolKeys.forEach(key => {\n      if (!newSelected.includes(key)) {\n        newSelected.push(key)\n      }\n    })\n    selectedTools.value = newSelected\n  } else {\n    // Deselect all tools in the group - Create a new array\n    selectedTools.value = selectedTools.value.filter(id => !toolKeys.includes(id))\n  }\n}\n\n// Group collapse logic\nconst toggleGroupCollapse = (groupName: string) => {\n  if (collapsedGroups.value.has(groupName)) {\n    collapsedGroups.value.delete(groupName)\n  } else {\n    collapsedGroups.value.add(groupName)\n  }\n}\n\n// Dialog event handling\nconst handleConfirm = () => {\n  emit('confirm', [...selectedTools.value])\n  emit('update:modelValue', false)\n}\n\nconst handleCancel = () => {\n// Translate to English and follow frontend terminology\n  selectedTools.value = [...props.selectedToolIds]\n  emit('update:modelValue', false)\n}\n\n// When the modal opens, expand the first group by default and collapse the others\nwatch(visible, (newVisible) => {\n  if (newVisible) {\n    collapsedGroups.value.clear()\n    const groupNames = Array.from(groupedTools.value.keys())\n    if (groupNames.length > 1) {\n      // Collapse all groups except the first one by default\n      groupNames.slice(1).forEach(name => {\n        collapsedGroups.value.add(name)\n      })\n    }\n  }\n})\n</script>\n\n<style scoped>\n.tool-selection-content {\n  min-height: 400px;\n  max-height: 600px;\n  overflow-y: auto;\n}\n\n.tool-controls {\n  display: flex;\n  gap: 12px;\n  margin-bottom: 16px;\n  padding: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.search-container {\n  flex: 1;\n}\n\n.search-input {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  transition: all 0.3s;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: rgba(102, 126, 234, 0.5);\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.search-input::placeholder {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.sort-container {\n  min-width: 140px;\n}\n\n.sort-select {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  cursor: pointer;\n}\n\n.tool-summary {\n  margin-bottom: 16px;\n  padding: 8px 0;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.summary-text {\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 13px;\n}\n\n\n.tool-group {\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n  margin-bottom: 8px;\n}\n\n.tool-group-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  cursor: pointer;\n  transition: all 0.3s;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.tool-group-header:hover {\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.tool-group-header.collapsed {\n  border-bottom: none;\n}\n\n.group-title-area {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n}\n\n.collapse-icon {\n  color: rgba(255, 255, 255, 0.6);\n  transition: transform 0.3s;\n}\n\n.group-icon {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.group-name {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.group-count {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 13px;\n}\n\n.group-actions {\n  display: flex;\n  align-items: center;\n}\n\n.group-enable-all {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 13px;\n}\n\n.group-enable-checkbox {\n  cursor: pointer;\n}\n\n.tool-group-content {\n  max-height: 300px;\n  overflow-y: auto;\n  transition: all 0.3s;\n}\n\n.tool-group-content.collapsed {\n  max-height: 0;\n  overflow: hidden;\n}\n\n.tool-selection-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n  transition: background-color 0.3s;\n}\n\n.tool-selection-item:hover {\n  background: rgba(255, 255, 255, 0.03);\n}\n\n.tool-selection-item:last-child {\n  border-bottom: none;\n}\n\n.tool-info {\n  flex: 1;\n}\n\n.tool-selection-name {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  margin-bottom: 4px;\n}\n\n.tool-selection-desc {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 13px;\n  line-height: 1.4;\n}\n\n.tool-actions {\n  margin-left: 12px;\n}\n\n.tool-enable-switch {\n  position: relative;\n  display: inline-block;\n  width: 44px;\n  height: 24px;\n  cursor: pointer;\n}\n\n.tool-enable-checkbox {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.tool-enable-slider {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 24px;\n  transition: all 0.3s;\n}\n\n.tool-enable-slider:before {\n  position: absolute;\n  content: \"\";\n  height: 18px;\n  width: 18px;\n  left: 3px;\n  bottom: 3px;\n  background: white;\n  border-radius: 50%;\n  transition: all 0.3s;\n}\n\n.tool-enable-checkbox:checked + .tool-enable-slider {\n  background: rgba(102, 126, 234, 0.8);\n}\n\n.tool-enable-checkbox:checked + .tool-enable-slider:before {\n  transform: translateX(20px);\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 60px 20px;\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.empty-icon {\n  font-size: 48px;\n  margin-bottom: 16px;\n  opacity: 0.6;\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:code\" width=\"16\" />\n      <span>{{ $t('sidebar.dynamicAgentPlan') }}</span>\n    </div>\n    <!-- Error Display -->\n    <div v-if=\"planTypeError\" class=\"error-section\">\n      <div class=\"error-message\">\n        <Icon icon=\"carbon:warning\" width=\"16\" />\n        <div class=\"error-content\">\n          <div class=\"error-title\">{{ $t('sidebar.planTypeError') }}</div>\n          <div class=\"error-description\">{{ planTypeError }}</div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Visual JSON Editor -->\n    <div v-else class=\"visual-editor\">\n      <!-- Plan Basic Info -->\n      <div class=\"plan-basic-info\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.title') }}</label>\n          <input\n            v-model=\"displayData.title\"\n            type=\"text\"\n            class=\"form-input\"\n            :class=\"{ error: titleError }\"\n            :placeholder=\"$t('sidebar.titlePlaceholder')\"\n          />\n          <!-- Inline validation message for title -->\n          <div v-if=\"titleError\" class=\"field-error-message\">\n            <Icon icon=\"carbon:warning\" width=\"12\" />\n            {{ titleError }}\n          </div>\n        </div>\n\n        <!-- Plan Template ID (Read-only) -->\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.planTemplateId') }}</label>\n          <input\n            :value=\"currentPlanTemplateId\"\n            type=\"text\"\n            class=\"form-input readonly-input\"\n            readonly\n            :placeholder=\"$t('sidebar.planTemplateIdPlaceholder')\"\n          />\n        </div>\n      </div>\n\n      <!-- Steps Editor -->\n      <div class=\"steps-section\">\n        <div class=\"steps-header\">\n          <label class=\"form-label\">{{ $t('sidebar.tasks') }}</label>\n          <div class=\"steps-actions\">\n            <button @click=\"addStep\" class=\"btn btn-xs\" :title=\"$t('sidebar.addStep')\">\n              <Icon icon=\"carbon:add\" width=\"12\" />\n            </button>\n          </div>\n        </div>\n\n        <div class=\"steps-container\">\n          <div v-for=\"(step, index) in displayData.steps\" :key=\"index\" class=\"step-item\">\n            <div class=\"step-header\">\n              <span class=\"step-number\">{{ $t('sidebar.subtask') }} {{ index + 1 }}</span>\n              <div class=\"step-actions\">\n                <button\n                  @click=\"moveStepUp(index)\"\n                  :disabled=\"index === 0\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveUp')\"\n                >\n                  <Icon icon=\"carbon:chevron-up\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"moveStepDown(index)\"\n                  :disabled=\"index === displayData.steps.length - 1\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveDown')\"\n                >\n                  <Icon icon=\"carbon:chevron-down\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"removeStep(index)\"\n                  class=\"btn btn-xs btn-danger\"\n                  :title=\"$t('sidebar.removeStep')\"\n                >\n                  <Icon icon=\"carbon:trash-can\" width=\"12\" />\n                </button>\n              </div>\n            </div>\n\n            <div class=\"step-content\">\n              <!-- Step Requirement -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.stepRequirement') }}</label>\n                <textarea\n                  v-model=\"step.stepRequirement\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.stepRequirementPlaceholder')\"\n                  rows=\"4\"\n                  @input=\"autoResizeTextarea($event)\"\n                ></textarea>\n              </div>\n\n              <!-- Terminate Columns -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.terminateColumns') }}</label>\n\n                <textarea\n                  v-model=\"step.terminateColumns\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.terminateColumnsPlaceholder')\"\n                  rows=\"4\"\n                  @input=\"autoResizeTextarea($event)\"\n                ></textarea>\n\n                <!-- Preview Section -->\n                <div\n                  v-if=\"step.terminateColumns && step.terminateColumns.trim()\"\n                  class=\"preview-section\"\n                >\n                  <div class=\"preview-label\">{{ $t('sidebar.preview') }}:</div>\n                  <div class=\"preview-content\">\n                    <div class=\"preview-text\">\n                      {{ $t('sidebar.systemWillReturnListWithTableHeaderFormat') }}:\n                      <span class=\"preview-table-header\">{{\n                        formatTableHeader(step.terminateColumns)\n                      }}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <!-- Model Name -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.modelName') }}</label>\n                <div class=\"model-selector\">\n                  <select\n                    v-model=\"step.modelName\"\n                    class=\"form-select model-select\"\n                    :disabled=\"isLoadingModels\"\n                  >\n                    <!-- Loading state -->\n                    <option v-if=\"isLoadingModels\" disabled value=\"\">\n                      {{ $t('sidebar.loading') }}\n                    </option>\n\n                    <!-- Error state -->\n                    <option v-else-if=\"modelsLoadError\" disabled value=\"\">\n                      {{ $t('sidebar.modelLoadError') }}\n                    </option>\n\n                    <!-- Placeholder option -->\n                    <option value=\"\" disabled>{{ $t('sidebar.modelNameDescription') }}</option>\n\n                    <!-- Default empty option -->\n                    <option value=\"\">{{ $t('sidebar.noModelSelected') }}</option>\n\n                    <!-- Model options -->\n                    <option\n                      v-for=\"model in availableModels\"\n                      :key=\"model.value\"\n                      :value=\"model.value\"\n                      :title=\"model.label\"\n                    >\n                      {{ model.label }}\n                    </option>\n                  </select>\n\n                  <!-- Error refresh button -->\n                  <button\n                    v-if=\"modelsLoadError\"\n                    @click=\"loadAvailableModels\"\n                    class=\"btn btn-sm btn-danger\"\n                    :title=\"$t('sidebar.retryLoadModels')\"\n                  >\n                    <Icon icon=\"carbon:warning\" width=\"14\" />\n                    {{ $t('sidebar.retry') }}\n                  </button>\n                </div>\n\n                <!-- Error message -->\n                <div v-if=\"modelsLoadError\" class=\"error-message\">\n                  <Icon icon=\"carbon:warning\" width=\"12\" />\n                  {{ modelsLoadError }}\n                </div>\n              </div>\n\n              <!-- Tool Selection -->\n              <div class=\"form-row\">\n                <AssignedTools\n                  :title=\"$t('sidebar.selectedTools')\"\n                  :selected-tool-ids=\"step.selectedToolKeys\"\n                  :available-tools=\"sidebarStore.availableTools\"\n                  :add-button-text=\"$t('sidebar.addRemoveTools')\"\n                  :empty-text=\"$t('sidebar.noTools')\"\n                  :use-grid-layout=\"true\"\n                  @add-tools=\"showToolSelectionModal(index)\"\n                  @tools-filtered=\"\n                    (filteredTools: string[]) => handleToolsFiltered(index, filteredTools)\n                  \"\n                />\n              </div>\n            </div>\n          </div>\n\n          <!-- Empty State -->\n          <div v-if=\"displayData.steps.length === 0\" class=\"empty-steps\">\n            <Icon icon=\"carbon:add-alt\" width=\"32\" class=\"empty-icon\" />\n            <p>{{ $t('sidebar.noSteps') }}</p>\n            <button @click=\"addStep\" class=\"btn btn-primary\">\n              <Icon icon=\"carbon:add\" width=\"14\" />\n              {{ $t('sidebar.addFirstStep') }}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- JSON Preview (Optional) -->\n      <div class=\"json-preview\" v-if=\"showJsonPreview\">\n        <div class=\"preview-header\">\n          <label class=\"form-label\">{{ $t('sidebar.jsonPreview') }}</label>\n          <button @click=\"closeJsonPreview\" class=\"btn btn-xs\">\n            <Icon icon=\"carbon:close\" width=\"12\" />\n          </button>\n        </div>\n        <pre class=\"json-code\">{{ formattedJsonOutput }}</pre>\n      </div>\n\n      <!-- Toggle JSON Preview -->\n      <div class=\"editor-footer\">\n        <button @click=\"toggleJsonPreview\" class=\"btn btn-sm btn-secondary\">\n          <Icon icon=\"carbon:code\" width=\"14\" />\n          {{ showJsonPreview ? $t('sidebar.hideJson') : $t('sidebar.showJson') }}\n        </button>\n        <div class=\"section-actions\">\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleCopyPlan\"\n            :disabled=\"isGenerating || isExecuting\"\n            :title=\"$t('sidebar.copyPlan')\"\n          >\n            <Icon icon=\"carbon:copy\" width=\"14\" />\n            {{ $t('sidebar.copyPlan') }}\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRollback\"\n            :disabled=\"!(canRollback ?? false)\"\n            :title=\"$t('sidebar.rollback')\"\n          >\n            <Icon icon=\"carbon:undo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRestore\"\n            :disabled=\"!(canRestore ?? false)\"\n            :title=\"$t('sidebar.restore')\"\n          >\n            <Icon icon=\"carbon:redo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-primary\"\n            @click=\"handleSave\"\n            :disabled=\"isGenerating || isExecuting\"\n          >\n            <Icon icon=\"carbon:save\" width=\"14\" />\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Tool Selection Modal -->\n    <ToolSelectionModal\n      v-model=\"showToolModal\"\n      :tools=\"sidebarStore.availableTools\"\n      :selected-tool-ids=\"\n        currentStepIndex >= 0 ? displayData.steps[currentStepIndex]?.selectedToolKeys || [] : []\n      \"\n      @confirm=\"handleToolSelectionConfirm\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ConfigApiService, type ModelOption } from '@/api/config-api-service'\nimport AssignedTools from '@/components/shared/AssignedTools.vue'\nimport ToolSelectionModal from '@/components/tool-selection-modal/ToolSelectionModal.vue'\nimport { sidebarStore } from '@/stores/sidebar'\nimport { Icon } from '@iconify/vue'\nimport { onMounted, ref, watch } from 'vue'\nimport { useJsonEditor, type JsonEditorProps } from './json-editor-logic'\n\n// Define props interface specific to JsonEditorV2\ninterface JsonEditorV2Props {\n  // eslint-disable-next-line vue/no-unused-properties\n  jsonContent: string\n  canRollback: boolean\n  canRestore: boolean\n  isGenerating: boolean\n  isExecuting: boolean\n  currentPlanTemplateId: string\n}\n\n// Props\nconst props = withDefaults(defineProps<JsonEditorV2Props>(), {\n  currentPlanTemplateId: '',\n})\n\n// Emits\nconst emit = defineEmits<{\n  rollback: []\n  restore: []\n  save: []\n  'copy-plan': []\n  'update:jsonContent': [value: string]\n}>()\n\n// Create compatible props object for useJsonEditor\nconst compatibleProps: JsonEditorProps = {\n  ...props,\n  hiddenFields: [],\n}\n\nconst {\n  showJsonPreview,\n  displayData,\n  formattedJsonOutput,\n  addStep,\n  removeStep,\n  moveStepUp,\n  moveStepDown,\n  handleRollback,\n  handleRestore,\n  handleSave,\n  toggleJsonPreview,\n  closeJsonPreview,\n} = useJsonEditor(compatibleProps, emit)\n\n// Error state\nconst planTypeError = ref<string | null>(null)\nconst titleError = ref<string>('')\n\n// Model selection state\nconst availableModels = ref<ModelOption[]>([])\nconst isLoadingModels = ref(false)\nconst modelsLoadError = ref<string>('')\n\n// Tool selection state - use sidebar store's availableTools\nconst showToolModal = ref(false)\nconst currentStepIndex = ref<number>(-1)\n\n// Load available models\nconst loadAvailableModels = async () => {\n  if (isLoadingModels.value) return\n\n  isLoadingModels.value = true\n  modelsLoadError.value = ''\n\n  try {\n    const response = await ConfigApiService.getAvailableModels()\n    availableModels.value = response.options\n  } catch (error) {\n    console.error('Failed to load models:', error)\n    modelsLoadError.value = error instanceof Error ? error.message : 'Failed to load models'\n    availableModels.value = []\n  } finally {\n    isLoadingModels.value = false\n  }\n}\n\n// Available tools are now loaded from sidebar store\n\n// Tool selection functions\nconst showToolSelectionModal = (stepIndex: number) => {\n  currentStepIndex.value = stepIndex\n  showToolModal.value = true\n  console.log('[JsonEditorV2] Available tools from store:', sidebarStore.availableTools)\n}\n\nconst handleToolSelectionConfirm = (selectedToolIds: string[]) => {\n  if (currentStepIndex.value >= 0 && currentStepIndex.value < displayData.steps.length) {\n    // Update the specific step's selected tool keys\n    displayData.steps[currentStepIndex.value].selectedToolKeys = [...selectedToolIds]\n  }\n  showToolModal.value = false\n  currentStepIndex.value = -1\n}\n\nconst handleToolsFiltered = (stepIndex: number, filteredTools: string[]) => {\n  if (stepIndex >= 0 && stepIndex < displayData.steps.length) {\n    // Update the step's selected tool keys with filtered tools\n    displayData.steps[stepIndex].selectedToolKeys = [...filteredTools]\n  }\n}\n\n// Copy plan function\nconst handleCopyPlan = () => {\n  emit('copy-plan')\n}\n\n// Initialize parsedData with default structure\nconst initializeParsedData = () => {\n  try {\n    // Clear any previous errors\n    planTypeError.value = null\n\n    // Initialize with default structure if not exists\n    if (!displayData.title) {\n      displayData.title = ''\n    }\n    displayData.directResponse = false // Always false for dynamic agent planning\n  } catch (error) {\n    const errorMessage = `Failed to initialize JsonEditorV2: ${error instanceof Error ? error.message : 'Unknown error'}`\n    planTypeError.value = errorMessage\n    console.error(errorMessage, error)\n  }\n}\n\n// Watch for parsedData changes to validate structure\nwatch(\n  () => displayData,\n  newData => {\n    try {\n      // Soft validation for title - show warning but don't block the form\n      if (!newData.title.trim()) {\n        titleError.value = 'Title is required field'\n      } else {\n        titleError.value = ''\n      }\n\n      // Clear any structural errors\n      planTypeError.value = null\n    } catch (error) {\n      planTypeError.value = `Invalid data structure: ${error instanceof Error ? error.message : 'Unknown error'}`\n      titleError.value = ''\n    }\n  },\n  { immediate: true, deep: true }\n)\n\n// Watch for props changes\nwatch(\n  () => props.jsonContent,\n  (newContent, oldContent) => {\n    console.log(\n      '[JsonEditorV2] Props watch triggered - jsonContent changed from',\n      oldContent,\n      'to',\n      newContent\n    )\n    if (newContent && newContent !== oldContent) {\n      console.log('[JsonEditorV2] Force parsing new jsonContent:', newContent)\n      try {\n        const parsed = JSON.parse(newContent)\n        console.log('[JsonEditorV2] Parsed new jsonContent:', parsed)\n        Object.assign(displayData, {\n          title: parsed.title || '',\n          steps: parsed.steps || [],\n          directResponse: false,\n          planTemplateId: parsed.planTemplateId || props.currentPlanTemplateId || '',\n          planType: parsed.planType || 'dynamic_agent',\n        })\n        console.log('[JsonEditorV2] Updated displayData with new content:', displayData)\n      } catch (error) {\n        console.warn('[JsonEditorV2] Failed to parse new jsonContent:', error)\n      }\n    }\n  },\n  { immediate: true }\n)\n\n// Initialize on mount\nonMounted(() => {\n  console.log('[JsonEditorV2] Component mounted with jsonContent:', props.jsonContent)\n  console.log(\n    '[JsonEditorV2] Component mounted with currentPlanTemplateId:',\n    props.currentPlanTemplateId\n  )\n  console.log('[JsonEditorV2] Component mounted with displayData:', displayData)\n\n  // Force parse the current jsonContent to ensure it's processed\n  if (props.jsonContent) {\n    console.log('[JsonEditorV2] Force parsing jsonContent on mount:', props.jsonContent)\n    // Call parseJsonToVisual directly to ensure it's processed\n    try {\n      const parsed = JSON.parse(props.jsonContent)\n      console.log('[JsonEditorV2] Parsed jsonContent on mount:', parsed)\n      Object.assign(displayData, {\n        title: parsed.title || '',\n        steps: parsed.steps || [],\n        directResponse: false,\n        planTemplateId: parsed.planTemplateId || props.currentPlanTemplateId || '',\n        planType: parsed.planType || 'dynamic_agent',\n      })\n      console.log('[JsonEditorV2] Updated displayData on mount:', displayData)\n    } catch (error) {\n      console.warn('[JsonEditorV2] Failed to parse jsonContent on mount:', error)\n    }\n  }\n\n  initializeParsedData()\n  loadAvailableModels()\n})\n\nconst autoResizeTextarea = (event: Event) => {\n  const textarea = event.target as HTMLTextAreaElement\n\n  textarea.style.height = 'auto'\n\n  const lineHeight = 20\n  const lines = Math.ceil(textarea.scrollHeight / lineHeight)\n\n  const minRows = 4\n  const maxRows = 12\n  const targetRows = Math.max(minRows, Math.min(maxRows, lines))\n\n  const newHeight = targetRows * lineHeight\n  textarea.style.height = `${newHeight}px`\n  textarea.rows = targetRows\n\n  if (lines > maxRows) {\n    textarea.style.overflowY = 'auto'\n  } else {\n    textarea.style.overflowY = 'hidden'\n  }\n}\n\n// Format table header preview\nconst formatTableHeader = (terminateColumns: string): string => {\n  if (!terminateColumns.trim()) {\n    return ''\n  }\n\n  // Split by comma and clean up each column name\n  const columns = terminateColumns\n    .split(',')\n    .map(col => col.trim())\n    .filter(col => col.length > 0)\n\n  if (columns.length === 0) {\n    return ''\n  }\n\n  // Format as |col1|col2|col3|\n  return `|${columns.join('|')}|`\n}\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.section-actions {\n  margin-left: auto;\n  display: flex;\n  gap: 6px;\n}\n\n/* Error Section Styles */\n.error-section {\n  margin-bottom: 16px;\n  background: rgba(239, 68, 68, 0.1);\n  border: 1px solid rgba(239, 68, 68, 0.3);\n  border-radius: 8px;\n  padding: 16px;\n}\n\n.error-message {\n  display: flex;\n  align-items: flex-start;\n  gap: 12px;\n  color: #ef4444;\n}\n\n.error-content {\n  flex: 1;\n}\n\n.error-title {\n  font-weight: 600;\n  font-size: 14px;\n  margin-bottom: 4px;\n}\n\n.error-description {\n  font-size: 12px;\n  color: rgba(239, 68, 68, 0.8);\n  line-height: 1.4;\n}\n\n/* Visual Editor Styles */\n.visual-editor {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 16px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.plan-basic-info {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  margin-bottom: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.form-label {\n  font-size: 10px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input,\n.form-select,\n.form-textarea {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 11px;\n  font-family: inherit;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus,\n.form-select:focus,\n.form-textarea:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n/* Error state for form inputs */\n.form-input.error,\n.form-select.error,\n.form-textarea.error {\n  border-color: #ef4444;\n  box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2);\n}\n\n/* Field error message */\n.field-error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.readonly-input {\n  background: rgba(255, 255, 255, 0.02);\n  border: 1px solid rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.6);\n  cursor: not-allowed;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 12px;\n}\n\n.readonly-input:focus {\n  border-color: rgba(255, 255, 255, 0.05);\n  box-shadow: none;\n}\n\n.form-textarea {\n  resize: vertical;\n  min-height: 80px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  line-height: 1.4;\n}\n\n.form-textarea.auto-resize {\n  resize: none;\n  transition: height 0.2s ease;\n  overflow-y: auto;\n  max-height: 240px;\n}\n\n/* Model Selector Styles */\n.model-selector {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.model-select {\n  flex: 1;\n}\n\n.tool-keys-display {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  min-height: 32px;\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n}\n\n.tool-key-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.tool-key-input {\n  flex: 1;\n  font-size: 10px;\n}\n\n.remove-tool-key-btn {\n  width: 20px;\n  height: 20px;\n  background: transparent;\n  border: none;\n  border-radius: 2px;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n}\n\n.remove-tool-key-btn:hover {\n  background: rgba(239, 68, 68, 0.2);\n  color: #ef4444;\n}\n\n.no-tool-keys {\n  color: rgba(255, 255, 255, 0.5);\n  font-size: 10px;\n  font-style: italic;\n  text-align: center;\n  padding: 8px;\n}\n\n.btn-add-tool-key {\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  color: white;\n  align-self: flex-start;\n}\n\n.btn-add-tool-key:hover:not(:disabled) {\n  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\n}\n\n/* Steps Section */\n.steps-section {\n  margin-bottom: 20px;\n}\n\n.steps-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 16px;\n}\n\n.steps-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.agent-count-badge {\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.6);\n  background: rgba(255, 255, 255, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n}\n\n.error-badge {\n  font-size: 10px;\n  color: #ef4444;\n  background: rgba(239, 68, 68, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n  display: flex;\n  align-items: center;\n  gap: 2px;\n}\n\n.error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.step-item {\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.step-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 9px 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.step-number {\n  font-weight: 600;\n  color: #667eea;\n  font-size: 11px;\n  min-width: 20px;\n}\n\n.step-actions {\n  display: flex;\n  gap: 4px;\n}\n\n.step-content {\n  padding: 16px;\n}\n\n.agent-selector {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.agent-select {\n  flex: 1;\n}\n\n.btn-add-step {\n  padding: 6px 8px;\n  min-width: auto;\n}\n\n/* Empty State */\n.empty-steps {\n  text-align: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.empty-icon {\n  color: rgba(255, 255, 255, 0.3);\n  margin-bottom: 12px;\n}\n\n/* JSON Preview */\n.json-preview {\n  margin-bottom: 16px;\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 6px;\n  overflow: hidden;\n}\n\n.preview-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.json-code {\n  padding: 12px;\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.8);\n  background: transparent;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n.editor-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n/* Button Styles */\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n  color: white;\n  transform: translateY(-1px);\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none !important;\n  box-shadow: none !important;\n}\n\n.btn-sm {\n  padding: 4px 8px;\n  font-size: 11px;\n}\n\n.btn-xs {\n  padding: 2px 4px;\n  font-size: 10px;\n  min-width: auto;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);\n}\n\n/* Preview Section Styles */\n.preview-section {\n  margin-top: 8px;\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 6px;\n  font-size: 10px;\n}\n\n.preview-label {\n  font-weight: 600;\n  color: #667eea;\n  margin-bottom: 4px;\n  font-size: 9px;\n}\n\n.preview-content {\n  color: white;\n}\n\n.preview-text {\n  line-height: 1.4;\n  color: white;\n}\n\n.preview-table-header {\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  background: rgba(0, 0, 0, 0.3);\n  padding: 2px 6px;\n  border-radius: 3px;\n  color: #ef4444;\n  font-weight: 600;\n  border: 1px solid rgba(239, 68, 68, 0.3);\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div\n    class=\"sidebar-wrapper\"\n    :class=\"{ 'sidebar-wrapper-collapsed': sidebarStore.isCollapsed }\"\n    :style=\"{ width: sidebarWidth + '%' }\"\n  >\n    <div class=\"sidebar-content\">\n      <div class=\"sidebar-content-header\">\n        <div class=\"sidebar-content-title\">{{ $t('sidebar.title') }}</div>\n      </div>\n\n      <!-- Tab Switcher -->\n      <div class=\"tab-switcher\">\n        <button\n          class=\"tab-button\"\n          :class=\"{ active: sidebarStore.currentTab === 'list' }\"\n          @click=\"sidebarStore.switchToTab('list')\"\n        >\n          <Icon icon=\"carbon:list\" width=\"16\" />\n          {{ $t('sidebar.templateList') }}\n        </button>\n        <button\n          class=\"tab-button\"\n          :class=\"{ active: sidebarStore.currentTab === 'config' }\"\n          @click=\"sidebarStore.switchToTab('config')\"\n          :disabled=\"!sidebarStore.selectedTemplate\"\n        >\n          <Icon icon=\"carbon:settings\" width=\"16\" />\n          {{ $t('sidebar.configuration') }}\n        </button>\n      </div>\n\n      <!-- List Tab Content -->\n      <div v-if=\"sidebarStore.currentTab === 'list'\" class=\"tab-content\">\n        <div class=\"new-task-section\">\n          <button\n            class=\"new-task-btn\"\n            @click=\"() => sidebarStore.createNewTemplate(sidebarStore.planType)\"\n          >\n            <Icon icon=\"carbon:add\" width=\"16\" />\n            {{ $t('sidebar.newPlan') }}\n            <span class=\"shortcut\">⌘ K</span>\n          </button>\n        </div>\n\n        <div class=\"sidebar-content-list\">\n          <!-- Loading state -->\n          <div v-if=\"sidebarStore.isLoading\" class=\"loading-state\">\n            <Icon icon=\"carbon:circle-dash\" width=\"20\" class=\"spinning\" />\n            <span>{{ $t('sidebar.loading') }}</span>\n          </div>\n\n          <!-- Error state -->\n          <div v-else-if=\"sidebarStore.errorMessage\" class=\"error-state\">\n            <Icon icon=\"carbon:warning\" width=\"20\" />\n            <span>{{ sidebarStore.errorMessage }}</span>\n            <button @click=\"sidebarStore.loadPlanTemplateList\" class=\"retry-btn\">\n              {{ $t('sidebar.retry') }}\n            </button>\n          </div>\n\n          <!-- Empty state -->\n          <div v-else-if=\"sidebarStore.planTemplateList.length === 0\" class=\"empty-state\">\n            <Icon icon=\"carbon:document\" width=\"32\" />\n            <span>{{ $t('sidebar.noTemplates') }}</span>\n          </div>\n\n          <!-- Plan template list -->\n          <div\n            v-else\n            v-for=\"template in sidebarStore.sortedTemplates\"\n            :key=\"template.id\"\n            class=\"sidebar-content-list-item\"\n            :class=\"{\n              'sidebar-content-list-item-active':\n                template.id === sidebarStore.currentPlanTemplateId,\n            }\"\n            @click=\"sidebarStore.selectTemplate(template)\"\n          >\n            <div class=\"task-icon\">\n              <Icon icon=\"carbon:document\" width=\"20\" />\n            </div>\n            <div class=\"task-details\">\n              <div class=\"task-title\">{{ template.title || $t('sidebar.unnamedPlan') }}</div>\n              <div class=\"task-preview\">\n                {{ truncateText(template.description || $t('sidebar.noDescription'), 40) }}\n              </div>\n            </div>\n            <div class=\"task-time\">\n              {{\n                getRelativeTimeString(\n                  sidebarStore.parseDateTime(template.updateTime || template.createTime)\n                )\n              }}\n            </div>\n            <div class=\"task-actions\">\n              <button\n                class=\"delete-task-btn\"\n                :title=\"$t('sidebar.deleteTemplate')\"\n                @click.stop=\"sidebarStore.deleteTemplate(template)\"\n              >\n                <Icon icon=\"carbon:close\" width=\"16\" />\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Config Tab Content -->\n      <div v-else-if=\"sidebarStore.currentTab === 'config'\" class=\"tab-content config-tab\">\n        <div v-if=\"sidebarStore.selectedTemplate\" class=\"config-container\">\n          <!-- Template Info Header -->\n          <div class=\"template-info-header\">\n            <div class=\"template-info\">\n              <h3>{{ sidebarStore.selectedTemplate.title || $t('sidebar.unnamedPlan') }}</h3>\n              <span class=\"template-id\">ID: {{ sidebarStore.selectedTemplate.id }}</span>\n            </div>\n            <button class=\"back-to-list-btn\" @click=\"sidebarStore.switchToTab('list')\">\n              <Icon icon=\"carbon:arrow-left\" width=\"16\" />\n            </button>\n          </div>\n\n          <!-- Section 2: JSON Editor (Conditional based on plan type) -->\n          <!-- Use JsonEditorV2 for dynamic_agent type -->\n          <JsonEditorV2\n            v-if=\"sidebarStore.planType === 'dynamic_agent'\"\n            :key=\"sidebarStore.currentPlanTemplateId || 'default'\"\n            :json-content=\"sidebarStore.jsonContent\"\n            :can-rollback=\"sidebarStore.canRollback\"\n            :can-restore=\"sidebarStore.canRestore\"\n            :is-generating=\"sidebarStore.isGenerating\"\n            :is-executing=\"sidebarStore.isExecuting\"\n            :current-plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n            @rollback=\"handleRollback\"\n            @restore=\"handleRestore\"\n            @save=\"handleSaveTemplate\"\n            @copy-plan=\"handleCopyPlan\"\n            @update:json-content=\"(value: string) => (sidebarStore.jsonContent = value)\"\n          />\n\n          <!-- Use JsonEditor for simple or other types -->\n          <JsonEditor\n            v-else\n            :key=\"'simple-' + (sidebarStore.currentPlanTemplateId || 'default')\"\n            :json-content=\"sidebarStore.jsonContent\"\n            :can-rollback=\"sidebarStore.canRollback\"\n            :can-restore=\"sidebarStore.canRestore\"\n            :is-generating=\"sidebarStore.isGenerating\"\n            :is-executing=\"sidebarStore.isExecuting\"\n            :current-plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n            @rollback=\"handleRollback\"\n            @restore=\"handleRestore\"\n            @save=\"handleSaveTemplate\"\n            @update:json-content=\"(value: string) => (sidebarStore.jsonContent = value)\"\n          />\n\n          <!-- Section 3: Execution Controller -->\n          <ExecutionController\n            ref=\"executionControllerRef\"\n            :current-plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n            :is-executing=\"sidebarStore.isExecuting\"\n            :is-generating=\"sidebarStore.isGenerating\"\n            :show-publish-button=\"showPublishButton\"\n            :tool-info=\"currentToolInfo\"\n            @execute-plan=\"handleExecutePlan\"\n            @publish-mcp-service=\"handlePublishMcpService\"\n            @clear-params=\"handleClearExecutionParams\"\n            @update-execution-params=\"handleUpdateExecutionParams\"\n          />\n        </div>\n      </div>\n    </div>\n\n    <!-- Sidebar Resizer -->\n    <div\n      class=\"sidebar-resizer\"\n      @mousedown=\"startResize\"\n      @dblclick=\"resetSidebarWidth\"\n      :title=\"$t('sidebar.resizeHint')\"\n    >\n      <div class=\"resizer-line\"></div>\n    </div>\n  </div>\n\n  <!-- Publish MCP Service Modal -->\n  <PublishServiceModal\n    ref=\"publishMcpModalRef\"\n    v-model=\"showPublishMcpModal\"\n    :plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n    :plan-description=\"sidebarStore.selectedTemplate?.description || ''\"\n    @published=\"handleMcpServicePublished\"\n  />\n\n  <!-- Copy Plan Modal -->\n  <div v-if=\"showCopyPlanModal\" class=\"modal-overlay\" @click=\"closeCopyPlanModal\">\n    <div class=\"modal-content\" @click.stop>\n      <div class=\"modal-header\">\n        <h3>{{ $t('sidebar.copyPlan') }}</h3>\n        <button class=\"close-btn\" @click=\"closeCopyPlanModal\">\n          <Icon icon=\"carbon:close\" width=\"16\" />\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.newPlanTitle') }}</label>\n          <input\n            v-model=\"newPlanTitle\"\n            type=\"text\"\n            class=\"form-input\"\n            :placeholder=\"$t('sidebar.enterNewPlanTitle')\"\n            @keyup.enter=\"confirmCopyPlan\"\n          />\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button class=\"btn btn-secondary\" @click=\"closeCopyPlanModal\">\n          {{ $t('common.cancel') }}\n        </button>\n        <button\n          class=\"btn btn-primary\"\n          @click=\"confirmCopyPlan\"\n          :disabled=\"!newPlanTitle.trim() || isCopyingPlan\"\n        >\n          <Icon v-if=\"isCopyingPlan\" icon=\"carbon:loading\" width=\"16\" class=\"spinning\" />\n          {{ isCopyingPlan ? $t('sidebar.copying') : $t('sidebar.copyPlan') }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { CoordinatorToolConfig, CoordinatorToolVO } from '@/api/coordinator-tool-api-service'\nimport { CoordinatorToolApiService } from '@/api/coordinator-tool-api-service'\nimport PublishServiceModal from '@/components/publish-service-modal/PublishServiceModal.vue'\nimport { useToast } from '@/plugins/useToast'\nimport { sidebarStore } from '@/stores/sidebar'\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport ExecutionController from './ExecutionController.vue'\nimport JsonEditor from './JsonEditor.vue'\nimport JsonEditorV2 from './JsonEditorV2.vue'\n\nconst { t } = useI18n()\nconst toast = useToast()\n\n// Sidebar width management\nconst sidebarWidth = ref(80) // Default width percentage\nconst isResizing = ref(false)\nconst startX = ref(0)\nconst startWidth = ref(0)\n\n// Component refs\nconst executionControllerRef = ref<InstanceType<typeof ExecutionController> | null>(null)\n\n// Tool information state\nconst currentToolInfo = ref<CoordinatorToolVO>({\n  toolName: '',\n  toolDescription: '',\n  planTemplateId: '',\n  inputSchema: '[]',\n  enableHttpService: false,\n  enableMcpService: false,\n  enableInternalToolcall: false,\n  serviceGroup: '',\n})\nconst publishMcpModalRef = ref<InstanceType<typeof PublishServiceModal> | null>(null)\n\n// CoordinatorTool configuration\nconst coordinatorToolConfig = ref<CoordinatorToolConfig>({\n  enabled: true,\n  success: true,\n})\n\n// Computed property: whether to show publish MCP service button\nconst showPublishButton = computed(() => {\n  return coordinatorToolConfig.value.enabled\n})\n\n// Watch for changes in currentPlanTemplateId and jsonContent\nwatch(\n  () => sidebarStore.currentPlanTemplateId,\n  (newId, oldId) => {\n    console.log('[Sidebar] currentPlanTemplateId changed from', oldId, 'to', newId)\n  }\n)\n\nwatch(\n  () => sidebarStore.jsonContent,\n  (newContent, oldContent) => {\n    console.log('[Sidebar] jsonContent changed from', oldContent, 'to', newContent)\n  }\n)\n\n// Load CoordinatorTool configuration\nconst loadCoordinatorToolConfig = async () => {\n  try {\n    const config = await CoordinatorToolApiService.getCoordinatorToolConfig()\n    coordinatorToolConfig.value = config\n  } catch (error) {\n    console.error('Failed to load CoordinatorTool configuration:', error)\n    // Use default configuration\n    coordinatorToolConfig.value = {\n      enabled: true,\n      success: false,\n      message: error instanceof Error ? error.message : 'Unknown error',\n    }\n  }\n}\n\n// Use pinia store\n// Use TS object-implemented sidebarStore\n// Use sidebarStore instance directly, no pinia needed\n\n// Emits - Keep some events for communication with external components\nconst emit = defineEmits<{\n  planExecutionRequested: [payload: PlanExecutionRequestPayload]\n}>()\n\nconst handleSaveTemplate = async () => {\n  try {\n    const saveResult = await sidebarStore.saveTemplate()\n\n    if (saveResult?.duplicate) {\n      toast.success(\n        t('sidebar.saveCompleted', {\n          message: saveResult.message,\n          versionCount: saveResult.versionCount,\n        })\n      )\n    } else if (saveResult?.saved) {\n      toast.success(\n        t('sidebar.saveSuccess', {\n          message: saveResult.message,\n          versionCount: saveResult.versionCount,\n        })\n      )\n      // Refresh parameter requirements after successful save\n      refreshParameterRequirements()\n    } else if (saveResult?.message) {\n      toast.success(t('sidebar.saveStatus', { message: saveResult.message }))\n    }\n  } catch (error: any) {\n    console.error('Failed to save plan modifications:', error)\n    toast.error(error.message || t('sidebar.saveFailed'))\n  }\n}\n\n// Method to refresh parameter requirements\nconst refreshParameterRequirements = async () => {\n  // Add a delay to ensure the backend has processed the new template and committed the transaction\n  await new Promise(resolve => setTimeout(resolve, 1000))\n\n  console.log(\n    '[Sidebar] 🔄 Refreshing parameter requirements for templateId:',\n    sidebarStore.currentPlanTemplateId\n  )\n\n  // Use nextTick to ensure all reactive updates are complete\n  await nextTick()\n\n  // Get ExecutionController component through ref and call its refresh method\n  if (executionControllerRef.value) {\n    console.log('[Sidebar] 📞 Calling ExecutionController.loadParameterRequirements()')\n    executionControllerRef.value.loadParameterRequirements()\n\n    // Add a retry mechanism in case the first call fails due to timing\n    setTimeout(() => {\n      if (executionControllerRef.value) {\n        console.log(\n          '[Sidebar] 🔄 Retry: Calling ExecutionController.loadParameterRequirements() again'\n        )\n        executionControllerRef.value.loadParameterRequirements()\n      }\n    }, 2000) // Increased delay to 2 seconds for database transaction commit\n  } else {\n    console.warn('[Sidebar] ⚠️ ExecutionController ref not available')\n  }\n\n  // Refresh parameter requirements in PublishMcpServiceModal\n  if (publishMcpModalRef.value) {\n    console.log('[Sidebar] 📞 Calling PublishMcpServiceModal.loadParameterRequirements()')\n    publishMcpModalRef.value.loadParameterRequirements()\n  } else {\n    console.warn('[Sidebar] ⚠️ PublishMcpServiceModal ref not available')\n  }\n}\n\n// Version control handlers\nconst handleRollback = () => {\n  try {\n    if (typeof sidebarStore.rollbackVersion === 'function') {\n      sidebarStore.rollbackVersion()\n    } else {\n      console.warn('rollbackVersion method is not available')\n    }\n  } catch (error) {\n    console.error('Error during rollback operation:', error)\n    toast.error(t('sidebar.rollbackFailed') || 'Rollback failed')\n  }\n}\n\nconst handleRestore = () => {\n  try {\n    if (typeof sidebarStore.restoreVersion === 'function') {\n      sidebarStore.restoreVersion()\n    } else {\n      console.warn('restoreVersion method is not available')\n    }\n  } catch (error) {\n    console.error('Error during restore operation:', error)\n    toast.error(t('sidebar.restoreFailed') || 'Restore failed')\n  }\n}\n\nconst handleExecutePlan = async (payload: PlanExecutionRequestPayload) => {\n  console.log(\n    '[Sidebar] 🎯 handleExecutePlan called with payload:',\n    JSON.stringify(payload, null, 2)\n  )\n  console.log('[Sidebar] 📊 Current sidebarStore state:', {\n    currentPlanTemplateId: sidebarStore.currentPlanTemplateId,\n    selectedTemplate: sidebarStore.selectedTemplate?.id,\n    jsonContent: sidebarStore.jsonContent.substring(0, 100) + '...',\n  })\n\n  try {\n    const planData = sidebarStore.preparePlanExecution()\n    console.log('[Sidebar] 📋 Prepared plan data:', JSON.stringify(planData, null, 2))\n\n    if (!planData) {\n      console.log('[Sidebar] ❌ No plan data available, returning')\n      return\n    }\n\n    // Always use the prepared plan data (which includes planTemplateId)\n    // Add replacement parameters to plan data if provided\n    const finalPlanData = {\n      ...planData,\n      uploadedFiles: payload.uploadedFiles,\n      uploadKey: payload.uploadKey,\n    }\n\n    if (payload.replacementParams && Object.keys(payload.replacementParams).length > 0) {\n      console.log('[Sidebar] 🔄 Processing replacement parameters:', payload.replacementParams)\n      finalPlanData.replacementParams = payload.replacementParams\n    }\n\n    console.log('[Sidebar] ✅ Final plan data:', JSON.stringify(finalPlanData, null, 2))\n\n    // Use the prepared plan data for the payload\n    const finalPayload: PlanExecutionRequestPayload = {\n      ...payload,\n      title: finalPlanData.title,\n      planData: finalPlanData.planData,\n      params: finalPlanData.params,\n      uploadedFiles: finalPlanData.uploadedFiles,\n      uploadKey: finalPlanData.uploadKey,\n    }\n\n    console.log(\n      '[Sidebar] 📤 Emitting planExecutionRequested with final payload:',\n      JSON.stringify(finalPayload, null, 2)\n    )\n    emit('planExecutionRequested', finalPayload)\n\n    console.log('[Sidebar] ✅ Event emitted successfully')\n  } catch (error: any) {\n    console.error('[Sidebar] ❌ Error executing plan:', error)\n    toast.error(t('sidebar.executeFailed') + ': ' + error.message)\n  } finally {\n    console.log('[Sidebar] 🧹 Cleaning up after execution')\n    sidebarStore.finishPlanExecution()\n    // Clear execution parameters after successful execution\n    sidebarStore.clearExecutionParams()\n    // Also clear ExecutionController parameters\n    if (executionControllerRef.value) {\n      console.log('[Sidebar] 🧹 Calling ExecutionController.clearExecutionParams')\n      executionControllerRef.value.clearExecutionParams()\n    }\n    console.log('[Sidebar] ✅ Cleanup completed')\n  }\n}\n\n// MCP service publishing related state\nconst showPublishMcpModal = ref(false)\n\n// Copy plan related state\nconst showCopyPlanModal = ref(false)\nconst newPlanTitle = ref('')\nconst isCopyingPlan = ref(false)\n\nconst handlePublishMcpService = () => {\n  console.log('[Sidebar] Publish MCP service button clicked')\n  console.log('[Sidebar] currentPlanTemplateId:', sidebarStore.currentPlanTemplateId)\n\n  if (!sidebarStore.currentPlanTemplateId) {\n    console.log('[Sidebar] No plan template selected, showing warning')\n    toast.error(t('mcpService.selectPlanTemplateFirst'))\n    return\n  }\n\n  console.log('[Sidebar] Opening publish MCP service modal')\n  showPublishMcpModal.value = true\n}\n\nconst handleMcpServicePublished = async (tool: CoordinatorToolVO | null) => {\n  if (tool === null) {\n    console.log('MCP service deleted successfully')\n    toast.success(t('mcpService.deleteSuccess'))\n    // Reset tool information\n    currentToolInfo.value = {\n      toolName: '',\n      toolDescription: '',\n      planTemplateId: '',\n      inputSchema: '[]',\n      enableHttpService: false,\n      enableMcpService: false,\n      enableInternalToolcall: false,\n      serviceGroup: '',\n    }\n  } else {\n    console.log('MCP service published successfully:', tool)\n    toast.success(t('mcpService.publishSuccess'))\n    // Update tool information\n    currentToolInfo.value = {\n      ...tool,\n      toolName: tool.toolName,\n      serviceGroup: tool.serviceGroup ?? '',\n    }\n  }\n\n  // Reload available tools to include the newly published service\n  console.log('[Sidebar] 🔄 Reloading available tools after service publish/delete')\n  await sidebarStore.loadAvailableTools()\n}\n\n// Execution Controller event handlers\nconst handleClearExecutionParams = () => {\n  sidebarStore.clearExecutionParams()\n}\n\nconst handleUpdateExecutionParams = (params: string) => {\n  sidebarStore.executionParams = params\n}\n\n// Copy plan handler functions\nconst handleCopyPlan = () => {\n  console.log('[Sidebar] Copy plan clicked')\n\n  if (!sidebarStore.selectedTemplate) {\n    console.log('[Sidebar] No template selected, cannot copy')\n    toast.error(t('sidebar.selectPlanFirst'))\n    return\n  }\n\n  newPlanTitle.value = (sidebarStore.selectedTemplate.title ?? t('sidebar.unnamedPlan')) + ' (copy)'\n  console.log('[Sidebar] Opening copy plan modal')\n  showCopyPlanModal.value = true\n}\n\nconst closeCopyPlanModal = () => {\n  showCopyPlanModal.value = false\n  newPlanTitle.value = ''\n  isCopyingPlan.value = false\n}\n\nconst confirmCopyPlan = async () => {\n  if (!newPlanTitle.value.trim()) {\n    toast.error(t('sidebar.titleRequired'))\n    return\n  }\n\n  if (!sidebarStore.selectedTemplate || !sidebarStore.jsonContent) {\n    toast.error(t('sidebar.noPlanToCopy'))\n    return\n  }\n\n  isCopyingPlan.value = true\n\n  try {\n    const currentPlan = JSON.parse(sidebarStore.jsonContent)\n    const newPlan = {\n      ...currentPlan,\n      title: newPlanTitle.value.trim(),\n      planTemplateId: '', // New plan should not have the same template ID\n    }\n\n    const { PlanActApiService } = await import('@/api/plan-act-api-service')\n    const result = await PlanActApiService.savePlanTemplate('', JSON.stringify(newPlan))\n\n    if (result.saved) {\n      toast.success(t('sidebar.copyPlanSuccess', { title: newPlanTitle.value.trim() }))\n      await sidebarStore.loadPlanTemplateList()\n      closeCopyPlanModal()\n    } else {\n      toast.error(t('sidebar.copyPlanFailed', { message: result.message || 'Unknown error' }))\n    }\n  } catch (error: any) {\n    console.error('[Sidebar] Error copying plan:', error)\n    toast.error(t('sidebar.copyPlanFailed', { message: error.message || 'Unknown error' }))\n  } finally {\n    isCopyingPlan.value = false\n  }\n}\n\n// Load tool information when plan template changes\nconst loadToolInfo = async (planTemplateId: string | null) => {\n  if (!planTemplateId) {\n    currentToolInfo.value = {\n      toolName: '',\n      toolDescription: '',\n      planTemplateId: '',\n      inputSchema: '[]',\n      enableHttpService: false,\n      enableMcpService: false,\n      enableInternalToolcall: false,\n      serviceGroup: '',\n    }\n    return\n  }\n\n  try {\n    const toolData = await CoordinatorToolApiService.getCoordinatorToolsByTemplate(planTemplateId)\n    if (toolData) {\n      currentToolInfo.value = {\n        ...toolData,\n        toolName: toolData.toolName,\n        serviceGroup: toolData.serviceGroup ?? '',\n      }\n    } else {\n      // No tool found or not published, don't show any call examples\n      currentToolInfo.value = {\n        toolName: '',\n        toolDescription: '',\n        planTemplateId: planTemplateId,\n        inputSchema: '[]',\n        enableHttpService: false,\n        enableMcpService: false,\n        enableInternalToolcall: false,\n        serviceGroup: '',\n      }\n    }\n  } catch (error) {\n    console.error('Failed to load tool information:', error)\n    currentToolInfo.value = {\n      toolName: '',\n      toolDescription: '',\n      planTemplateId: planTemplateId,\n      inputSchema: '[]',\n      enableHttpService: false,\n      enableMcpService: false,\n      enableInternalToolcall: false,\n      serviceGroup: '',\n    }\n  }\n}\n\n// Utility functions\nconst getRelativeTimeString = (date: Date): string => {\n  // Check if date is valid\n  if (isNaN(date.getTime())) {\n    console.warn('Invalid date received:', date)\n    return t('time.unknown')\n  }\n\n  const now = new Date()\n  const diffMs = now.getTime() - date.getTime()\n  const diffMinutes = Math.floor(diffMs / 60000)\n  const diffHours = Math.floor(diffMs / 3600000)\n  const diffDays = Math.floor(diffMs / 86400000)\n\n  if (diffMinutes < 1) return t('time.now')\n  if (diffMinutes < 60) return t('time.minuteAgo', { count: diffMinutes })\n  if (diffHours < 24) return t('time.hourAgo', { count: diffHours })\n  if (diffDays < 30) return t('time.dayAgo', { count: diffDays })\n\n  return date.toLocaleDateString('zh-CN')\n}\n\nconst truncateText = (text: string, maxLength: number): string => {\n  if (!text || text.length <= maxLength) return text\n  return text.substring(0, maxLength) + '...'\n}\n\n// Sidebar resize methods\nconst startResize = (e: MouseEvent) => {\n  isResizing.value = true\n  startX.value = e.clientX\n  startWidth.value = sidebarWidth.value\n\n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = 'col-resize'\n  document.body.style.userSelect = 'none'\n\n  e.preventDefault()\n}\n\nconst handleMouseMove = (e: MouseEvent) => {\n  if (!isResizing.value) return\n\n  const containerWidth = window.innerWidth\n  const deltaX = e.clientX - startX.value\n  const deltaPercent = (deltaX / containerWidth) * 100\n\n  let newWidth = startWidth.value + deltaPercent\n\n  // Limit sidebar width between 15% and 100%\n  newWidth = Math.max(15, Math.min(100, newWidth))\n\n  sidebarWidth.value = newWidth\n}\n\nconst handleMouseUp = () => {\n  isResizing.value = false\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = ''\n  document.body.style.userSelect = ''\n\n  // Save to localStorage\n  localStorage.setItem('sidebarWidth', sidebarWidth.value.toString())\n}\n\nconst resetSidebarWidth = () => {\n  sidebarWidth.value = 80\n  localStorage.setItem('sidebarWidth', '80')\n}\n\n// Watch for plan template changes to load tool information\nwatch(\n  () => sidebarStore.currentPlanTemplateId,\n  newPlanTemplateId => {\n    loadToolInfo(newPlanTemplateId)\n  },\n  { immediate: true }\n)\n\n// Lifecycle\nonMounted(() => {\n  sidebarStore.loadPlanTemplateList()\n  loadCoordinatorToolConfig()\n  sidebarStore.loadAvailableTools() // Load available tools on sidebar mount\n\n  // Restore sidebar width from localStorage\n  const savedWidth = localStorage.getItem('sidebarWidth')\n  if (savedWidth) {\n    sidebarWidth.value = parseFloat(savedWidth)\n  }\n})\n\nonUnmounted(() => {\n  // Clean up event listeners\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n})\n\n// Expose methods for parent component to call\ndefineExpose({\n  loadPlanTemplateList: sidebarStore.loadPlanTemplateList,\n  toggleSidebar: sidebarStore.toggleSidebar,\n  currentPlanTemplateId: sidebarStore.currentPlanTemplateId,\n})\n</script>\n\n<style scoped>\n.sidebar-wrapper {\n  position: relative;\n  height: 100vh;\n  background: rgba(255, 255, 255, 0.05);\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n  transition: width 0.1s ease;\n  overflow: hidden;\n  display: flex;\n}\n.sidebar-wrapper-collapsed {\n  border-right: none;\n  width: 0 !important;\n  /* transform: translateX(-100%); */\n\n  .sidebar-content,\n  .sidebar-resizer {\n    opacity: 0;\n    pointer-events: none;\n  }\n}\n\n.sidebar-content {\n  height: 100%;\n  width: 100%;\n  padding: 12px 0 12px 12px;\n  display: flex;\n  flex-direction: column;\n  transition: all 0.3s ease-in-out;\n  flex: 1;\n\n  .sidebar-content-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 16px;\n    overflow: hidden;\n\n    .sidebar-content-title {\n      font-size: 20px;\n      font-weight: 600;\n\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      background-clip: text;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n    }\n  }\n\n  .tab-switcher {\n    display: flex;\n    margin-bottom: 16px;\n    padding-right: 12px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n    padding: 4px;\n\n    .tab-button {\n      flex: 1;\n      padding: 8px 12px;\n      background: transparent;\n      border: none;\n      border-radius: 6px;\n      color: rgba(255, 255, 255, 0.7);\n      font-size: 12px;\n      font-weight: 500;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 6px;\n      transition: all 0.2s ease;\n\n      &:hover:not(:disabled) {\n        background: rgba(255, 255, 255, 0.1);\n        color: rgba(255, 255, 255, 0.9);\n      }\n\n      &.active {\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);\n      }\n\n      &:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n      }\n    }\n  }\n\n  .tab-content {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    min-height: 0;\n  }\n\n  .config-tab {\n    .config-container {\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n      overflow-y: auto;\n      padding-right: 12px;\n\n      .template-info-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        margin-bottom: 16px;\n        padding: 12px;\n        background: rgba(255, 255, 255, 0.05);\n        border-radius: 8px;\n\n        .template-info {\n          flex: 1;\n          min-width: 0;\n\n          h3 {\n            margin: 0 0 4px 0;\n            font-size: 14px;\n            font-weight: 600;\n            color: white;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n          }\n\n          .template-id {\n            font-size: 11px;\n            color: rgba(255, 255, 255, 0.5);\n          }\n        }\n\n        .back-to-list-btn {\n          width: 28px;\n          height: 28px;\n          background: transparent;\n          border: none;\n          border-radius: 4px;\n          color: rgba(255, 255, 255, 0.7);\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          transition: all 0.2s ease;\n\n          &:hover {\n            background: rgba(255, 255, 255, 0.1);\n            color: white;\n          }\n        }\n      }\n\n      .json-editor {\n        width: 100%;\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 6px;\n        color: white;\n        font-size: 12px;\n        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n        padding: 8px;\n        resize: vertical;\n        min-height: 100px;\n\n        &:focus {\n          outline: none;\n          border-color: #667eea;\n          box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n        }\n\n        &::placeholder {\n          color: rgba(255, 255, 255, 0.4);\n        }\n      }\n\n      .json-editor {\n        min-height: 200px;\n        font-size: 11px;\n        line-height: 1.5;\n        white-space: pre-wrap;\n        overflow-wrap: break-word;\n        word-break: break-word;\n        tab-size: 2;\n        font-variant-ligatures: none;\n      }\n    }\n  }\n}\n\n.new-task-section {\n  margin-bottom: 16px;\n  padding-right: 12px;\n\n  .new-task-btn {\n    width: 100%;\n    padding: 12px 16px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border: none;\n    border-radius: 8px;\n    color: white;\n    font-size: 14px;\n    font-weight: 500;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    transition: all 0.2s ease;\n\n    &:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n    }\n\n    .shortcut {\n      font-size: 12px;\n      opacity: 0.8;\n      margin-left: auto;\n    }\n  }\n}\n\n.sidebar-content-list {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  overflow-y: auto;\n  padding-right: 12px;\n\n  .loading-state,\n  .error-state,\n  .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 32px 16px;\n    color: rgba(255, 255, 255, 0.6);\n    font-size: 14px;\n    text-align: center;\n    gap: 12px;\n\n    .spinning {\n      animation: spin 1s linear infinite;\n    }\n\n    .retry-btn {\n      padding: 8px 16px;\n      background: rgba(255, 255, 255, 0.1);\n      border: 1px solid rgba(255, 255, 255, 0.2);\n      border-radius: 4px;\n      color: white;\n      cursor: pointer;\n      font-size: 12px;\n      transition: background-color 0.2s ease;\n\n      &:hover {\n        background: rgba(255, 255, 255, 0.2);\n      }\n    }\n  }\n\n  .sidebar-content-list-item {\n    display: flex;\n    align-items: flex-start;\n    padding: 12px;\n    margin-bottom: 8px;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 8px;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    position: relative;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.1);\n      border-color: rgba(255, 255, 255, 0.2);\n      transform: translateY(-1px);\n    }\n\n    &.sidebar-content-list-item-active {\n      border: 2px solid #667eea;\n      background: rgba(102, 126, 234, 0.1);\n    }\n\n    .task-icon {\n      margin-right: 12px;\n      color: #667eea;\n      flex-shrink: 0;\n      margin-top: 2px;\n    }\n\n    .task-details {\n      flex: 1;\n      min-width: 0;\n\n      .task-title {\n        font-size: 14px;\n        font-weight: 600;\n        color: white;\n        margin-bottom: 4px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n\n      .task-preview {\n        font-size: 12px;\n        color: rgba(255, 255, 255, 0.7);\n        line-height: 1.4;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n    }\n\n    .task-time {\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.5);\n      margin-left: 8px;\n      flex-shrink: 0;\n      position: absolute;\n      top: 12px;\n      right: 40px;\n    }\n\n    .task-actions {\n      display: flex;\n      align-items: center;\n      margin-left: 8px;\n      flex-shrink: 0;\n\n      .delete-task-btn {\n        width: 24px;\n        height: 24px;\n        background: transparent;\n        border: none;\n        border-radius: 4px;\n        color: rgba(255, 255, 255, 0.5);\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.2s ease;\n        position: absolute;\n        top: 12px;\n        right: 12px;\n\n        &:hover {\n          background: rgba(255, 0, 0, 0.2);\n          color: #ff6b6b;\n        }\n      }\n    }\n  }\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Sidebar Resizer Styles */\n.sidebar-resizer {\n  width: 6px;\n  height: 100vh;\n  background: #1a1a1a;\n  cursor: col-resize;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background-color 0.2s ease;\n  flex-shrink: 0;\n\n  &:hover {\n    background: #2a2a2a;\n\n    .resizer-line {\n      background: #4a90e2;\n      width: 2px;\n    }\n  }\n\n  &:active {\n    background: #3a3a3a;\n  }\n}\n\n.resizer-line {\n  width: 1px;\n  height: 40px;\n  background: #3a3a3a;\n  border-radius: 1px;\n  transition: all 0.2s ease;\n}\n\n/* Copy Plan Modal Styles */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background: #1a1a1a;\n  border-radius: 8px;\n  padding: 0;\n  min-width: 400px;\n  max-width: 500px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n}\n\n.modal-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: white;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.close-btn {\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.modal-body {\n  padding: 20px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 16px 20px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.form-label {\n  font-size: 14px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input {\n  padding: 10px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 13px;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  transition: all 0.2s ease;\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.btn-secondary:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5566dd 0%, #653b91 100%);\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n}\n\n.spinning {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface Memory {\n    id: number;\n    conversation_id: string;\n    memory_name: string;\n    create_time: string;\n    messages?: MessageBubble[];\n}\n\nexport interface MemoryResponse {\n    success: boolean;\n    message: string;\n    data?: Memory;\n    memories?: Memory[];\n    total_count?: number;\n    response_time: string;\n}\n\nexport interface MessageBubble {\n    messageType: string;\n    text: string;\n}\n\nexport class MemoryApiService {\n    private static readonly BASE_URL = '/api/memories'\n\n    private static async handleResponse(response: Response) {\n        if (!response.ok) {\n            try {\n                const errorData = await response.json()\n                throw new Error(errorData.message || `API request failed: ${response.status}`)\n            } catch {\n                throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n            }\n        }\n        return response\n    }\n\n    static async getMemories(): Promise<Memory[]> {\n        try {\n            const response = await fetch(`${this.BASE_URL}`)\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            return data.memories ?? []\n        } catch (error) {\n            console.error('Failed to get memory list:', error)\n            throw error\n        }\n    }\n\n    static async getMemory(conversationId: string): Promise<Memory> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/single?conversationId=${conversationId}`)\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            if (!data.data) {\n                throw new Error('Memory not found')\n            }\n            return data.data\n        } catch (error) {\n            console.error('Failed to get memory:', error)\n            throw error\n        }\n    }\n\n    static async createMemory(conversationId: string, memoryName: string): Promise<Memory> {\n        try {\n            const response = await fetch(`${this.BASE_URL}`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    conversation_id: conversationId,\n                    memory_name: memoryName\n                })\n            })\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            if (!data.data) {\n                throw new Error('Failed to create memory')\n            }\n            return data.data\n        } catch (error) {\n            console.error('Failed to create memory:', error)\n            throw error\n        }\n    }\n\n    static async updateMemory(conversationId: string, memoryName: string): Promise<Memory> {\n        try {\n            const response = await fetch(`${this.BASE_URL}`, {\n                method: 'PUT',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    conversation_id: conversationId,\n                    memory_name: memoryName\n                })\n            })\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            if (!data.data) {\n                throw new Error('Failed to update memory')\n            }\n            return data.data\n        } catch (error) {\n            console.error('Failed to update memory:', error)\n            throw error\n        }\n    }\n\n    static async deleteMemory(conversationId: string): Promise<void> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/${conversationId}`, {\n                method: 'DELETE'\n            })\n            await this.handleResponse(response)\n        } catch (error) {\n            console.error('Failed to delete memory:', error)\n            throw error\n        }\n    }\n\n    static async generateConversationId(): Promise<Memory> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/generate-id`)\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            if (!data.data) {\n                throw new Error('Failed to generate conversation ID')\n            }\n            return data.data\n        } catch (error) {\n            console.error('Failed to generate conversation ID:', error)\n            throw error\n        }\n    }\n}\n","/*\n * Copyright 2024-2026 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {reactive} from \"vue\";\n\nexport interface MemoryEmits {\n    (e: 'memory-selected'): void\n}\n\nexport interface InputMessage {\n    input: string\n    memoryId?: string\n    uploadedFiles?: string[]\n    uploadKey?: string\n}\n\nexport class MemoryStore {\n    // Basic state\n    isCollapsed = false\n    selectMemoryId = ''\n    loadMessages = () => {}\n    intervalId: number | undefined = undefined\n\n    toggleSidebar() {\n        this.isCollapsed = !this.isCollapsed\n        if (this.isCollapsed) {\n            this.loadMessages();\n            this.intervalId = window.setInterval(() => {\n                this.loadMessages();\n            }, 3000);\n        } else {\n            clearInterval(this.intervalId);\n        }\n    }\n\n    selectMemory(memoryId: string) {\n        this.toggleSidebar()\n        this.selectMemoryId = memoryId\n    }\n\n    setMemory(memoryId: string) {\n        this.selectMemoryId = memoryId\n    }\n\n    defaultMemoryId() {\n        this.selectMemoryId = this.generateRandomId()\n    }\n\n    clearMemoryId() {\n        this.selectMemoryId = ''\n    }\n\n    generateRandomId(): string {\n        return Math.random().toString(36).substring(2, 10);\n    }\n\n    setLoadMessages(messages : () => void) {\n        this.loadMessages = messages\n    }\n}\n\nexport const memoryStore = reactive(new MemoryStore())\n","<template>\n  <Teleport to=\"body\">\n    <Transition name=\"modal\">\n      <div class=\"app-container\" v-if=\"memoryStore.isCollapsed\">\n        <div class=\"app-content\">\n          <div class=\"header\">\n            <div class=\"relative\">\n              <div class=\"title-edit-group\">\n                <h1 id=\"main-title\" class=\"main-title\">\n                  <span>{{ $t('memory.title') }}</span>\n                </h1>\n              </div>\n\n              <div\n                  id=\"title-edit-container\"\n                  class=\"title-edit-container\"\n                  v-if=\"showTitleEdit\"\n              >\n              </div>\n            </div>\n            <button class=\"close-btn\" @click=\"memoryStore.toggleSidebar()\">\n              <Icon icon=\"carbon:close\" />\n            </button>\n          </div>\n\n          <div class=\"search-bar\">\n            <div class=\"search-container\">\n              <Icon class=\"search-container-icon\" icon=\"carbon:search\" />\n              <input\n                  type=\"text\"\n                  :placeholder=\"$t('memory.searchPlaceholder')\"\n                  class=\"search-input\"\n                  v-model=\"searchQuery\"\n                  @input=\"handleSearch\"\n              >\n            </div>\n          </div>\n\n          <div class=\"message-list\" id=\"message-list\">\n            <div>\n              <div\n                  class=\"message-item\"\n                  v-for=\"message in filteredMessages\"\n                  :key=\"message.conversation_id\"\n                  :class=\"{ 'expanded': message.expanded }\"\n              >\n                <div class=\"message-header\">\n                  <div class=\"message-content\">\n                    <div class=\"sender-info\">\n                      <div class=\"sender-div\" @click.stop=\"selectMemory(message.conversation_id)\">\n                        <h3\n                            class=\"sender-name\"\n                        >\n                          {{ message.memory_name }}\n                        </h3>\n                      </div>\n\n                      <div class=\"toggle-container\" @click.stop=\"showNameEditModal(message.conversation_id, message.memory_name)\">\n                        <Icon\n                            icon=\"carbon:edit\"\n                            class=\"edit-btn\"\n                        >\n                        </Icon>\n                      </div>\n                      <div class=\"action-buttons\">\n                        <button\n                            class=\"delete-btn\"\n                            @click.stop=\"toggleMessage(message.conversation_id)\"\n                        >\n                          <Icon :id=\"'toggle-' + message.conversation_id\"\n                                icon=\"carbon:chevron-down\"\n                                class=\"down-btn\"\n                          ></Icon>\n                        </button>\n                      </div>\n                      <div class=\"action-buttons\">\n                        <button\n                            class=\"delete-btn\"\n                            @click.stop=\"showDeleteConfirm(message.conversation_id)\"\n                        >\n                          <Icon icon=\"carbon:delete\"></Icon>\n                        </button>\n                      </div>\n                    </div>\n\n                    <div class=\"message-preview\">\n                      <p class=\"preview-line\">\n                        {{ message.messages && message.messages.length > 0 ? message.messages[0].text : 'none message' }}\n                      </p>\n                      <p\n                          class=\"preview-line\"\n                          style=\"opacity: 0.8;\"\n                          v-if=\"message.messages && message.messages.length > 1\"\n                      >\n                        {{ message.messages[1].text }}\n                      </p>\n                    </div>\n\n                    <div class=\"message-meta\">\n                      <span class=\"message-id\">ID: {{ message.conversation_id }}</span>\n                      <div class=\"meta-right\">\n                      <span class=\"unread-count\" v-if=\"message.messages && message.messages.length > 0\">\n                        {{ message.messages.length }} {{$t('memory.size')}}\n                      </span>\n                        <span class=\"message-time\">{{ formatTimestamp(message.create_time) }}</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div\n                    :id=\"'content-' + message.conversation_id\"\n                    class=\"expanded-content\"\n                    v-if=\"message.expanded\"\n                >\n                  <div style=\"display: flex; flex-direction: column; gap: 0.75rem;\">\n                    <div class=\"message-bubble\" v-for=\"(bubble, idx) in message.messages\" :key=\"idx\">\n                      <div class=\"bubble-avatar\">\n                        {{ bubble.messageType }}\n                      </div>\n                      <div class=\"bubble-content\">\n                        <p class=\"bubble-text\">{{ bubble.text }}</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div v-if=\"filteredMessages.length === 0 && searchQuery\" class=\"empty-state\">\n              <p class=\"state-text\">none message</p>\n            </div>\n          </div>\n\n          <div\n              id=\"name-edit-modal\"\n              class=\"modal-overlay\"\n              v-if=\"showNameModal\"\n              @click.self=\"closeNameModal\"\n          >\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h3 class=\"modal-title\">{{$t('memory.changeName')}}</h3>\n                <input\n                    type=\"text\"\n                    v-model=\"nameInput\"\n                    class=\"edit-input\"\n                    :placeholder=\"$t('memory.newNamePlaceholder')\"\n                >\n                <span id=\"name-char-count\" class=\"char-count\" style=\"text-align: right; display: block; margin-top: 0.25rem;\">\n                {{ nameInput.length }}\n              </span>\n              </div>\n\n              <div class=\"modal-footer\">\n                <button\n                    id=\"cancel-name\"\n                    class=\"modal-btn cancel-btn\"\n                    @click=\"closeNameModal\"\n                >\n                  {{$t('memory.cancel')}}\n                </button>\n                <button\n                    id=\"save-name\"\n                    class=\"modal-btn confirm-btn\"\n                    @click=\"saveName\"\n                >\n                  {{$t('memory.save')}}\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <div\n              id=\"delete-modal\"\n              class=\"modal-overlay\"\n              v-if=\"showDeleteModal\"\n              @click.self=\"closeDeleteModal\"\n          >\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h3 class=\"modal-title\">{{$t('memory.deleteHint')}}</h3>\n                <p class=\"state-text\" id=\"delete-message\">\n                  {{$t('memory.deleteHintPrefix')}} {{ currentDeleteId }} {{$t('memory.deleteHintSuffix')}}\n                </p>\n              </div>\n\n              <div class=\"modal-footer\">\n                <button\n                    id=\"cancel-delete\"\n                    class=\"modal-btn cancel-btn\"\n                    @click=\"closeDeleteModal\"\n                >\n                  {{$t('memory.cancel')}}\n                </button>\n                <button\n                    id=\"confirm-delete\"\n                    class=\"modal-btn delete-btn-confirm\"\n                    @click=\"confirmDelete\"\n                >\n                  {{$t('memory.delete')}}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport {onMounted, onUnmounted, ref} from 'vue';\nimport {MemoryApiService} from '@/api/memory-api-service'\nimport type { Memory} from '@/api/memory-api-service'\n\n// Extended interface for UI state\ninterface MemoryWithExpanded extends Memory {\n  expanded: boolean;\n}\nimport {Icon} from '@iconify/vue'\nimport {memoryStore} from \"@/stores/memory\";\nimport type {MemoryEmits} from \"@/stores/memory\";\n\nconst showTitleEdit = ref(false);\nconst searchQuery = ref('');\nconst messages = ref<MemoryWithExpanded[]>([]);\nconst filteredMessages = ref<MemoryWithExpanded[]>([]);\n\nconst showNameModal = ref(false);\nconst currentEditMessageId = ref<string | null>(null);\nconst nameInput = ref('');\n\nconst showDeleteModal = ref(false);\nconst currentDeleteId = ref<string | null>(null);\nconst expandedMap = new Map()\nconst emit = defineEmits<MemoryEmits>()\n\n// Handle ESC key to close modals\nconst handleEscKey = (e: KeyboardEvent) => {\n  if (e.key === 'Escape') {\n    if (showDeleteModal.value) {\n      closeDeleteModal()\n    } else if (showNameModal.value) {\n      closeNameModal()\n    }\n  }\n}\n\nonMounted(() => {\n  memoryStore.setLoadMessages(loadMessages)\n  document.addEventListener('keydown', handleEscKey)\n});\n\nonUnmounted(() => {\n  document.removeEventListener('keydown', handleEscKey)\n});\n\nconst loadMessages = async () => {\n  try {\n    const mes = await MemoryApiService.getMemories()\n    messages.value = mes.map((mesMsg: Memory): MemoryWithExpanded => ({\n      ...mesMsg,\n      expanded: expandedMap.has(mesMsg.conversation_id)\n          ? expandedMap.get(mesMsg.conversation_id)\n          : false\n    }));\n    filteredMessages.value = [...messages.value];\n    handleSearch()\n  } catch (e) {\n    console.error('error:', e);\n    messages.value = [];\n\n    filteredMessages.value = [];\n  }\n};\n\nconst selectMemory = (conversationId: string) => {\n  memoryStore.selectMemory(conversationId);\n  emit('memory-selected')\n};\n\nconst formatTimestamp = (timestamp: number | string): string => {\n  const timestampNum = typeof timestamp === 'string' ? parseInt(timestamp, 10) : timestamp;\n  if (isNaN(timestampNum) || timestampNum <= 0) {\n    return 'unknow time';\n  }\n  const date = new Date(\n      timestampNum.toString().length === 13\n          ? timestampNum\n          : timestampNum * 1000\n  );\n\n  return date.toLocaleString('zh-CN', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    second: '2-digit',\n    hour12: false\n  }).replace(',', ' ');\n};\n\nconst handleSearch = () => {\n  const query = searchQuery.value.toLowerCase().trim();\n\n  if (!query) {\n    filteredMessages.value = [...messages.value];\n    return;\n  }\n\n  filteredMessages.value = messages.value.filter(message => {\n    const matchesName = message.memory_name.toLowerCase().includes(query);\n    const matchesId = message.conversation_id.toLowerCase().includes(query);\n    const matchesContent = message.messages?.some(bubble =>\n        bubble.text.toLowerCase().includes(query)\n    ) ?? false;\n    return matchesName || matchesId || matchesContent;\n  });\n};\n\nconst showNameEditModal = (messageId: string, currentName: string) => {\n  currentEditMessageId.value = messageId;\n  nameInput.value = currentName;\n  showNameModal.value = true;\n};\n\nconst closeNameModal = () => {\n  showNameModal.value = false;\n  currentEditMessageId.value = null;\n};\n\nconst saveName = async () => {\n  if (!currentEditMessageId.value) return;\n  const newName = nameInput.value.trim() || 'unknow name';\n  const messageIndex = messages.value.findIndex(\n      msg => msg.conversation_id === currentEditMessageId.value\n  );\n  if (messageIndex !== -1) {\n    const currentMessage = messages.value[messageIndex]\n    try {\n      const returnMemory = await MemoryApiService.updateMemory(currentMessage.conversation_id, newName)\n      if (!returnMemory.messages) {\n        returnMemory.messages = [];\n      }\n      messages.value[messageIndex] = {...returnMemory, expanded: currentMessage.expanded} as MemoryWithExpanded;\n      handleSearch();\n      showNameModal.value = false;\n    } catch (error) {\n      console.error('error:', error);\n    }\n  }\n};\n\nconst toggleMessage = (id: string) => {\n  const message = messages.value.find(msg => msg.conversation_id === id);\n  if (message) {\n    message.expanded = !message.expanded;\n    expandedMap.set(id, message.expanded)\n    const filteredIndex = filteredMessages.value.findIndex(msg => msg.conversation_id === id);\n    if (filteredIndex !== -1) {\n      filteredMessages.value[filteredIndex] = {...message};\n    }\n  }\n};\n\nconst showDeleteConfirm = (id: string) => {\n  currentDeleteId.value = id;\n  showDeleteModal.value = true;\n};\n\nconst closeDeleteModal = () => {\n  showDeleteModal.value = false;\n  currentDeleteId.value = null;\n};\n\nconst confirmDelete = async () => {\n  if (!currentDeleteId.value) return;\n\n  try {\n    await MemoryApiService.deleteMemory(currentDeleteId.value);\n    messages.value = messages.value.filter(msg => msg.conversation_id !== currentDeleteId.value);\n    handleSearch();\n    if(messages.value.length === 0){\n      memoryStore.clearMemoryId()\n    }\n    showDeleteModal.value = false;\n    currentDeleteId.value = null;\n  } catch (error) {\n    console.error('error:', error);\n  }\n};\n</script>\n\n<style scoped>\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n}\n\n.app-container {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.7);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.app-content {\n  position: relative;\n  transition: all 0.3s ease-in-out;\n  overflow-y: auto;\n  border-radius: 16px;\n  width: 90%;\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.15));\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  max-width: 800px;\n  max-height: 80vh;\n  min-height: 500px;\n}\n\n.memory-wrapper-collapsed {\n  border-right: none;\n  width: 0;\n}\n\n.header {\n  padding: 1rem;\n  border-bottom: 1px solid #333333;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.main-title {\n  font-size: 1.25rem;\n  font-weight: bold;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  -webkit-background-clip: text;\n  background-clip: text;\n  color: transparent;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n}\n\n.main-title i {\n  margin-right: 0.5rem;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s;\n}\n\n.close-btn:hover {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.search-bar {\n  padding: 1rem;\n  border-bottom: 1px solid #333333;\n}\n\n.search-container {\n  position: relative;\n}\n.search-container-icon {\n  position: absolute;\n  top: 10px;\n  left: 8px;\n}\n\n.search-input {\n  width: 100%;\n  background-color: #2d2d2d;\n  border: 1px solid #333333;\n  border-radius: 0.5rem;\n  padding: 0.5rem 0.5rem 0.5rem 2.5rem;\n  color: #ffffff;\n  font-size: 0.875rem;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: #667eea;\n}\n\n.search-icon {\n  position: absolute;\n  left: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #888888;\n}\n\n.message-list {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n\n.message-item {\n  background-color: #2d2d2d;\n  border: 1px solid #333333;\n  border-radius: 0.5rem;\n  overflow: hidden;\n  margin-bottom: 0.5rem;\n  transition: all 0.2s ease;\n}\n\n.message-item:hover {\n  background-color: #333333;\n  border-color: rgba(102, 126, 234, 0.5);\n}\n\n.message-header {\n  cursor: text;\n  padding: 0.75rem;\n  align-items: center;\n  width: 100%;\n}\n\n.message-content {\n  flex: 1;\n  min-width: 0;\n  padding-right: 0.5rem;\n}\n.message.user .message-content {\n  flex: none !important;\n}\n\n.sender-info {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 0.25rem;\n}\n\n.sender-div {\n  display: flex;\n  align-items: center;\n  width: 85%;\n  cursor: pointer;\n}\n\n.sender-div:hover:not(:has(.edit-btn:hover, .down-btn:hover, .delete-btn:hover)) .sender-name {\n  color: #667eea;\n}\n\n.sender-name {\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.message-preview {\n  margin-bottom: 0.25rem;\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n}\n\n.preview-line {\n  font-size: 0.875rem;\n  color: rgba(255, 255, 255, 0.7);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 0.125rem;\n}\n\n.message-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  margin-top: 0.25rem;\n}\n\n.meta-right {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.message-id {\n  font-size: 0.75rem;\n  color: #667eea;\n}\n\n.message-time {\n  font-size: 0.75rem;\n  color: rgba(255, 255, 255, 0.5);\n  white-space: nowrap;\n}\n\n.unread-count {\n  font-size: 0.75rem;\n  background-color: rgba(102, 126, 234, 0.2);\n  color: #667eea;\n  padding: 0.125rem 0.375rem;\n  margin-top: 2px;\n  border-radius: 1rem;\n}\n\n.toggle-container {\n  margin-left: auto;\n  margin-top: 4px;\n  display: flex;\n  align-items: center;\n}\n\n.action-buttons {\n  margin-left: 0.5rem;\n  transition: opacity 0.2s ease;\n}\n\n.message-item:hover .action-buttons {\n  opacity: 1;\n}\n\n.edit-btn {\n  margin-left: 10px;\n  cursor: pointer;\n}\n\n.edit-btn:hover {\n  color: #667eea;\n}\n\n.down-btn {\n  cursor: pointer;\n}\n\n.down-btn:hover {\n  color: #667eea;\n}\n\n.delete-btn {\n  color: rgba(255, 255, 255, 0.7);\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0.25rem 0;\n  font-size: 1rem;\n}\n\n.delete-btn:hover {\n  color: #ff6b6b;\n}\n\n.expanded-content {\n  background-color: #333333;\n  border-top: 1px solid #444444;\n  padding: 0.75rem;\n  animation: fadeIn 0.3s ease-in-out;\n}\n\n.message-bubble {\n}\n\n.bubble-avatar {\n  width: 5rem;\n  overflow: hidden;\n  margin-right: 0.5rem;\n  flex-shrink: 0;\n  margin-bottom: 6px;\n  font-size: 16px;\n  color: rgba(255, 255, 255, 0.8);\n  font-weight: 500;\n}\n\n.bubble-avatar img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.bubble-content {\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n}\n\n.bubble-text {\n  font-size: 12px;\n  margin-bottom: 0.25rem;\n}\n\n.state-text {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 50;\n}\n\n.modal-content {\n  background-color: #2d2d2d;\n  border: 1px solid #444444;\n  border-radius: 0.5rem;\n  width: 100%;\n  max-width: 28rem;\n  padding: 1.25rem;\n  transition: all 0.3s ease;\n}\n\n.modal-header {\n  text-align: center;\n  margin-bottom: 1rem;\n}\n\n.modal-title {\n  font-size: 1.125rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: space-between;\n  gap: 0.75rem;\n}\n\n.modal-btn {\n  flex: 1;\n  padding: 0.5rem;\n  border-radius: 0.25rem;\n  font-size: 0.875rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border: none;\n}\n\n.cancel-btn {\n  background-color: #333333;\n  border: 1px solid #444444;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.cancel-btn:hover {\n  background-color: #444444;\n}\n\n.confirm-btn {\n  background-color: #667eea;\n  color: #ffffff;\n}\n\n.confirm-btn:hover {\n  background-color: rgba(102, 126, 234, 0.9);\n}\n\n.delete-btn-confirm {\n  background-color: #ff6b6b;\n  color: #ffffff;\n}\n\n.delete-btn-confirm:hover {\n  background-color: #ff5252;\n}\n\n.edit-input {\n  width: 100%;\n  background-color: #333333;\n  border: 1px solid #444444;\n  border-radius: 0.5rem;\n  padding: 0.5rem 0.75rem;\n  color: #ffffff;\n  font-size: 0.875rem;\n}\n\n.edit-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 1px rgba(102, 126, 234, 0.3);\n}\n\n.char-count {\n  font-size: 0.75rem;\n  color: rgba(255, 255, 255, 0.5);\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes fadeInOut {\n  0% {\n    opacity: 0;\n    transform: translateY(-20px) translateX(-50%);\n  }\n  20% {\n    opacity: 1;\n    transform: translateY(0) translateX(-50%);\n  }\n  80% {\n    opacity: 1;\n    transform: translateY(0) translateX(-50%);\n  }\n  100% {\n    opacity: 0;\n    transform: translateY(-20px) translateX(-50%);\n  }\n}\n\n@media (max-width: 640px) {\n  .main-title {\n    font-size: 1.125rem;\n  }\n\n  .message-id {\n    display: none;\n  }\n\n  .message-time {\n    font-size: 0.7rem;\n  }\n}\n</style>\n","import type { AgentExecutionRecordDetail } from '@/types/agent-execution-detail'\n\nconst API_BASE_URL = '/api/executor'\n\n/**\n * Fetch detailed agent execution record by stepId\n * @param stepId The stepId to query\n * @returns Promise<AgentExecutionRecordDetail | null>\n */\nexport async function fetchAgentExecutionDetail(stepId: string): Promise<AgentExecutionRecordDetail | null> {\n  try {\n    const response = await fetch(`${API_BASE_URL}/agent-execution/${stepId}`)\n    \n    if (!response.ok) {\n      if (response.status === 404) {\n        console.warn(`Agent execution detail not found for stepId: ${stepId}`)\n        return null\n      }\n      throw new Error(`HTTP error! status: ${response.status}`)\n    }\n    \n    const data = await response.json()\n    return data as AgentExecutionRecordDetail\n  } catch (error) {\n    console.error(`Error fetching agent execution detail for stepId: ${stepId}:`, error)\n    return null\n  }\n}\n\n/**\n * Refresh agent execution detail by stepId\n * This is a wrapper around fetchAgentExecutionDetail for explicit refresh operations\n * @param stepId The stepId to refresh\n * @returns Promise<AgentExecutionRecordDetail | null>\n */\nexport async function refreshAgentExecutionDetail(stepId: string): Promise<AgentExecutionRecordDetail | null> {\n  console.log(`Refreshing agent execution detail for stepId: ${stepId}`)\n  return fetchAgentExecutionDetail(stepId)\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Define interface types\nexport interface FileNode {\n    name: string\n    path: string\n    type: 'file' | 'directory'\n    size: number\n    lastModified: string\n    children?: FileNode[]\n}\n\nexport interface FileContent {\n    content: string\n    mimeType: string\n    size: number\n}\n\nexport interface ApiResponse<T> {\n    success: boolean\n    data?: T\n    message?: string\n}\n\n/**\n * File Browser API service class\n * Responsible for interacting with backend FileBrowserController\n */\nexport class FileBrowserApiService {\n    private static readonly BASE_URL = '/api/file-browser'\n\n    /**\n     * Handle HTTP response\n     */\n    private static async handleResponse(response: Response) {\n        if (!response.ok) {\n            try {\n                const errorData = await response.json()\n                throw new Error(errorData.message ?? `API request failed: ${response.status}`)\n            } catch {\n                throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n            }\n        }\n        return response\n    }\n\n    /**\n     * Get file tree for a specific plan ID\n     */\n    static async getFileTree(planId: string): Promise<FileNode> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/tree/${planId}`)\n            const result = await this.handleResponse(response)\n            const apiResponse: ApiResponse<FileNode> = await result.json()\n\n            if (!apiResponse.success) {\n                throw new Error(apiResponse.message ?? 'Failed to get file tree')\n            }\n\n            return apiResponse.data!\n        } catch (error) {\n            console.error('Failed to get file tree:', error)\n            throw error\n        }\n    }\n\n    /**\n     * Get file content\n     */\n    static async getFileContent(planId: string, filePath: string): Promise<FileContent> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/content/${planId}?path=${encodeURIComponent(filePath)}`)\n            const result = await this.handleResponse(response)\n            const apiResponse: ApiResponse<FileContent> = await result.json()\n\n            if (!apiResponse.success) {\n                throw new Error(apiResponse.message ?? 'Failed to get file content')\n            }\n\n            return apiResponse.data!\n        } catch (error) {\n            console.error('Failed to get file content:', error)\n            throw error\n        }\n    }\n\n    /**\n     * Download file\n     */\n    static async downloadFile(planId: string, filePath: string, fileName?: string): Promise<void> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/download/${planId}?path=${encodeURIComponent(filePath)}`)\n            await this.handleResponse(response)\n\n            const blob = await response.blob()\n            const url = window.URL.createObjectURL(blob)\n            const a = document.createElement('a')\n            a.href = url\n            a.download = fileName ?? filePath.split('/').pop() ?? 'download'\n            document.body.appendChild(a)\n            a.click()\n            window.URL.revokeObjectURL(url)\n            document.body.removeChild(a)\n        } catch (error) {\n            console.error('Failed to download file:', error)\n            throw error\n        }\n    }\n\n    /**\n     * Check if file is text-based (can be displayed in editor)\n     */\n    static isTextFile(mimeType: string, fileName: string): boolean {\n        const textMimeTypes = [\n            'text/',\n            'application/json',\n            'application/xml',\n            'application/javascript',\n            'application/typescript'\n        ]\n\n        const textExtensions = [\n            '.txt', '.md', '.json', '.xml', '.html', '.css', '.js', '.ts',\n            '.vue', '.jsx', '.tsx', '.py', '.java', '.cpp', '.c', '.h',\n            '.sh', '.bat', '.yml', '.yaml', '.properties', '.conf', '.cfg'\n        ]\n\n        // Check mime type\n        if (textMimeTypes.some(type => mimeType.startsWith(type))) {\n            return true\n        }\n\n        // Check file extension\n        const lowerFileName = fileName.toLowerCase()\n        return textExtensions.some(ext => lowerFileName.endsWith(ext))\n    }\n\n    /**\n     * Get file icon based on file type\n     */\n    static getFileIcon(node: FileNode): string {\n        if (node.type === 'directory') {\n            return 'carbon:folder'\n        }\n\n        const fileName = node.name.toLowerCase()\n\n        // Programming languages\n        if (fileName.endsWith('.js')) return 'vscode-icons:file-type-js'\n        if (fileName.endsWith('.ts')) return 'vscode-icons:file-type-typescript'\n        if (fileName.endsWith('.vue')) return 'vscode-icons:file-type-vue'\n        if (fileName.endsWith('.java')) return 'vscode-icons:file-type-java'\n        if (fileName.endsWith('.py')) return 'vscode-icons:file-type-python'\n        if (fileName.endsWith('.json')) return 'vscode-icons:file-type-json'\n        if (fileName.endsWith('.xml')) return 'vscode-icons:file-type-xml'\n        if (fileName.endsWith('.html')) return 'vscode-icons:file-type-html'\n        if (fileName.endsWith('.css')) return 'vscode-icons:file-type-css'\n        if (fileName.endsWith('.md')) return 'vscode-icons:file-type-markdown'\n        if (fileName.endsWith('.yml') || fileName.endsWith('.yaml')) return 'vscode-icons:file-type-yaml'\n\n        // Documents\n        if (fileName.endsWith('.pdf')) return 'vscode-icons:file-type-pdf2'\n        if (fileName.endsWith('.doc') || fileName.endsWith('.docx')) return 'vscode-icons:file-type-word'\n        if (fileName.endsWith('.xls') || fileName.endsWith('.xlsx')) return 'vscode-icons:file-type-excel'\n        if (fileName.endsWith('.ppt') || fileName.endsWith('.pptx')) return 'vscode-icons:file-type-powerpoint'\n\n        // Images\n        if (fileName.match(/\\.(jpg|jpeg|png|gif|bmp|svg)$/)) return 'carbon:image'\n\n        // Archives\n        if (fileName.match(/\\.(zip|rar|7z|tar|gz)$/)) return 'carbon:archive'\n\n        // Default file icon\n        return 'carbon:document'\n    }\n}\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"file-tree-node\">\n    <div\n      class=\"node-content\"\n      :class=\"{\n        'is-directory': node.type === 'directory',\n        'is-file': node.type === 'file',\n        'is-expanded': isExpanded\n      }\"\n      :style=\"{ paddingLeft: `${level * 16 + 12}px` }\"\n      @click=\"handleClick\"\n      @contextmenu.prevent=\"handleRightClick\"\n    >\n      <!-- Expand/Collapse Icon for directories -->\n      <div\n        v-if=\"node.type === 'directory'\"\n        class=\"expand-icon\"\n        @click.stop=\"toggleExpanded\"\n      >\n        <Icon\n          :icon=\"isExpanded ? 'carbon:chevron-down' : 'carbon:chevron-right'\"\n          class=\"chevron-icon\"\n        />\n      </div>\n\n      <!-- File/Directory Icon -->\n      <div class=\"node-icon\">\n        <Icon :icon=\"getNodeIcon()\" />\n      </div>\n\n      <!-- Name -->\n      <span class=\"node-name\">{{ node.name }}</span>\n\n      <!-- File size for files -->\n      <span v-if=\"node.type === 'file'\" class=\"file-size\">\n        {{ formatFileSize(node.size) }}\n      </span>\n\n      <!-- Actions -->\n      <div class=\"node-actions\" v-if=\"showActions\">\n        <button\n          v-if=\"node.type === 'file'\"\n          @click.stop=\"$emit('download-file', node)\"\n          class=\"action-btn download-btn\"\n          title=\"Download\"\n        >\n          <Icon icon=\"carbon:download\" />\n        </button>\n      </div>\n    </div>\n\n    <!-- Children (for directories) -->\n    <div v-if=\"node.type === 'directory' && isExpanded && node.children\" class=\"children\">\n      <FileTreeNode\n        v-for=\"child in node.children\"\n        :key=\"child.path\"\n        :node=\"child\"\n        :level=\"level + 1\"\n        @file-selected=\"$emit('file-selected', $event)\"\n        @download-file=\"$emit('download-file', $event)\"\n      />\n    </div>\n\n    <!-- Context Menu -->\n    <div\n      v-if=\"showContextMenu\"\n      class=\"context-menu\"\n      :style=\"contextMenuStyle\"\n      @click.stop\n    >\n      <div class=\"context-menu-item\" @click=\"handleFileSelect\">\n        <Icon icon=\"carbon:view\" />\n        <span>Open</span>\n      </div>\n      <div\n        v-if=\"node.type === 'file'\"\n        class=\"context-menu-item\"\n        @click=\"handleDownload\"\n      >\n        <Icon icon=\"carbon:download\" />\n        <span>Download</span>\n      </div>\n      <div class=\"context-menu-divider\"></div>\n      <div class=\"context-menu-item\" @click=\"copyPath\">\n        <Icon icon=\"carbon:copy\" />\n        <span>Copy Path</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onUnmounted } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { FileBrowserApiService, type FileNode } from '@/api/file-browser-api-service'\n\ninterface Props {\n  node: FileNode\n  level: number\n}\n\ninterface Emits {\n  (e: 'file-selected', file: FileNode): void\n  (e: 'download-file', file: FileNode): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n// const { t } = useI18n()\n\n// State\nconst isExpanded = ref(props.level === 0) // Root directory expanded by default\nconst showActions = ref(false)\nconst showContextMenu = ref(false)\nconst contextMenuStyle = ref({})\n\n// Computed\n// const hasChildren = computed(() => {\n//   return props.node.type === 'directory' && props.node.children && props.node.children.length > 0\n// })\n\n// Methods\nconst toggleExpanded = () => {\n  if (props.node.type === 'directory') {\n    isExpanded.value = !isExpanded.value\n  }\n}\n\nconst handleClick = () => {\n  if (props.node.type === 'directory') {\n    toggleExpanded()\n  } else {\n    handleFileSelect()\n  }\n}\n\nconst handleFileSelect = () => {\n  if (props.node.type === 'file') {\n    emit('file-selected', props.node)\n  }\n  hideContextMenu()\n}\n\nconst handleDownload = () => {\n  emit('download-file', props.node)\n  hideContextMenu()\n}\n\nconst handleRightClick = (event: MouseEvent) => {\n  event.preventDefault()\n  showContextMenu.value = true\n\n  // Position context menu\n  // const rect = (event.target as HTMLElement).getBoundingClientRect()\n  contextMenuStyle.value = {\n    position: 'fixed',\n    top: `${event.clientY}px`,\n    left: `${event.clientX}px`,\n    zIndex: 1000\n  }\n\n  // Add click listener to hide context menu\n  setTimeout(() => {\n    document.addEventListener('click', hideContextMenu)\n  }, 0)\n}\n\nconst hideContextMenu = () => {\n  showContextMenu.value = false\n  document.removeEventListener('click', hideContextMenu)\n}\n\nconst copyPath = async () => {\n  try {\n    await navigator.clipboard.writeText(props.node.path)\n    // You could show a toast message here\n  } catch (err) {\n    console.error('Failed to copy path:', err)\n  }\n  hideContextMenu()\n}\n\nconst getNodeIcon = () => {\n  if (props.node.type === 'directory') {\n    return isExpanded.value ? 'carbon:folder-open' : 'carbon:folder'\n  }\n  return FileBrowserApiService.getFileIcon(props.node)\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\n// Lifecycle\nonUnmounted(() => {\n  document.removeEventListener('click', hideContextMenu)\n})\n</script>\n\n<style scoped>\n.file-tree-node {\n  position: relative;\n}\n\n.node-content {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 6px;\n  margin: 1px 8px;\n  position: relative;\n}\n\n.node-content:hover {\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.node-content.is-directory {\n  font-weight: 500;\n}\n\n.expand-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 16px;\n  height: 16px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.7);\n  transition: color 0.2s ease;\n}\n\n.expand-icon:hover {\n  color: #ffffff;\n}\n\n.chevron-icon {\n  font-size: 12px;\n  transition: transform 0.2s ease;\n}\n\n.node-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 18px;\n  height: 18px;\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.node-icon .iconify {\n  font-size: 16px;\n}\n\n.node-name {\n  flex: 1;\n  color: #ffffff;\n  font-size: 13px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.file-size {\n  color: rgba(255, 255, 255, 0.5);\n  font-size: 11px;\n  white-space: nowrap;\n}\n\n.node-actions {\n  display: flex;\n  gap: 4px;\n  opacity: 0;\n  transition: opacity 0.2s ease;\n}\n\n.node-content:hover .node-actions {\n  opacity: 1;\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  height: 20px;\n  background: rgba(255, 255, 255, 0.1);\n  border: none;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.action-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n  color: #ffffff;\n}\n\n.action-btn .iconify {\n  font-size: 12px;\n}\n\n.children {\n  overflow: hidden;\n}\n\n.context-menu {\n  background: rgba(20, 20, 20, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 8px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(20px);\n  padding: 6px;\n  min-width: 160px;\n}\n\n.context-menu-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  cursor: pointer;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 13px;\n  transition: background-color 0.2s ease;\n}\n\n.context-menu-item:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.context-menu-item .iconify {\n  font-size: 14px;\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.context-menu-divider {\n  height: 1px;\n  background: rgba(255, 255, 255, 0.1);\n  margin: 4px 0;\n}\n\n/* Directory specific styles */\n.node-content.is-directory .node-name {\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.node-content.is-directory.is-expanded .node-icon {\n  color: #677eea;\n}\n\n/* File specific styles */\n.node-content.is-file .node-name {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n/* Animation for expanding/collapsing */\n.children {\n  animation: slideDown 0.2s ease-out;\n}\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n</style>\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"file-browser\">\n    <div class=\"file-browser-header\">\n      <h3>{{ $t('fileBrowser.title') }}</h3>\n      <div class=\"header-actions\">\n                <button\n          class=\"refresh-btn\"\n          @click=\"refreshFileTree\"\n          :disabled=\"loading\"\n          :title=\"$t('fileBrowser.refresh')\"\n        >\n          <Icon\n            icon=\"carbon:refresh\"\n            :class=\"{ 'rotating': loading }\"\n            :style=\"{ color: '#ffffff', fontSize: '18px', width: '18px', height: '18px' }\"\n          />\n        </button>\n      </div>\n    </div>\n\n    <div class=\"file-browser-content\">\n      <!-- File Tree -->\n      <div class=\"file-tree-panel\">\n        <div v-if=\"loading\" class=\"loading-state\">\n          <Icon icon=\"carbon:loading\" class=\"rotating\" />\n          <span>{{ $t('fileBrowser.loading') }}</span>\n        </div>\n\n        <div v-else-if=\"error\" class=\"error-state\">\n          <div v-if=\"isPlanDirectoryNotFound\" class=\"waiting-for-files\">\n            <Icon icon=\"carbon:time\" class=\"rotating\" />\n            <div class=\"message-content\">\n              <h3>{{ $t('fileBrowser.waitingForGeneration') }}</h3>\n              <p>{{ $t('fileBrowser.planExecuting') }}</p>\n              <div class=\"tips\">\n                <Icon icon=\"carbon:information\" />\n                <span>{{ $t('fileBrowser.filesTip') }}</span>\n              </div>\n            </div>\n            <button @click=\"refreshFileTree\" class=\"retry-btn\" :disabled=\"loading\">\n              <Icon icon=\"carbon:refresh\" :class=\"{ 'rotating': loading }\" />\n              {{ loading ? $t('fileBrowser.checking') : $t('fileBrowser.checkNow') }}\n            </button>\n          </div>\n          <div v-else class=\"actual-error\">\n            <Icon icon=\"carbon:warning\" />\n            <span>{{ error }}</span>\n            <button @click=\"refreshFileTree\" class=\"retry-btn\">\n              {{ $t('fileBrowser.retry') }}\n            </button>\n          </div>\n        </div>\n\n        <div v-else-if=\"!fileTree\" class=\"empty-state\">\n          <Icon icon=\"carbon:folder-off\" />\n          <span>{{ $t('fileBrowser.noFiles') }}</span>\n        </div>\n\n        <div v-else class=\"file-tree\">\n          <FileTreeNode\n            :node=\"fileTree\"\n            :level=\"0\"\n            @file-selected=\"handleFileSelected\"\n            @download-file=\"handleDownloadFile\"\n          />\n        </div>\n      </div>\n\n      <!-- File Content Viewer -->\n      <div class=\"file-content-panel\" v-if=\"selectedFile\">\n        <div class=\"file-content-header\">\n          <div class=\"file-info\">\n            <Icon :icon=\"getFileIcon(selectedFile)\" />\n            <span class=\"file-name\">{{ selectedFile.name }}</span>\n            <span class=\"file-size\">({{ formatFileSize(selectedFile.size) }})</span>\n          </div>\n          <div class=\"file-actions\">\n            <button\n              @click=\"handleDownloadFile(selectedFile)\"\n              class=\"download-btn\"\n              :title=\"$t('fileBrowser.download')\"\n            >\n              <Icon icon=\"carbon:download\" />\n            </button>\n            <button\n              @click=\"closeFileViewer\"\n              class=\"close-btn\"\n              :title=\"$t('common.close')\"\n            >\n              <Icon icon=\"carbon:close\" />\n            </button>\n          </div>\n        </div>\n\n        <div class=\"file-content-body\">\n          <div v-if=\"loadingContent\" class=\"loading-content\">\n            <Icon icon=\"carbon:loading\" class=\"rotating\" />\n            <span>{{ $t('fileBrowser.loadingContent') }}</span>\n          </div>\n\n          <div v-else-if=\"contentError\" class=\"content-error\">\n            <Icon icon=\"carbon:warning\" />\n            <span>{{ contentError }}</span>\n          </div>\n\n          <div v-else-if=\"fileContent\" class=\"file-content\">\n            <div v-if=\"isTextFile\" class=\"text-content\">\n              <pre><code>{{ fileContent.content }}</code></pre>\n            </div>\n            <div v-else class=\"binary-content\">\n              <Icon icon=\"carbon:document-unknown\" />\n              <p>{{ $t('fileBrowser.binaryFile') }}</p>\n              <button @click=\"handleDownloadFile(selectedFile)\" class=\"download-btn-large\">\n                <Icon icon=\"carbon:download\" />\n                {{ $t('fileBrowser.downloadToView') }}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted, onUnmounted, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport FileTreeNode from './FileTreeNode.vue'\nimport { FileBrowserApiService, type FileNode, type FileContent } from '@/api/file-browser-api-service'\n\ninterface Props {\n  planId: string\n}\n\nconst props = defineProps<Props>()\nconst { t } = useI18n()\n\n// State\nconst loading = ref(false)\nconst error = ref<string | null>(null)\nconst fileTree = ref<FileNode | null>(null)\nconst selectedFile = ref<FileNode | null>(null)\nconst fileContent = ref<FileContent | null>(null)\nconst loadingContent = ref(false)\nconst contentError = ref<string | null>(null)\nconst autoRefreshTimer = ref<number | null>(null)\n\n// Computed\nconst isTextFile = computed(() => {\n  if (!fileContent.value || !selectedFile.value) return false\n  return FileBrowserApiService.isTextFile(fileContent.value.mimeType, selectedFile.value.name)\n})\n\nconst isPlanDirectoryNotFound = computed(() => {\n  return error.value && (\n    error.value.includes('Plan directory not found') ||\n    error.value.includes('not found')\n  )\n})\n\n// Methods\nconst clearAutoRefresh = () => {\n  if (autoRefreshTimer.value) {\n    clearTimeout(autoRefreshTimer.value)\n    autoRefreshTimer.value = null\n  }\n}\n\nconst startAutoRefresh = () => {\n  clearAutoRefresh()\n  // Auto refresh every 5 seconds when plan directory is not found\n  autoRefreshTimer.value = window.setTimeout(() => {\n    if (isPlanDirectoryNotFound.value) {\n      refreshFileTree()\n    }\n  }, 5000)\n}\n\nconst refreshFileTree = async () => {\n  if (!props.planId) return\n\n  loading.value = true\n  error.value = null\n  clearAutoRefresh()\n\n  try {\n    fileTree.value = await FileBrowserApiService.getFileTree(props.planId)\n    // Success - no need to auto refresh\n  } catch (err) {\n    error.value = err instanceof Error ? err.message : t('fileBrowser.loadError')\n    console.error('Failed to load file tree:', err)\n\n    // Start auto refresh if it's a \"directory not found\" error\n    const errorMessage = err instanceof Error ? err.message : ''\n    if (errorMessage.includes('Plan directory not found') ||\n        errorMessage.includes('not found')) {\n      startAutoRefresh()\n    }\n  } finally {\n    loading.value = false\n  }\n}\n\nconst handleFileSelected = async (file: FileNode) => {\n  if (file.type === 'directory') return\n\n  selectedFile.value = file\n  fileContent.value = null\n  loadingContent.value = true\n  contentError.value = null\n\n  try {\n    fileContent.value = await FileBrowserApiService.getFileContent(props.planId, file.path)\n  } catch (err) {\n    contentError.value = err instanceof Error ? err.message : t('fileBrowser.contentLoadError')\n    console.error('Failed to load file content:', err)\n  } finally {\n    loadingContent.value = false\n  }\n}\n\nconst handleDownloadFile = async (file: FileNode) => {\n  try {\n    await FileBrowserApiService.downloadFile(props.planId, file.path, file.name)\n  } catch (err) {\n    console.error('Failed to download file:', err)\n    // You could show a toast message here\n  }\n}\n\nconst closeFileViewer = () => {\n  selectedFile.value = null\n  fileContent.value = null\n  contentError.value = null\n}\n\nconst getFileIcon = (file: FileNode) => {\n  return FileBrowserApiService.getFileIcon(file)\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\n// Watch for plan ID changes\nwatch(() => props.planId, (newPlanId) => {\n  if (newPlanId) {\n    selectedFile.value = null\n    fileContent.value = null\n    refreshFileTree()\n  }\n}, { immediate: true })\n\n// Lifecycle\nonMounted(() => {\n  if (props.planId) {\n    refreshFileTree()\n  }\n})\n\nonUnmounted(() => {\n  clearAutoRefresh()\n})\n</script>\n\n<style scoped>\n.file-browser {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: rgba(255, 255, 255, 0.02);\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  overflow: hidden;\n}\n\n.file-browser-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-browser-header h3 {\n  margin: 0;\n  color: #ffffff;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.header-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.refresh-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  background: rgba(255, 255, 255, 0.15);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  border-radius: 8px;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 18px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n}\n\n.refresh-btn .iconify {\n  color: #ffffff !important;\n  font-size: 18px !important;\n  width: 18px !important;\n  height: 18px !important;\n}\n\n.refresh-btn svg {\n  fill: #ffffff !important;\n  color: #ffffff !important;\n  width: 18px !important;\n  height: 18px !important;\n}\n\n.refresh-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.25);\n  border-color: rgba(255, 255, 255, 0.4);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n}\n\n.refresh-btn:hover:not(:disabled) .iconify,\n.refresh-btn:hover:not(:disabled) svg {\n  color: #ffffff !important;\n  fill: #ffffff !important;\n}\n\n.refresh-btn:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.refresh-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.15);\n}\n\n.refresh-btn:disabled .iconify,\n.refresh-btn:disabled svg {\n  color: rgba(255, 255, 255, 0.4) !important;\n  fill: rgba(255, 255, 255, 0.4) !important;\n}\n\n.file-browser-content {\n  display: flex;\n  flex: 1;\n  min-height: 0;\n}\n\n.file-tree-panel {\n  flex: 0 0 300px;\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n  overflow-y: auto;\n}\n\n.file-content-panel {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n}\n\n.loading-state,\n.error-state,\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 12px;\n}\n\n.loading-state .iconify,\n.error-state .iconify,\n.empty-state .iconify {\n  font-size: 32px;\n}\n\n.retry-btn {\n  padding: 8px 16px;\n  background: rgba(103, 126, 234, 0.2);\n  border: 1px solid rgba(103, 126, 234, 0.3);\n  border-radius: 6px;\n  color: #677eea;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.retry-btn:hover {\n  background: rgba(103, 126, 234, 0.3);\n}\n\n.retry-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.waiting-for-files {\n  color: #74c0fc;\n}\n\n.waiting-for-files .iconify {\n  font-size: 48px;\n  margin-bottom: 20px;\n  opacity: 0.8;\n}\n\n.waiting-for-files .message-content {\n  margin-bottom: 24px;\n  text-align: center;\n}\n\n.waiting-for-files h3 {\n  margin: 0 0 8px 0;\n  color: #ffffff;\n  font-size: 18px;\n  font-weight: 600;\n}\n\n.waiting-for-files p {\n  margin: 0 0 16px 0;\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 14px;\n  line-height: 1.5;\n}\n\n.waiting-for-files .tips {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(116, 192, 252, 0.1);\n  border: 1px solid rgba(116, 192, 252, 0.2);\n  border-radius: 8px;\n  color: #74c0fc;\n  font-size: 13px;\n}\n\n.waiting-for-files .tips .iconify {\n  font-size: 16px;\n  margin: 0;\n}\n\n.actual-error {\n  color: #ff6b6b;\n}\n\n.file-tree {\n  padding: 8px 0;\n}\n\n.file-content-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #ffffff;\n}\n\n.file-info .iconify {\n  font-size: 18px;\n}\n\n.file-name {\n  font-weight: 600;\n}\n\n.file-size {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 12px;\n}\n\n.file-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.download-btn,\n.close-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.download-btn:hover,\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.15);\n  transform: translateY(-1px);\n}\n\n.file-content-body {\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n.loading-content,\n.content-error {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 12px;\n}\n\n.file-content {\n  flex: 1;\n  overflow: hidden;\n}\n\n.text-content {\n  height: 100%;\n  overflow: auto;\n  padding: 20px;\n}\n\n.text-content pre {\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 13px;\n  line-height: 1.6;\n  color: #ffffff;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n\n.binary-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 16px;\n}\n\n.binary-content .iconify {\n  font-size: 48px;\n}\n\n.download-btn-large {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 24px;\n  background: rgba(103, 126, 234, 0.2);\n  border: 1px solid rgba(103, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #677eea;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 14px;\n}\n\n.download-btn-large:hover {\n  background: rgba(103, 126, 234, 0.3);\n  transform: translateY(-1px);\n}\n\n.rotating {\n  animation: rotate 1s linear infinite;\n}\n\n@keyframes rotate {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n/* Scrollbar styling */\n.file-tree-panel::-webkit-scrollbar,\n.text-content::-webkit-scrollbar {\n  width: 6px;\n}\n\n.file-tree-panel::-webkit-scrollbar-track,\n.text-content::-webkit-scrollbar-track {\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-tree-panel::-webkit-scrollbar-thumb,\n.text-content::-webkit-scrollbar-thumb {\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 3px;\n}\n\n.file-tree-panel::-webkit-scrollbar-thumb:hover,\n.text-content::-webkit-scrollbar-thumb:hover {\n  background: rgba(255, 255, 255, 0.3);\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"right-panel\">\n    <div class=\"preview-header\">\n      <div class=\"preview-tabs\">\n        <!-- Step Execution Details tab -->\n        <div\n            class=\"tab-item\"\n            :class=\"{ active: activeTab === 'details' }\"\n            @click=\"activeTab = 'details'\"\n        >\n          <Icon icon=\"carbon:events\"/>\n          <span>{{ t('rightPanel.stepExecutionDetails') }}</span>\n        </div>\n        <!-- File Browser tab -->\n        <div\n            class=\"tab-item\"\n            :class=\"{ active: activeTab === 'files' }\"\n            @click=\"activeTab = 'files'\"\n        >\n          <Icon icon=\"carbon:folder\"/>\n          <span>{{ t('fileBrowser.title') }}</span>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"preview-content\">\n      <!-- Step Execution Details -->\n      <div v-if=\"activeTab === 'details'\" class=\"step-details\">\n        <!-- Step basic information -->\n        <div v-if=\"selectedStep\" class=\"step-info\">\n          <h3>\n            {{\n              selectedStep.title ||\n              selectedStep.description ||\n              t('rightPanel.defaultStepTitle', { number: 1 })\n            }}\n          </h3>\n\n          <div class=\"agent-info\" v-if=\"selectedStep.agentExecution\">\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.executingAgent') }}:</span>\n              <span class=\"value\">{{ selectedStep.agentExecution.agentName }}</span>\n            </div>\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.callingModel') }}:</span>\n              <span class=\"value\">{{ selectedStep.agentExecution.modelName }}</span>\n            </div>\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.executionResult') }}:</span>\n              <span\n                  class=\"value\"\n                  :class=\"{ success: selectedStep.agentExecution.status === 'FINISHED' }\"\n              >\n                {{ selectedStep.agentExecution.status || t('rightPanel.executing') }}\n              </span>\n            </div>\n          </div>\n\n          <div class=\"execution-status\">\n            <div class=\"status-item\">\n              <Icon\n                  icon=\"carbon:checkmark-filled\"\n                  v-if=\"selectedStep.completed\"\n                  class=\"status-icon success\"\n              />\n              <Icon\n                  icon=\"carbon:in-progress\"\n                  v-else-if=\"selectedStep.current\"\n                  class=\"status-icon progress\"\n              />\n              <Icon icon=\"carbon:time\" v-else class=\"status-icon pending\"/>\n              <span class=\"status-text\">\n                {{ stepStatusText }}\n              </span>\n            </div>\n          </div>\n        </div>\n\n        <!-- Scrollable detailed content area -->\n        <div\n            ref=\"scrollContainer\"\n            class=\"step-details-scroll-container\"\n            @scroll=\"checkScrollState\"\n        >\n          <div v-if=\"selectedStep\">\n            <!-- Think and action steps -->\n            <div\n                class=\"think-act-steps\"\n                v-if=\"selectedStep.agentExecution?.thinkActSteps && selectedStep.agentExecution.thinkActSteps.length > 0\"\n            >\n              <h4>{{ t('rightPanel.thinkAndActionSteps') }}</h4>\n              <div class=\"steps-container\">\n                <div\n                    v-for=\"(tas, index) in selectedStep.agentExecution.thinkActSteps\"\n                    :key=\"index\"\n                    class=\"think-act-step\"\n                >\n                  <div class=\"step-header\">\n                    <span class=\"step-number\">#{{ index + 1 }}</span>\n                    <span class=\"step-status\" :class=\"tas.status\">{{\n                        tas.status || t('rightPanel.executing')\n                      }}</span>\n                  </div>\n\n                  <!-- Think section - strictly follow right-sidebar.js logic -->\n                  <div class=\"think-section\">\n                    <h5>\n                      <Icon icon=\"carbon:thinking\"/>\n                      {{ t('rightPanel.thinking') }}\n                    </h5>\n                    <div class=\"think-content\">\n                      <div class=\"input\">\n                        <span class=\"label\">{{ t('rightPanel.input') }}:</span>\n                        <pre>{{ formatJson(tas.thinkInput) }}</pre>\n                      </div>\n                      <div class=\"output\">\n                        <span class=\"label\">{{ t('rightPanel.output') }}:</span>\n                        <pre>{{ formatJson(tas.thinkOutput) }}</pre>\n                      </div>\n                    </div>\n                  </div>\n\n                  <!-- Action section - strictly follow right-sidebar.js logic -->\n                  <div v-if=\"tas.actionNeeded\" class=\"action-section\">\n                    <h5>\n                      <Icon icon=\"carbon:play\"/>\n                      {{ t('rightPanel.action') }}\n                    </h5>\n                    <div class=\"action-content\">\n                      <div v-for=\"(actToolInfo, index) in tas.actToolInfoList\" :key=\"index\">\n                        <div class=\"tool-info\">\n                          <span class=\"label\">{{ t('rightPanel.tool') }}:</span>\n                          <span class=\"value\">{{ actToolInfo.name || '' }}</span>\n                        </div>\n                        <div class=\"input\">\n                          <span class=\"label\">{{ t('rightPanel.toolParameters') }}:</span>\n                          <pre>{{ formatJson(actToolInfo.parameters) }}</pre>\n                        </div>\n                        <div class=\"output\">\n                          <span class=\"label\">{{ t('rightPanel.executionResult') }}:</span>\n                          <pre>{{ formatJson(actToolInfo.result) }}</pre>\n                        </div>\n                      </div>\n                    </div>\n\n                    <!-- Sub execution plan section - new feature -->\n                    <div v-if=\"tas.subPlanExecutionRecord\" class=\"sub-plan-section\">\n                      <h5>\n                        <Icon icon=\"carbon:tree-view\"/>\n                        {{ t('rightPanel.subPlan') }}\n                      </h5>\n                      <div class=\"sub-plan-content\">\n                        <div class=\"sub-plan-header\">\n                          <div class=\"sub-plan-info\">\n                            <span class=\"label\">{{ $t('rightPanel.subPlanId') }}:</span>\n                            <span class=\"value\">{{ tas.subPlanExecutionRecord.currentPlanId }}</span>\n                          </div>\n                          <div class=\"sub-plan-info\" v-if=\"tas.subPlanExecutionRecord.title\">\n                            <span class=\"label\">{{ $t('rightPanel.title') }}:</span>\n                            <span class=\"value\">{{ tas.subPlanExecutionRecord.title }}</span>\n                          </div>\n                          <div class=\"sub-plan-status\">\n                            <Icon\n                                icon=\"carbon:checkmark-filled\"\n                                v-if=\"tas.subPlanExecutionRecord.completed\"\n                                class=\"status-icon success\"\n                            />\n                            <Icon icon=\"carbon:in-progress\" v-else class=\"status-icon progress\"/>\n                            <span class=\"status-text\">\n                            {{ tas.subPlanExecutionRecord.completed ? $t('rightPanel.status.completed') : $t('rightPanel.status.executing') }}\n                          </span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div\n                  v-if=\"\n                selectedStep.agentExecution &&\n                !selectedStep.agentExecution.thinkActSteps?.length\n              \"\n                  class=\"no-steps-message\"\n              >\n                <p>{{ t('rightPanel.noStepDetails') }}</p>\n              </div>\n\n              <!-- Handle no agentExecution case -->\n              <div\n                  v-else-if=\"!selectedStep.agentExecution\"\n                  class=\"no-execution-message\"\n              >\n                <Icon icon=\"carbon:information\" class=\"info-icon\"/>\n                <h4>{{ t('rightPanel.stepInfo') }}</h4>\n                <div class=\"step-basic-info\">\n                  <div class=\"info-item\">\n                    <span class=\"label\">{{ t('rightPanel.stepName') }}:</span>\n                    <span class=\"value\">{{\n                        selectedStep.title ||\n                        selectedStep.description ||\n                        selectedStep.stepId\n                      }}</span>\n                  </div>\n                  <div class=\"info-item\" v-if=\"selectedStep.description\">\n                    <span class=\"label\">{{ $t('rightPanel.description') }}:</span>\n                    <span class=\"value\">{{ selectedStep.description }}</span>\n                  </div>\n                  <div class=\"info-item\">\n                    <span class=\"label\">{{ $t('rightPanel.status.label') }}:</span>\n                    <span class=\"value\" :class=\"{\n                    'status-completed': selectedStep.completed,\n                    'status-current': selectedStep.current,\n                    'status-pending': !selectedStep.completed && !selectedStep.current\n                  }\">\n                    {{\n                        selectedStep.completed ? $t('rightPanel.status.completed') :\n                            selectedStep.current ? $t('rightPanel.status.executing') : $t('rightPanel.status.pending')\n                      }}\n                  </span>\n                  </div>\n                </div>\n                <p class=\"no-execution-hint\">{{ t('rightPanel.noExecutionInfo') }}</p>\n              </div>\n\n              <!-- Dynamic effect during execution -->\n              <div\n                  v-if=\"selectedStep.current && !selectedStep.completed\"\n                  class=\"execution-indicator\"\n              >\n                <div class=\"execution-waves\">\n                  <div class=\"wave wave-1\"></div>\n                  <div class=\"wave wave-2\"></div>\n                  <div class=\"wave wave-3\"></div>\n                </div>\n                <p class=\"execution-text\">\n                  <Icon icon=\"carbon:in-progress\" class=\"rotating-icon\"/>\n                  {{ t('rightPanel.stepExecuting') }}\n                </p>\n              </div>\n            </div>\n\n            <div v-else class=\"no-selection\">\n              <Icon icon=\"carbon:events\" class=\"empty-icon\"/>\n              <h3>{{ t('rightPanel.noStepSelected') }}</h3>\n              <p>{{ t('rightPanel.selectStepHint') }}</p>\n            </div>\n          </div>\n\n          <!-- Scroll to bottom button -->\n          <Transition name=\"scroll-button\">\n            <button\n                v-if=\"showScrollToBottomButton\"\n                @click=\"scrollToBottom\"\n                class=\"scroll-to-bottom-btn\"\n                :title=\"t('rightPanel.scrollToBottom')\"\n            >\n              <Icon icon=\"carbon:chevron-down\"/>\n            </button>\n          </Transition>\n        </div>\n      </div>\n\n      <!-- File Browser -->\n      <div v-if=\"activeTab === 'files'\" class=\"file-browser-container\">\n        <FileBrowser \n          v-if=\"fileBrowserPlanId\" \n          :plan-id=\"fileBrowserPlanId\"\n        />\n        <div v-else-if=\"shouldShowNoTaskMessage\" class=\"no-plan-message\">\n          <Icon icon=\"carbon:folder-off\" />\n          <div class=\"message-content\">\n            <h3>{{ t('fileBrowser.noFilesYet') }}</h3>\n            <p>{{ t('fileBrowser.noPlanExecuting') }}</p>\n            <div class=\"tips\">\n              <Icon icon=\"carbon:information\" />\n              <span>{{ t('fileBrowser.startTaskTip') }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted, onUnmounted, nextTick, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport { fetchAgentExecutionDetail, refreshAgentExecutionDetail } from '@/api/agent-execution'\nimport type { AgentExecutionRecordDetail } from '@/types/agent-execution-detail'\nimport FileBrowser from '@/components/file-browser/index.vue'\n\n// Define props interface\ninterface Props {\n  currentRootPlanId?: string | null\n  selectedStepId?: string | null\n}\n\nconst props = defineProps<Props>()\n\n// Define selected step interface\ninterface SelectedStep {\n  stepId: string\n  title: string\n  description: string\n  agentExecution?: AgentExecutionRecordDetail\n  completed: boolean\n  current: boolean\n}\n\nconst { t } = useI18n()\n\n// DOM element reference\nconst scrollContainer = ref<HTMLElement>()\n\n// Local state\nconst selectedStep = ref<SelectedStep | null>()\nconst activeTab = ref<'details' | 'files'>('details')\n\n// Keep track of the last executed plan for file browser\nconst lastExecutedPlanId = ref<string | null>(localStorage.getItem('jmanus-last-plan-id'))\nconst hasExecutedAnyPlan = ref(localStorage.getItem('jmanus-has-executed-plan') === 'true')\n\n// Scroll-related state\nconst showScrollToBottomButton = ref(false)\nconst isNearBottom = ref(true)\nconst shouldAutoScrollToBottom = ref(true)\n\n\nconst stepStatusText = computed(() => {\n  if (!selectedStep.value) return ''\n  if (selectedStep.value.completed) return t('rightPanel.status.completed')\n  if (selectedStep.value.current) return t('rightPanel.status.executing')\n  return t('rightPanel.status.waiting')\n})\n\n// Computed property to determine which planId to show in file browser\nconst fileBrowserPlanId = computed(() => {\n  // If there's a current plan, use it\n  if (props.currentRootPlanId) {\n    return props.currentRootPlanId\n  }\n  // Otherwise, use the last executed plan if any\n  return lastExecutedPlanId.value\n})\n\n// Computed property to determine if we should show the \"no task\" message\nconst shouldShowNoTaskMessage = computed(() => {\n  return !fileBrowserPlanId.value && !hasExecutedAnyPlan.value\n})\n\n// Actions - Step selection and refresh control\n\n/**\n * Handle step selection by stepId\n * @param stepId - The step ID to display\n */\nconst handleStepSelected = async (stepId: string) => {\n  console.log('[RightPanel] Step selected:', { stepId })\n\n  if (!stepId) {\n    console.warn('[RightPanel] No stepId provided')\n    selectedStep.value = null\n    return\n  }\n\n  try {\n    // Fetch agent execution detail from API\n    const agentExecutionDetail = await fetchAgentExecutionDetail(stepId)\n    \n    if (!agentExecutionDetail) {\n      console.warn('[RightPanel] Agent execution detail not found for stepId:', stepId)\n      selectedStep.value = null\n      return\n    }\n\n    // Create step data object\n    const stepData: SelectedStep = {\n      stepId: stepId,\n      title: agentExecutionDetail.agentName ?? `Step ${stepId}`,\n      description: agentExecutionDetail.agentDescription ?? '',\n      agentExecution: agentExecutionDetail,\n      completed: agentExecutionDetail.status === 'FINISHED',\n      current: agentExecutionDetail.status === 'RUNNING'\n    }\n\n    selectedStep.value = stepData\n    console.log('[RightPanel] Step details updated:', stepData)\n    console.log('[RightPanel] activeTab:', activeTab.value)\n    console.log('[RightPanel] selectedStep.value:', selectedStep.value)\n    console.log('[RightPanel] agentExecution:', selectedStep.value.agentExecution)\n    console.log('[RightPanel] thinkActSteps:', selectedStep.value.agentExecution?.thinkActSteps)\n    console.log('[RightPanel] thinkActSteps length:', selectedStep.value.agentExecution?.thinkActSteps?.length)\n\n    // Force reactivity update\n    await nextTick()\n    console.log('[RightPanel] After nextTick - selectedStep:', selectedStep.value)\n\n    // Delay scroll state check to ensure DOM is updated\n    setTimeout(() => {\n      checkScrollState()\n    }, 100)\n\n    // Auto-scroll to latest content if previously at bottom\n    autoScrollToBottomIfNeeded()\n  } catch (error) {\n    console.error('[RightPanel] Error fetching step details:', error)\n    selectedStep.value = null\n  }\n}\n\n/**\n * Refresh the currently selected step\n */\nconst refreshCurrentStep = async () => {\n  if (!selectedStep.value?.stepId) {\n    console.warn('[RightPanel] No step selected for refresh')\n    return\n  }\n\n  console.log('[RightPanel] Refreshing current step:', selectedStep.value.stepId)\n  \n  try {\n    const agentExecutionDetail = await refreshAgentExecutionDetail(selectedStep.value.stepId)\n    \n    if (agentExecutionDetail) {\n      // Update the existing step data\n      selectedStep.value.agentExecution = agentExecutionDetail\n      selectedStep.value.completed = agentExecutionDetail.status === 'FINISHED'\n      selectedStep.value.current = agentExecutionDetail.status === 'RUNNING'\n      \n      console.log('[RightPanel] Step refreshed successfully')\n      \n      // Auto-scroll to latest content if previously at bottom\n      autoScrollToBottomIfNeeded()\n    }\n  } catch (error) {\n    console.error('[RightPanel] Error refreshing step:', error)\n  }\n}\n\n// Watch for selectedStepId prop changes\nwatch(() => props.selectedStepId, async (newStepId) => {\n  if (newStepId) {\n    await handleStepSelected(newStepId)\n  } else {\n    selectedStep.value = null\n  }\n}, { immediate: true })\n\n\n\n// Actions - Scroll management\nconst setScrollContainer = (element: HTMLElement | null) => {\n  scrollContainer.value = element ?? undefined\n}\n\nconst checkScrollState = () => {\n  if (!scrollContainer.value) return\n\n  const { scrollTop, scrollHeight, clientHeight } = scrollContainer.value\n  const isAtBottom = scrollHeight - scrollTop - clientHeight < 50\n  const hasScrollableContent = scrollHeight > clientHeight\n\n  isNearBottom.value = isAtBottom\n  showScrollToBottomButton.value = hasScrollableContent && !isAtBottom\n\n  // Update auto-scroll flag: should auto-scroll if user scrolls to bottom\n  // If user actively scrolls up away from bottom, stop auto-scrolling\n  if (isAtBottom) {\n    shouldAutoScrollToBottom.value = true\n  } else if (scrollHeight - scrollTop - clientHeight > 100) {\n    // If user clearly scrolled up (more than 100px from bottom), stop auto-scrolling\n    shouldAutoScrollToBottom.value = false\n  }\n\n  console.log('[RightPanel] Scroll state check:', {\n    scrollTop,\n    scrollHeight,\n    clientHeight,\n    isAtBottom,\n    hasScrollableContent,\n    showButton: showScrollToBottomButton.value,\n    shouldAutoScroll: shouldAutoScrollToBottom.value,\n  })\n}\n\nconst scrollToBottom = () => {\n  if (!scrollContainer.value) return\n\n  scrollContainer.value.scrollTo({\n    top: scrollContainer.value.scrollHeight,\n    behavior: 'smooth',\n  })\n\n  // Reset state after scrolling\n  nextTick(() => {\n    shouldAutoScrollToBottom.value = true\n    checkScrollState()\n  })\n}\n\nconst autoScrollToBottomIfNeeded = () => {\n  if (!shouldAutoScrollToBottom.value || !scrollContainer.value) return\n\n  nextTick(() => {\n    if (scrollContainer.value) {\n      scrollContainer.value.scrollTop = scrollContainer.value.scrollHeight\n      console.log('[RightPanel] Auto scroll to bottom')\n    }\n  })\n}\n\n\n// Actions - Utility functions\nconst formatJson = (jsonData: any): string => {\n  if (jsonData === null || typeof jsonData === 'undefined' || jsonData === '') {\n    return 'N/A'\n  }\n  try {\n    const jsonObj = typeof jsonData === 'object' ? jsonData : JSON.parse(jsonData)\n    return JSON.stringify(jsonObj, null, 2)\n  } catch {\n    // If parsing fails, return string format directly (similar to _escapeHtml in right-sidebar.js)\n    return String(jsonData)\n  }\n}\n\n// Actions - Resource cleanup\nconst cleanup = () => {\n  selectedStep.value = null\n  shouldAutoScrollToBottom.value = true\n\n  if (scrollContainer.value) {\n    scrollContainer.value.removeEventListener('scroll', checkScrollState)\n  }\n}\n\n// Initialize scroll listener\nconst initScrollListener = () => {\n  const setupScrollListener = () => {\n    const element = scrollContainer.value\n    if (!element) {\n      console.log('[RightPanel] Scroll container not found, retrying...')\n      return false\n    }\n\n    // Set scroll container\n    setScrollContainer(element)\n\n    element.addEventListener('scroll', checkScrollState)\n    // Initial state check\n    shouldAutoScrollToBottom.value = true // Reset to auto scroll state\n    checkScrollState()\n    console.log('[RightPanel] Scroll listener initialized successfully')\n    return true\n  }\n\n  // Use nextTick to ensure DOM is updated\n  nextTick(() => {\n    if (!setupScrollListener()) {\n      // If first attempt fails, try again\n      setTimeout(() => {\n        setupScrollListener()\n      }, 100)\n    }\n  })\n}\n\n// Watch for currentRootPlanId changes to track execution history\nwatch(() => props.currentRootPlanId, (newPlanId, oldPlanId) => {\n  if (newPlanId && newPlanId !== oldPlanId) {\n    // A new plan has started executing\n    lastExecutedPlanId.value = newPlanId\n    hasExecutedAnyPlan.value = true\n    \n    // Persist to localStorage\n    localStorage.setItem('jmanus-last-plan-id', newPlanId)\n    localStorage.setItem('jmanus-has-executed-plan', 'true')\n    \n    console.log('[RightPanel] New plan started:', newPlanId)\n  } else if (!newPlanId && oldPlanId) {\n    // Plan execution finished, but keep the lastExecutedPlanId for file browser\n    console.log('[RightPanel] Plan execution finished, keeping last plan:', lastExecutedPlanId.value)\n  }\n}, { immediate: true })\n\n// Lifecycle - initialization on mount\nonMounted(() => {\n  console.log('[RightPanel] Component mounted')\n  // Use nextTick to ensure DOM is rendered\n  nextTick(() => {\n    initScrollListener()\n  })\n})\n\n// Lifecycle - cleanup on unmount\nonUnmounted(() => {\n  console.log('[RightPanel] Component unmounting, cleaning up...')\n  cleanup()\n})\n\n/**\n * Update displayed plan progress\n * This method is called when a plan is updated to refresh the display\n * @param rootPlanId - The root plan ID to update\n */\nconst updateDisplayedPlanProgress = (rootPlanId: string) => {\n  console.log('[RightPanel] updateDisplayedPlanProgress called with rootPlanId:', rootPlanId)\n  \n  // Update the last executed plan ID for file browser\n  if (rootPlanId) {\n    lastExecutedPlanId.value = rootPlanId\n    hasExecutedAnyPlan.value = true\n    \n    // Persist to localStorage\n    localStorage.setItem('jmanus-last-plan-id', rootPlanId)\n    localStorage.setItem('jmanus-has-executed-plan', 'true')\n    \n    console.log('[RightPanel] Plan progress updated:', rootPlanId)\n  }\n}\n\n// Expose methods to parent component - only keep necessary interfaces\ndefineExpose({\n  handleStepSelected,\n  refreshCurrentStep,\n  updateDisplayedPlanProgress,\n})\n</script>\n\n<style lang=\"less\" scoped>\n.right-panel {\n  width: 50%;\n  display: flex;\n  flex-direction: column;\n  height: 100%; /* Ensure it takes full height */\n  overflow: hidden; /* Prevent content from overflowing */\n}\n\n.preview-header {\n  padding: 20px 24px;\n  border-bottom: 1px solid #1a1a1a;\n  background: rgba(255, 255, 255, 0.02);\n\n  .tab-button {\n    padding: 8px 16px;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 6px;\n    background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);\n    border-color: #667eea;\n    color: #667eea;\n    cursor: default;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    font-size: 14px;\n  }\n}\n\n\n.preview-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Ensure flex items can shrink */\n  height: 100%; /* Ensure it takes full height */\n  overflow: hidden; /* Prevent content from overflowing */\n}\n\n/* Step details styles */\n.step-details {\n  flex: 1;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Ensure flex items can shrink */\n  height: 100%; /* Ensure it takes full height */\n}\n\n/* Step basic information */\n.step-info {\n  padding: 20px;\n  margin: 0 20px;\n  background: rgba(41, 42, 45, 0.8);\n  border-radius: 8px;\n  margin-bottom: 16px;\n  min-height: 100px; /* Ensure minimum height */\n\n  h3 {\n    color: #ffffff;\n    margin: 0 0 16px 0;\n    font-size: 18px;\n    font-weight: 600;\n    padding-bottom: 8px;\n    border-bottom: 2px solid #667eea;\n  }\n}\n\n.step-details-scroll-container {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 0 20px 20px;\n  margin: 0 20px 20px;\n  background: rgba(255, 255, 255, 0.01);\n  border-radius: 8px;\n  min-height: 200px; /* Ensure minimum height */\n\n  /* Custom scrollbar styles */\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: rgba(255, 255, 255, 0.1);\n    border-radius: 3px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: rgba(255, 255, 255, 0.3);\n    border-radius: 3px;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.5);\n    }\n  }\n}\n\n/* Step information styles - for fixed top */\n.agent-info {\n  margin-bottom: 16px;\n\n  .info-item {\n    display: flex;\n    margin-bottom: 8px;\n    font-size: 14px;\n    line-height: 1.4;\n\n    .label {\n      min-width: 100px;\n      font-weight: 600;\n      color: #888888;\n      flex-shrink: 0;\n    }\n\n    .value {\n      flex: 1;\n      color: #cccccc;\n      word-break: break-word;\n\n      &.success {\n        color: #27ae60;\n      }\n    }\n  }\n}\n\n.execution-status {\n  margin-top: 16px;\n  padding-top: 16px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n\n  .status-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n\n    .status-icon {\n      font-size: 16px;\n\n      &.success {\n        color: #27ae60;\n      }\n\n      &.progress {\n        color: #3498db;\n      }\n\n      &.pending {\n        color: #f39c12;\n      }\n    }\n\n    .status-text {\n      color: #cccccc;\n      font-weight: 500;\n    }\n  }\n}\n\n.no-steps-message {\n  text-align: center;\n  color: #666666;\n  font-style: italic;\n  margin-top: 16px;\n\n  p {\n    margin: 0;\n  }\n}\n\n.no-execution-message {\n  padding: 20px;\n  background: #f8f9fa;\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n  margin-top: 16px;\n\n  .info-icon {\n    color: #6c757d;\n    font-size: 20px;\n    margin-bottom: 8px;\n  }\n\n  h4 {\n    margin: 0 0 16px 0;\n    color: #495057;\n    font-size: 16px;\n    font-weight: 500;\n  }\n\n  .step-basic-info {\n    .info-item {\n      display: flex;\n      margin-bottom: 8px;\n      font-size: 14px;\n\n      .label {\n        font-weight: 500;\n        color: #6c757d;\n        min-width: 80px;\n        margin-right: 8px;\n      }\n\n      .value {\n        color: #333;\n        flex: 1;\n\n        &.status-completed {\n          color: #28a745;\n          font-weight: 500;\n        }\n\n        &.status-current {\n          color: #007bff;\n          font-weight: 500;\n        }\n\n        &.status-pending {\n          color: #6c757d;\n        }\n      }\n    }\n  }\n\n  .no-execution-hint {\n    margin: 16px 0 0 0;\n    color: #6c757d;\n    font-style: italic;\n    font-size: 13px;\n    text-align: center;\n  }\n}\n\n.execution-indicator {\n  margin-top: 20px;\n  padding: 20px;\n  background: rgba(74, 144, 226, 0.1);\n  border: 1px solid rgba(74, 144, 226, 0.3);\n  border-radius: 8px;\n  text-align: center;\n  position: relative;\n  overflow: hidden;\n}\n\n.execution-waves {\n  position: relative;\n  height: 4px;\n  margin-bottom: 16px;\n  background: rgba(74, 144, 226, 0.2);\n  border-radius: 2px;\n  overflow: hidden;\n}\n\n.wave {\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(74, 144, 226, 0.6), transparent);\n  border-radius: 2px;\n}\n\n.wave-1 {\n  animation: wave-animation 2s ease-in-out infinite;\n}\n\n.wave-2 {\n  animation: wave-animation 2s ease-in-out infinite 0.6s;\n}\n\n.wave-3 {\n  animation: wave-animation 2s ease-in-out infinite 1.2s;\n}\n\n@keyframes wave-animation {\n  0% {\n    left: -100%;\n  }\n  50% {\n    left: 100%;\n  }\n  100% {\n    left: 100%;\n  }\n}\n\n.execution-text {\n  color: #4a90e2;\n  font-size: 14px;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n\n.rotating-icon {\n  animation: rotate-animation 1s linear infinite;\n}\n\n@keyframes rotate-animation {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.step-info {\n  h3 {\n    color: #ffffff;\n    margin: 0 0 20px 0;\n    font-size: 18px;\n    font-weight: 600;\n  }\n}\n\n.think-act-steps {\n  margin-top: 20px; /* Increase top spacing since there's no fixed header step info now */\n\n  h4 {\n    color: #ffffff;\n    margin: 0 0 16px 0;\n    font-size: 16px;\n    font-weight: 600;\n    padding-bottom: 8px;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n  }\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.think-act-step {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 16px;\n\n  .step-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 16px;\n\n    .step-number {\n      font-weight: 600;\n      color: #667eea;\n      font-size: 14px;\n    }\n\n    .step-status {\n      padding: 4px 8px;\n      border-radius: 4px;\n      font-size: 12px;\n      font-weight: 500;\n\n      &.completed {\n        background: rgba(39, 174, 96, 0.2);\n        color: #27ae60;\n      }\n\n      &.running {\n        background: rgba(52, 152, 219, 0.2);\n        color: #3498db;\n      }\n\n      &.pending {\n        background: rgba(243, 156, 18, 0.2);\n        color: #f39c12;\n      }\n    }\n  }\n\n  .think-section,\n  .action-section,\n  .sub-plan-section {\n    margin-bottom: 16px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n\n    h5 {\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      margin: 0 0 12px 0;\n      font-size: 14px;\n      font-weight: 600;\n      color: #ffffff;\n    }\n  }\n\n  .think-content,\n  .action-content {\n    .input,\n    .output,\n    .tool-info {\n      margin-bottom: 12px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      .label {\n        display: block;\n        font-weight: 600;\n        color: #888888;\n        margin-bottom: 4px;\n        font-size: 12px;\n      }\n\n      .value {\n        color: #cccccc;\n        font-size: 14px;\n      }\n\n      pre {\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 4px;\n        padding: 12px;\n        color: #cccccc;\n        font-size: 12px;\n        overflow-x: auto;\n        white-space: pre-wrap;\n        margin: 0;\n        line-height: 1.4;\n        max-height: 200px;\n        overflow-y: auto;\n      }\n    }\n  }\n\n  /* Sub plan styles */\n  .sub-plan-content {\n    .sub-plan-header {\n      background: rgba(102, 126, 234, 0.1);\n      border: 1px solid rgba(102, 126, 234, 0.3);\n      border-radius: 6px;\n      padding: 12px;\n      margin-bottom: 12px;\n\n      .sub-plan-info {\n        display: flex;\n        margin-bottom: 8px;\n        font-size: 12px;\n\n        &:last-child {\n          margin-bottom: 0;\n        }\n\n        .label {\n          min-width: 80px;\n          font-weight: 600;\n          color: #888888;\n          flex-shrink: 0;\n        }\n\n        .value {\n          flex: 1;\n          color: #cccccc;\n          word-break: break-word;\n        }\n      }\n\n      .sub-plan-status {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        padding-top: 8px;\n        border-top: 1px solid rgba(255, 255, 255, 0.1);\n\n        .status-icon {\n          font-size: 14px;\n\n          &.success {\n            color: #27ae60;\n          }\n\n          &.progress {\n            color: #3498db;\n          }\n        }\n\n        .status-text {\n          color: #cccccc;\n          font-size: 12px;\n          font-weight: 500;\n        }\n      }\n    }\n  }\n}\n\n.no-selection {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #666666;\n\n  .empty-icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n    color: #444444;\n  }\n\n  h3 {\n    margin: 0 0 8px 0;\n    font-size: 18px;\n    color: #888888;\n  }\n\n  p {\n    margin: 0;\n    font-size: 14px;\n    text-align: center;\n    max-width: 300px;\n    line-height: 1.5;\n  }\n}\n\n/* Scroll to bottom button */\n.scroll-to-bottom-btn {\n  position: fixed;\n  bottom: 40px;\n  right: 40px;\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: rgba(74, 144, 226, 0.9);\n  border: none;\n  color: white;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 18px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  transition: all 0.3s ease;\n  z-index: 100;\n\n  &:hover {\n    background: rgba(74, 144, 226, 1);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n}\n\n/* Scroll button transition animation */\n.scroll-button-enter-active,\n.scroll-button-leave-active {\n  transition: all 0.3s ease;\n}\n\n.scroll-button-enter-from,\n.scroll-button-leave-to {\n  opacity: 0;\n  transform: translateY(20px) scale(0.8);\n}\n\n/* File Browser Container */\n.file-browser-container {\n  height: 100%;\n  padding: 0;\n  overflow: hidden;\n}\n\n.no-plan-message {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: rgba(255, 255, 255, 0.6);\n  gap: 24px;\n  padding: 40px 20px;\n  text-align: center;\n}\n\n.no-plan-message > .iconify {\n  font-size: 64px;\n  color: rgba(255, 255, 255, 0.3);\n}\n\n.message-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n  max-width: 300px;\n}\n\n.message-content h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.message-content p {\n  margin: 0;\n  font-size: 14px;\n  line-height: 1.5;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.tips {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(103, 126, 234, 0.1);\n  border: 1px solid rgba(103, 126, 234, 0.2);\n  border-radius: 8px;\n  font-size: 12px;\n  color: rgba(103, 126, 234, 0.9);\n}\n\n.tips .iconify {\n  font-size: 14px;\n  flex-shrink: 0;\n}\n\n/* Tab styles */\n.preview-tabs {\n  display: flex;\n  gap: 0;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 4px;\n}\n\n.tab-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 16px;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 13px;\n  font-weight: 500;\n  min-width: 0;\n  flex: 1;\n  justify-content: center;\n  position: relative;\n}\n\n.tab-item:hover {\n  background: rgba(255, 255, 255, 0.08);\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.tab-item.active {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: #ffffff;\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.tab-item .iconify {\n  font-size: 16px;\n  flex-shrink: 0;\n}\n\n.tab-item span {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { computed } from 'vue'\nimport type { ChatMessage } from './useChatMessages'\n\n/**\n * Message formatting utilities\n */\nexport function useMessageFormatting() {\n  \n  /**\n   * Format response text with markdown and code highlighting\n   */\n  const formatResponseText = (text: string): string => {\n    if (!text) return ''\n    \n    return text\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n      .replace(/`([^`]+)`/g, '<code>$1</code>')\n      .replace(/\\n/g, '<br>')\n      .replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>')\n  }\n\n  /**\n   * Format timestamp for display\n   */\n  const formatTimestamp = (timestamp: Date): string => {\n    const now = new Date()\n    const diff = now.getTime() - timestamp.getTime()\n    \n    // Less than 1 minute\n    if (diff < 60000) {\n      return 'Just now'\n    }\n    \n    // Less than 1 hour\n    if (diff < 3600000) {\n      const minutes = Math.floor(diff / 60000)\n      return `${minutes} minutes ago`\n    }\n    \n    // Less than 1 day\n    if (diff < 86400000) {\n      const hours = Math.floor(diff / 3600000)\n      return `${hours} hours ago`\n    }\n    \n    // More than 1 day\n    return timestamp.toLocaleDateString('zh-CN', {\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    })\n  }\n\n  /**\n   * Get message CSS classes\n   */\n  const getMessageClasses = (message: ChatMessage) => {\n    return computed(() => ({\n      user: message.type === 'user',\n      assistant: message.type === 'assistant',\n      streaming: message.isStreaming,\n      'has-error': !!message.error,\n      'has-thinking': !!message.thinking,\n      'has-execution': !!message.planExecution\n    }))\n  }\n\n  /**\n   * Format file size for attachments\n   */\n  const formatFileSize = (bytes: number): string => {\n    if (bytes === 0) return '0 B'\n    \n    const k = 1024\n    const sizes = ['B', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    \n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n  }\n\n  /**\n   * Truncate long text with ellipsis\n   */\n  const truncateText = (text: string, maxLength: number = 100): string => {\n    if (!text || text.length <= maxLength) return text\n    return text.substring(0, maxLength) + '...'\n  }\n\n  /**\n   * Extract plain text from HTML\n   */\n  const stripHtml = (html: string): string => {\n    return html.replace(/<[^>]*>/g, '')\n  }\n\n  /**\n   * Check if message has content to display\n   */\n  const hasDisplayableContent = (message: ChatMessage): boolean => {\n    return !!(\n      message.content ||\n      (message.thinking ?? false) ||\n      (message.planExecution ?? false) ||\n      message.error\n    )\n  }\n\n  /**\n   * Get message status text\n   */\n  const getMessageStatus = (message: ChatMessage): string => {\n    if (message.error) return 'Send failed'\n    if (message.isStreaming) return 'Typing...'\n    if (message.type === 'assistant' && !message.content && !message.thinking) return 'Waiting for response'\n    return ''\n  }\n\n  return {\n    formatResponseText,\n    formatTimestamp,\n    getMessageClasses,\n    formatFileSize,\n    truncateText,\n    stripHtml,\n    hasDisplayableContent,\n    getMessageStatus\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"user-message\" :data-message-id=\"message.id\">\n    <div class=\"user-content\">\n      <div class=\"message-text\">\n        {{ message.content }}\n      </div>\n      \n      <!-- Attachments if any -->\n      <div v-if=\"message.attachments?.length\" class=\"attachments\">\n        <div\n          v-for=\"(attachment, index) in message.attachments\"\n          :key=\"index\"\n          class=\"attachment-item\"\n        >\n          <Icon icon=\"carbon:document\" class=\"attachment-icon\" />\n          <span class=\"attachment-name\">{{ attachment.name }}</span>\n          <span class=\"attachment-size\">{{ formatFileSize(attachment.size) }}</span>\n        </div>\n      </div>\n      \n      <!-- Timestamp -->\n      <div class=\"message-timestamp\">\n        {{ formatTimestamp(message.timestamp) }}\n      </div>\n    </div>\n    \n    <!-- Message status indicator -->\n    <div v-if=\"message.error\" class=\"message-status error\">\n      <Icon icon=\"carbon:warning\" class=\"status-icon\" />\n      <span class=\"status-text\">{{ message.error }}</span>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\nimport type { ChatMessage } from './composables/useChatMessages'\n\ninterface Props {\n  message: ChatMessage\n}\n\ndefineProps<Props>()\n\nconst { formatTimestamp, formatFileSize } = useMessageFormatting()\n</script>\n\n<style lang=\"less\" scoped>\n.user-message {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  margin-bottom: 16px;\n  \n  .user-content {\n    max-width: 70%;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #ffffff;\n    padding: 12px 16px;\n    border-radius: 18px 18px 4px 18px;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n    position: relative;\n    \n    .message-text {\n      word-wrap: break-word;\n      white-space: pre-wrap;\n      line-height: 1.5;\n      font-size: 14px;\n    }\n    \n    .attachments {\n      margin-top: 8px;\n      \n      .attachment-item {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        padding: 6px 8px;\n        background: rgba(255, 255, 255, 0.1);\n        border-radius: 8px;\n        margin-bottom: 4px;\n        font-size: 12px;\n        \n        &:last-child {\n          margin-bottom: 0;\n        }\n        \n        .attachment-icon {\n          font-size: 14px;\n          color: rgba(255, 255, 255, 0.8);\n        }\n        \n        .attachment-name {\n          flex: 1;\n          color: #ffffff;\n        }\n        \n        .attachment-size {\n          color: rgba(255, 255, 255, 0.7);\n          font-size: 11px;\n        }\n      }\n    }\n    \n    .message-timestamp {\n      margin-top: 6px;\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.7);\n      text-align: right;\n    }\n  }\n  \n  .message-status {\n    margin-top: 4px;\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    font-size: 12px;\n    \n    &.error {\n      color: #ff6b6b;\n      \n      .status-icon {\n        font-size: 14px;\n      }\n    }\n  }\n}\n\n@media (max-width: 768px) {\n  .user-message {\n    .user-content {\n      max-width: 85%;\n      padding: 10px 14px;\n      border-radius: 16px 16px 4px 16px;\n      \n      .message-text {\n        font-size: 13px;\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"recursive-sub-plan\" :class=\"getNestingClass()\">\n    <!-- Sub-plan header -->\n    <div class=\"sub-plan-header\" @click=\"handleSubPlanClick\">\n      <div class=\"sub-plan-info\">\n        <Icon :icon=\"getSubPlanStatusIcon()\" class=\"sub-plan-status-icon\" />\n        <div class=\"sub-plan-details\">\n          <div class=\"sub-plan-title\">\n            {{ subPlan.title || $t('chat.subPlan') }} #{{ subPlanIndex + 1 }}\n            <span v-if=\"(nestingLevel ?? 0) > 0\" class=\"nesting-level\">(L{{ (nestingLevel ?? 0) + 1 }})</span>\n          </div>\n          <div class=\"sub-plan-id\">{{ subPlan.currentPlanId }}</div>\n        </div>\n      </div>\n      <div class=\"sub-plan-meta\">\n        <div class=\"sub-plan-status-badge\" :class=\"getSubPlanStatusClass()\">\n          {{ getSubPlanStatusText() }}\n        </div>\n        <div v-if=\"subPlan.parentActToolCall\" class=\"trigger-tool\">\n          <Icon icon=\"carbon:function\" class=\"trigger-icon\" />\n          <span class=\"trigger-text\">{{ subPlan.parentActToolCall.name }}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sub-plan progress -->\n    <div v-if=\"subPlan.agentExecutionSequence?.length\" class=\"sub-plan-progress\">\n      <div class=\"progress-info\">\n        <span class=\"progress-text\">\n          {{ $t('chat.progress') }}: {{ getSubPlanCompletedCount() }} / {{ subPlan.agentExecutionSequence.length }}\n        </span>\n        <div class=\"progress-bar\">\n          <div \n            class=\"progress-fill\" \n            :style=\"{ width: getSubPlanProgress() + '%' }\"\n          ></div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sub-plan agent execution steps -->\n    <div v-if=\"subPlan.agentExecutionSequence?.length\" class=\"sub-plan-agents-steps\">\n      <div class=\"agents-steps-header\">\n        <span class=\"agents-label\">{{ $t('chat.agentExecutions') }}:</span>\n      </div>\n      <div class=\"agents-steps-list\">\n        <div\n          v-for=\"(agent, agentIndex) in subPlan.agentExecutionSequence\"\n          :key=\"agent.id || agentIndex\"\n          class=\"agent-step-item\"\n          :class=\"getAgentPreviewStatusClass(agent.status)\"\n          @click=\"handleSubPlanAgentClick(agentIndex, agent)\"\n        >\n          <div class=\"agent-step-header\">\n            <Icon :icon=\"getAgentPreviewStatusIcon(agent.status)\" class=\"agent-icon\" />\n            <span class=\"agent-name\">{{ agent.agentName || $t('chat.unknownAgent') }}</span>\n            <div class=\"agent-status-badge\" :class=\"getAgentPreviewStatusClass(agent.status)\">\n              {{ getAgentStatusText(agent.status) }}\n            </div>\n          </div>\n          \n          <!-- Agent execution info for sub-plan agents -->\n          <div class=\"sub-agent-execution-info\">\n            <!-- Agent result -->\n            <div v-if=\"agent.result\" class=\"agent-result\">\n              <div class=\"result-header\">\n                <Icon icon=\"carbon:checkmark\" class=\"result-icon\" />\n                <span class=\"result-label\">{{ $t('chat.agentResult') }}:</span>\n              </div>\n              <pre class=\"result-content\">{{ agent.result }}</pre>\n            </div>\n\n            <!-- Error message -->\n            <div v-if=\"agent.errorMessage\" class=\"agent-error\">\n              <div class=\"error-header\">\n                <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n                <span class=\"error-label\">{{ $t('chat.errorMessage') }}:</span>\n              </div>\n              <pre class=\"error-content\">{{ agent.errorMessage }}</pre>\n            </div>\n\n            <!-- Think-act steps with nested sub-plans -->\n            <div v-if=\"agent.thinkActSteps?.length\" class=\"think-act-preview\">\n              <div class=\"think-act-header\">\n                <Icon icon=\"carbon:thinking\" class=\"think-act-icon\" />\n                <span class=\"think-act-label\">{{ $t('chat.thinkActSteps') }} ({{ agent.thinkActSteps.length }})</span>\n              </div>\n              <div class=\"think-act-steps-preview\">\n                <div\n                  v-for=\"(step, stepIndex) in agent.thinkActSteps.slice(0, maxVisibleSteps ?? 2)\"\n                  :key=\"step.id || stepIndex\"\n                  class=\"think-act-step-preview\"\n                  @click.stop=\"handleThinkActStepClick(agentIndex, stepIndex, agent)\"\n                >\n                  <span class=\"step-number\">#{{ stepIndex + 1 }}</span>\n                  <span class=\"step-description\">{{ step.actionDescription || $t('chat.thinking') }}</span>\n                  <Icon icon=\"carbon:arrow-right\" class=\"step-arrow\" />\n                </div>\n                <div v-if=\"agent.thinkActSteps.length > (maxVisibleSteps ?? 2)\" class=\"more-steps\">\n                  <span class=\"more-steps-text\">\n                    {{ $t('chat.andMoreSteps', { count: agent.thinkActSteps.length - (maxVisibleSteps ?? 2) }) }}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <!-- Nested sub-plans from think-act steps -->\n            <div v-if=\"hasNestedSubPlans(agent)\" class=\"nested-sub-plans\">\n              <div class=\"nested-sub-plans-header\">\n                <Icon icon=\"carbon:tree-view-alt\" class=\"nested-icon\" />\n                <span class=\"nested-label\">{{ $t('chat.nestedSubPlans') }}</span>\n              </div>\n              <div class=\"nested-sub-plans-list\">\n                <RecursiveSubPlan\n                  v-for=\"(nestedStep, nestedStepIndex) in getNestedSubPlans(agent)\"\n                  :key=\"nestedStep.id || nestedStepIndex\"\n                  :sub-plan=\"nestedStep.subPlanExecutionRecord!\"\n                  :sub-plan-index=\"nestedStepIndex\"\n                  :nesting-level=\"(nestingLevel ?? 0) + 1\"\n                  :max-nesting-depth=\"maxNestingDepth ?? 3\"\n                  :max-visible-steps=\"maxVisibleSteps ?? 2\"\n                  @sub-plan-selected=\"handleNestedSubPlanSelected\"\n                  @step-selected=\"handleNestedStepSelected\"\n                />\n              </div>\n            </div>\n\n            <!-- Direct sub-plans from agent -->\n            <div v-if=\"agent.subPlanExecutionRecords?.length\" class=\"direct-sub-plans\">\n              <div class=\"direct-sub-plans-header\">\n                <Icon icon=\"carbon:tree-view\" class=\"direct-icon\" />\n                <span class=\"direct-label\">{{ $t('chat.directSubPlans') }}</span>\n              </div>\n              <div class=\"direct-sub-plans-list\">\n                <RecursiveSubPlan\n                  v-for=\"(directSubPlan, directIndex) in agent.subPlanExecutionRecords\"\n                  :key=\"directSubPlan.currentPlanId || directIndex\"\n                  :sub-plan=\"directSubPlan\"\n                  :sub-plan-index=\"directIndex\"\n                  :nesting-level=\"(nestingLevel ?? 0) + 1\"\n                  :max-nesting-depth=\"maxNestingDepth ?? 3\"\n                  :max-visible-steps=\"maxVisibleSteps ?? 2\"\n                  @sub-plan-selected=\"handleNestedSubPlanSelected\"\n                  @step-selected=\"handleNestedStepSelected\"\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord, ExecutionStatus, ThinkActRecord } from '@/types/plan-execution-record'\n\ninterface Props {\n  subPlan: PlanExecutionRecord\n  subPlanIndex: number\n  nestingLevel?: number\n  maxNestingDepth?: number\n  maxVisibleSteps?: number\n}\n\ninterface Emits {\n  (e: 'sub-plan-selected', agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  nestingLevel: 0,\n  maxNestingDepth: 3,\n  maxVisibleSteps: 2\n})\n\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nconst { t } = useI18n()\n\n// Helper functions\nconst getNestingClass = (): string => {\n  return `nesting-level-${props.nestingLevel}`\n}\n\n// Sub-plan status methods\nconst getSubPlanStatusClass = (): string => {\n  if (props.subPlan.completed) {\n    return 'completed'\n  }\n  \n  const hasRunningAgent = props.subPlan.agentExecutionSequence?.some(agent => agent.status === 'RUNNING')\n  if (hasRunningAgent) {\n    return 'running'\n  }\n  \n  const hasFinishedAgent = props.subPlan.agentExecutionSequence?.some(agent => agent.status === 'FINISHED')\n  if (hasFinishedAgent) {\n    return 'in-progress'\n  }\n  \n  return 'pending'\n}\n\nconst getSubPlanStatusText = (): string => {\n  const statusClass = getSubPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return t('chat.status.completed')\n    case 'running':\n      return t('chat.status.executing')\n    case 'in-progress':\n      return t('chat.status.inProgress')\n    case 'pending':\n      return t('chat.status.pending')\n    default:\n      return t('chat.status.unknown')\n  }\n}\n\nconst getSubPlanStatusIcon = (): string => {\n  const statusClass = getSubPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return 'carbon:checkmark'\n    case 'running':\n      return 'carbon:play'\n    case 'in-progress':\n      return 'carbon:in-progress'\n    case 'pending':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\nconst getSubPlanProgress = (): number => {\n  if (!props.subPlan.agentExecutionSequence?.length) return 0\n  if (props.subPlan.completed) return 100\n  \n  const completedCount = getSubPlanCompletedCount()\n  return Math.min(100, (completedCount / props.subPlan.agentExecutionSequence.length) * 100)\n}\n\nconst getSubPlanCompletedCount = (): number => {\n  if (!props.subPlan.agentExecutionSequence?.length) return 0\n  return props.subPlan.agentExecutionSequence.filter(agent => agent.status === 'FINISHED').length\n}\n\n// Agent preview status methods\nconst getAgentPreviewStatusClass = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'FINISHED':\n      return 'completed'\n    case 'RUNNING':\n      return 'running'\n    case 'IDLE':\n    default:\n      return 'pending'\n  }\n}\n\nconst getAgentPreviewStatusIcon = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'FINISHED':\n      return 'carbon:checkmark'\n    case 'RUNNING':\n      return 'carbon:play'\n    case 'IDLE':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\nconst getAgentStatusText = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return t('chat.status.executing')\n    case 'FINISHED':\n      return t('chat.status.completed')\n    case 'IDLE':\n    default:\n      return t('chat.status.pending')\n  }\n}\n\n// Nested sub-plans detection\nconst hasNestedSubPlans = (agent: AgentExecutionRecord): boolean => {\n  return agent.thinkActSteps?.some(step => step.subPlanExecutionRecord) ?? false\n}\n\nconst getNestedSubPlans = (agent: AgentExecutionRecord): ThinkActRecord[] => {\n  return agent.thinkActSteps?.filter(step => step.subPlanExecutionRecord) ?? []\n}\n\n// Event handlers\nconst handleSubPlanClick = () => {\n  emit('sub-plan-selected', -1, props.subPlanIndex, props.subPlan)\n}\n\nconst handleSubPlanAgentClick = (agentIndex: number, agent: AgentExecutionRecord) => {\n  const stepId = agent.stepId ?? `subplan-${props.subPlanIndex}-agent-${agentIndex}`\n  emit('step-selected', stepId)\n}\n\nconst handleThinkActStepClick = (agentIndex: number, _stepIndex: number, agent: AgentExecutionRecord) => {\n  const stepId = agent.stepId ?? `subplan-${props.subPlanIndex}-agent-${agentIndex}`\n  emit('step-selected', stepId)\n}\n\nconst handleNestedSubPlanSelected = (agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleNestedStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.recursive-sub-plan {\n  background: rgba(102, 126, 234, 0.05);\n  border: 1px solid rgba(102, 126, 234, 0.1);\n  border-radius: 6px;\n  padding: 12px;\n  margin-bottom: 8px;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(102, 126, 234, 0.1);\n    border-color: rgba(102, 126, 234, 0.2);\n  }\n\n  &.running {\n    border-color: rgba(102, 126, 234, 0.3);\n    background: rgba(102, 126, 234, 0.08);\n    box-shadow: 0 0 8px rgba(102, 126, 234, 0.15);\n  }\n\n  &.completed {\n    border-color: rgba(34, 197, 94, 0.3);\n    background: rgba(34, 197, 94, 0.05);\n  }\n\n  &.pending {\n    opacity: 0.7;\n  }\n\n  // Nesting level styles\n  &.nesting-level-1 {\n    margin-left: 16px;\n    border-left: 3px solid rgba(102, 126, 234, 0.3);\n  }\n\n  &.nesting-level-2 {\n    margin-left: 32px;\n    border-left: 3px solid rgba(251, 191, 36, 0.3);\n  }\n\n  &.nesting-level-3 {\n    margin-left: 48px;\n    border-left: 3px solid rgba(34, 197, 94, 0.3);\n  }\n\n  .sub-plan-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 8px;\n    cursor: pointer;\n\n    .sub-plan-info {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      flex: 1;\n\n      .sub-plan-status-icon {\n        font-size: 16px;\n\n        &.completed {\n          color: #22c55e;\n        }\n\n        &.running {\n          color: #667eea;\n        }\n\n        &.in-progress {\n          color: #fbbf24;\n        }\n\n        &.pending {\n          color: #9ca3af;\n        }\n      }\n\n      .sub-plan-details {\n        .sub-plan-title {\n          font-weight: 600;\n          color: #ffffff;\n          font-size: 13px;\n          margin-bottom: 2px;\n          display: flex;\n          align-items: center;\n          gap: 6px;\n\n          .nesting-level {\n            color: #888888;\n            font-size: 10px;\n            font-weight: 400;\n            background: rgba(136, 136, 136, 0.2);\n            padding: 1px 4px;\n            border-radius: 3px;\n          }\n        }\n\n        .sub-plan-id {\n          color: #aaaaaa;\n          font-size: 11px;\n          font-family: monospace;\n        }\n      }\n    }\n\n    .sub-plan-meta {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n\n      .trigger-tool {\n        display: flex;\n        align-items: center;\n        gap: 4px;\n        padding: 2px 6px;\n        background: rgba(102, 126, 234, 0.1);\n        border-radius: 4px;\n        font-size: 10px;\n\n        .trigger-icon {\n          font-size: 10px;\n          color: #667eea;\n        }\n\n        .trigger-text {\n          color: #cccccc;\n          font-weight: 500;\n        }\n      }\n    }\n\n    .sub-plan-status-badge {\n      padding: 2px 6px;\n      border-radius: 8px;\n      font-size: 10px;\n      font-weight: 500;\n\n      &.completed {\n        background: rgba(34, 197, 94, 0.2);\n        color: #22c55e;\n      }\n\n      &.running {\n        background: rgba(102, 126, 234, 0.2);\n        color: #667eea;\n      }\n\n      &.in-progress {\n        background: rgba(251, 191, 36, 0.2);\n        color: #fbbf24;\n      }\n\n      &.pending {\n        background: rgba(156, 163, 175, 0.2);\n        color: #9ca3af;\n      }\n    }\n  }\n\n  .sub-plan-progress {\n    margin-bottom: 8px;\n\n    .progress-info {\n      .progress-text {\n        color: #aaaaaa;\n        font-size: 10px;\n        margin-bottom: 4px;\n      }\n\n      .progress-bar {\n        background: rgba(0, 0, 0, 0.2);\n        border-radius: 4px;\n        height: 4px;\n        overflow: hidden;\n\n        .progress-fill {\n          height: 100%;\n          background: linear-gradient(90deg, #667eea, #764ba2);\n          transition: width 0.3s ease;\n          border-radius: 4px;\n        }\n      }\n    }\n  }\n\n  .sub-plan-agents-steps {\n    .agents-steps-header {\n      color: #aaaaaa;\n      font-size: 11px;\n      margin-bottom: 6px;\n      font-weight: 500;\n    }\n\n    .agents-steps-list {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n\n      .agent-step-item {\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 6px;\n        padding: 8px;\n        background: rgba(0, 0, 0, 0.05);\n        cursor: pointer;\n        transition: all 0.2s;\n\n        &:hover {\n          background: rgba(0, 0, 0, 0.1);\n          border-color: rgba(255, 255, 255, 0.2);\n        }\n\n        &.completed {\n          border-color: rgba(34, 197, 94, 0.3);\n          background: rgba(34, 197, 94, 0.05);\n        }\n\n        &.running {\n          border-color: rgba(102, 126, 234, 0.3);\n          background: rgba(102, 126, 234, 0.08);\n        }\n\n        &.pending {\n          opacity: 0.7;\n        }\n\n        .agent-step-header {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 8px;\n\n          .agent-icon {\n            font-size: 14px;\n\n            &.completed {\n              color: #22c55e;\n            }\n\n            &.running {\n              color: #667eea;\n            }\n\n            &.pending {\n              color: #9ca3af;\n            }\n          }\n\n          .agent-name {\n            color: #ffffff;\n            font-size: 13px;\n            font-weight: 500;\n            flex: 1;\n          }\n\n          .agent-status-badge {\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-size: 10px;\n            font-weight: 500;\n\n            &.completed {\n              background: rgba(34, 197, 94, 0.2);\n              color: #22c55e;\n            }\n\n            &.running {\n              background: rgba(102, 126, 234, 0.2);\n              color: #667eea;\n            }\n\n            &.pending {\n              background: rgba(156, 163, 175, 0.2);\n              color: #9ca3af;\n            }\n          }\n        }\n\n        .sub-agent-execution-info {\n          margin-left: 22px;\n\n          .agent-result, .agent-error {\n            margin-bottom: 8px;\n\n            &:last-child {\n              margin-bottom: 0;\n            }\n\n            .result-header, .error-header {\n              display: flex;\n              align-items: center;\n              gap: 4px;\n              margin-bottom: 4px;\n\n              .result-icon, .error-icon {\n                font-size: 12px;\n              }\n\n              .result-icon {\n                color: #22c55e;\n              }\n\n              .error-icon {\n                color: #ef4444;\n              }\n\n              .result-label, .error-label {\n                color: #ffffff;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .result-content, .error-content {\n              margin: 0;\n              padding: 6px;\n              background: rgba(0, 0, 0, 0.2);\n              border-radius: 3px;\n              font-family: monospace;\n              font-size: 10px;\n              white-space: pre-wrap;\n              max-height: 80px;\n              overflow-y: auto;\n              color: #cccccc;\n              line-height: 1.3;\n            }\n          }\n\n          .think-act-preview {\n            margin-top: 8px;\n\n            .think-act-header {\n              display: flex;\n              align-items: center;\n              gap: 4px;\n              margin-bottom: 6px;\n\n              .think-act-icon {\n                font-size: 12px;\n                color: #667eea;\n              }\n\n              .think-act-label {\n                color: #aaaaaa;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .think-act-steps-preview {\n              display: flex;\n              flex-direction: column;\n              gap: 3px;\n\n              .think-act-step-preview {\n                display: flex;\n                align-items: center;\n                gap: 6px;\n                padding: 4px 6px;\n                background: rgba(0, 0, 0, 0.1);\n                border-radius: 3px;\n                cursor: pointer;\n                transition: all 0.2s;\n                font-size: 10px;\n\n                &:hover {\n                  background: rgba(0, 0, 0, 0.2);\n                }\n\n                .step-number {\n                  color: #667eea;\n                  font-weight: 500;\n                  min-width: 20px;\n                }\n\n                .step-description {\n                  color: #cccccc;\n                  flex: 1;\n                  white-space: nowrap;\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                }\n\n                .step-arrow {\n                  font-size: 10px;\n                  color: #888888;\n                }\n              }\n\n              .more-steps {\n                padding: 2px 6px;\n                color: #888888;\n                font-size: 9px;\n                font-style: italic;\n              }\n            }\n          }\n\n          .nested-sub-plans, .direct-sub-plans {\n            margin-top: 12px;\n\n            .nested-sub-plans-header, .direct-sub-plans-header {\n              display: flex;\n              align-items: center;\n              gap: 6px;\n              margin-bottom: 8px;\n\n              .nested-icon, .direct-icon {\n                font-size: 12px;\n                color: #fbbf24;\n              }\n\n              .nested-label, .direct-label {\n                color: #aaaaaa;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .nested-sub-plans-list, .direct-sub-plans-list {\n              display: flex;\n              flex-direction: column;\n              gap: 6px;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"execution-details\">\n    <!-- Plan overview -->\n    <div class=\"plan-overview\" v-if=\"planExecution\">\n      <div class=\"plan-header\">\n        <h3 class=\"plan-title\">{{ planExecution.title || $t('chat.planExecution') }}</h3>\n        <div class=\"plan-status-badge\" :class=\"getPlanStatusClass()\">\n          {{ getPlanStatusText() }}\n        </div>\n      </div>\n      \n      <!-- Parent tool call information for sub-plans -->\n      <div v-if=\"planExecution.parentActToolCall\" class=\"parent-tool-call\">\n        <div class=\"parent-tool-header\">\n          <Icon icon=\"carbon:flow\" class=\"tool-icon\" />\n          <span class=\"tool-label\">{{ $t('chat.triggeredByTool') }}:</span>\n          <span class=\"tool-name\">{{ planExecution.parentActToolCall.name }}</span>\n        </div>\n        <div v-if=\"planExecution.parentActToolCall.parameters\" class=\"tool-parameters\">\n          <span class=\"param-label\">{{ $t('common.parameters') }}:</span>\n          <pre class=\"param-content\">{{ formatToolParameters(planExecution.parentActToolCall.parameters) }}</pre>\n        </div>\n      </div>\n    </div>\n\n    <!-- Agent execution sequence -->\n    <div class=\"agent-execution-container\" v-if=\"(planExecution?.agentExecutionSequence?.length ?? 0) > 0\">\n      <h4 class=\"section-title\">{{ $t('chat.agentExecutionSequence') }}</h4>\n      \n      <div\n        v-for=\"(agentExecution, agentIndex) in planExecution?.agentExecutionSequence\"\n        :key=\"agentExecution.id || agentIndex\"\n        class=\"agent-execution-item\"\n        :class=\"getAgentStatusClass(agentExecution.status)\"\n      >\n        <!-- Agent execution header -->\n        <div class=\"agent-header\" @click=\"handleAgentClick(agentExecution)\">\n          <div class=\"agent-info\">\n            <Icon :icon=\"getAgentStatusIcon(agentExecution.status)\" class=\"agent-status-icon\" />\n            <div class=\"agent-details\">\n              <div class=\"agent-name\">{{ agentExecution.agentName || $t('chat.unknownAgent') }}</div>\n              <pre class=\"request-content\">{{ agentExecution.agentRequest }}</pre>\n            </div>\n          </div>\n          <div class=\"agent-controls\">\n            <div class=\"agent-status-badge\" :class=\"getAgentStatusClass(agentExecution.status)\">\n              {{ getAgentStatusText(agentExecution.status) }}\n            </div>\n            <Icon icon=\"carbon:arrow-right\" class=\"step-select-icon\" />\n          </div>\n        </div>\n\n        <!-- Agent execution info -->\n        <div class=\"agent-execution-info\">\n          <!-- Agent result -->\n          <div v-if=\"agentExecution.result\" class=\"agent-result\">\n            <div class=\"result-header\">\n              <Icon icon=\"carbon:checkmark\" class=\"result-icon\" />\n              <span class=\"result-label\">{{ $t('chat.agentResult') }}:</span>\n            </div>\n            <pre class=\"result-content\">{{ agentExecution.result }}</pre>\n          </div>\n\n          <!-- Error message -->\n          <div v-if=\"agentExecution.errorMessage\" class=\"agent-error\">\n            <div class=\"error-header\">\n              <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n              <span class=\"error-label\">{{ $t('chat.errorMessage') }}:</span>\n            </div>\n            <pre class=\"error-content\">{{ agentExecution.errorMessage }}</pre>\n          </div>\n        </div>\n\n        <!-- Sub-plan executions with nested support -->\n        <div v-if=\"agentExecution.subPlanExecutionRecords?.length\" class=\"sub-plans-container\">\n          <div class=\"sub-plans-header\">\n            <Icon icon=\"carbon:tree-view\" class=\"sub-plans-icon\" />\n            <span class=\"sub-plans-title\">\n              {{ $t('chat.subPlanExecutions') }} ({{ agentExecution.subPlanExecutionRecords.length }})\n            </span>\n          </div>\n          \n          <div class=\"sub-plans-list\">\n            <RecursiveSubPlan\n              v-for=\"(subPlan, subPlanIndex) in agentExecution.subPlanExecutionRecords\"\n              :key=\"subPlan.currentPlanId || subPlanIndex\"\n              :sub-plan=\"subPlan\"\n              :sub-plan-index=\"subPlanIndex\"\n              :nesting-level=\"0\"\n              :max-nesting-depth=\"3\"\n              :max-visible-steps=\"2\"\n              @sub-plan-selected=\"handleSubPlanClick\"\n              @step-selected=\"handleStepSelected\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </div>\n</template>\n  \n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord, ExecutionStatus } from '@/types/plan-execution-record'\nimport type { CompatiblePlanExecutionRecord } from './composables/useChatMessages'\nimport RecursiveSubPlan from './RecursiveSubPlan.vue'\n\ninterface Props {\n  planExecution: CompatiblePlanExecutionRecord\n}\n\ninterface Emits {\n  (e: 'sub-plan-selected', agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nconst { t } = useI18n()\n\n// Computed properties\nconst agentExecutionSequence = computed(() => props.planExecution.agentExecutionSequence ?? [])\n\n// Agent click handler\nconst handleAgentClick = (agentExecution: AgentExecutionRecord) => {\n  if (agentExecution.stepId) {\n    emit('step-selected', agentExecution.stepId)\n  } else {\n    console.warn('[ExecutionDetails] Agent execution has no stepId:', agentExecution)\n  }\n}\n\n// Plan status methods\nconst getPlanStatusClass = (): string => {\n  if (props.planExecution.completed) {\n    return 'completed'\n  }\n  \n  const hasRunningAgent = agentExecutionSequence.value.some(agent => agent.status === 'RUNNING')\n  if (hasRunningAgent) {\n    return 'running'\n  }\n  \n  const hasFinishedAgent = agentExecutionSequence.value.some(agent => agent.status === 'FINISHED')\n  if (hasFinishedAgent) {\n    return 'in-progress'\n  }\n  \n  return 'pending'\n}\n\nconst getPlanStatusText = (): string => {\n  const statusClass = getPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return t('chat.status.completed')\n    case 'running':\n      return t('chat.status.executing')\n    case 'in-progress':\n      return t('chat.status.inProgress')\n    case 'pending':\n      return t('chat.status.pending')\n    default:\n      return t('chat.status.unknown')\n  }\n}\n\n// Agent status methods\nconst getAgentStatusClass = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return 'running'\n    case 'FINISHED':\n      return 'completed'\n    case 'IDLE':\n    default:\n      return 'pending'\n  }\n}\n\nconst getAgentStatusText = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return t('chat.status.executing')\n    case 'FINISHED':\n      return t('chat.status.completed')\n    case 'IDLE':\n    default:\n      return t('chat.status.pending')\n  }\n}\n\nconst getAgentStatusIcon = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return 'carbon:play'\n    case 'FINISHED':\n      return 'carbon:checkmark'\n    case 'IDLE':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\n// Note: Sub-plan status methods are now handled by RecursiveSubPlan component\n\n// Note: Agent preview status methods are now handled by RecursiveSubPlan component\n\n// Event handlers\nconst handleSubPlanClick = (agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n\n// Note: Sub-plan agent and think-act step handling is now done by RecursiveSubPlan component\n\n\n// Helper methods\n\nconst formatToolParameters = (parameters?: string): string => {\n  if (!parameters) return ''\n  \n  try {\n    const parsed = JSON.parse(parameters)\n    return JSON.stringify(parsed, null, 2)\n  } catch {\n    return parameters\n  }\n}\n\n\n\n</script>\n\n<style lang=\"less\" scoped>.execution-details {\n  // Plan overview\n  .plan-overview {\n    margin-bottom: 20px;\n    \n    .plan-header {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      margin-bottom: 12px;\n      \n      .plan-title {\n        margin: 0;\n        font-size: 16px;\n        font-weight: 600;\n        color: #ffffff;\n      }\n      \n      .plan-status-badge {\n        padding: 4px 12px;\n        border-radius: 12px;\n        font-size: 12px;\n        font-weight: 500;\n        \n        &.completed {\n          background: rgba(34, 197, 94, 0.2);\n          color: #22c55e;\n        }\n        \n        &.running {\n          background: rgba(102, 126, 234, 0.2);\n          color: #667eea;\n        }\n        \n        &.in-progress {\n          background: rgba(251, 191, 36, 0.2);\n          color: #fbbf24;\n        }\n        \n        &.pending {\n          background: rgba(156, 163, 175, 0.2);\n          color: #9ca3af;\n        }\n      }\n    }\n    \n    .parent-tool-call {\n      background: rgba(102, 126, 234, 0.1);\n      border: 1px solid rgba(102, 126, 234, 0.2);\n      border-radius: 8px;\n      padding: 12px;\n      \n      .parent-tool-header {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        margin-bottom: 8px;\n        \n        .tool-icon {\n          font-size: 16px;\n          color: #667eea;\n        }\n        \n        .tool-label {\n          color: #aaaaaa;\n          font-size: 13px;\n        }\n        \n        .tool-name {\n          color: #ffffff;\n          font-weight: 600;\n          font-size: 14px;\n        }\n      }\n      \n      .tool-parameters {\n        .param-label {\n          color: #aaaaaa;\n          font-size: 12px;\n          margin-bottom: 4px;\n          display: block;\n        }\n        \n        .param-content {\n          margin: 0;\n          padding: 8px;\n          background: rgba(0, 0, 0, 0.2);\n          border-radius: 4px;\n          font-family: monospace;\n          font-size: 11px;\n          color: #cccccc;\n          white-space: pre-wrap;\n          max-height: 120px;\n          overflow-y: auto;\n        }\n      }\n    }\n  }\n\n  // Agent execution container\n  .agent-execution-container {\n    .section-title {\n      margin: 0 0 16px 0;\n      font-size: 14px;\n      font-weight: 600;\n      color: #ffffff;\n      padding-bottom: 8px;\n      border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    }\n    \n    .agent-execution-item {\n      margin-bottom: 16px;\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 8px;\n      overflow: hidden;\n      transition: all 0.2s ease;\n      \n      &:last-child {\n        margin-bottom: 0;\n      }\n      \n      &.running {\n        border-color: rgba(102, 126, 234, 0.4);\n        box-shadow: 0 0 8px rgba(102, 126, 234, 0.2);\n      }\n      \n      &.completed {\n        border-color: rgba(34, 197, 94, 0.3);\n      }\n      \n      &.pending {\n        opacity: 0.8;\n      }\n      \n      .agent-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 12px 16px;\n        background: rgba(255, 255, 255, 0.02);\n        cursor: pointer;\n        transition: background 0.2s ease;\n        \n        &:hover {\n          background: rgba(255, 255, 255, 0.05);\n        }\n        \n        .agent-info {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          flex: 1;\n          \n          .agent-status-icon {\n            font-size: 18px;\n            \n            &.running {\n              color: #667eea;\n            }\n            \n            &.completed {\n              color: #22c55e;\n            }\n            \n            &.pending {\n              color: #9ca3af;\n            }\n          }\n          \n          .agent-details {\n            .agent-name {\n              font-weight: 600;\n              color: #ffffff;\n              font-size: 14px;\n              margin-bottom: 2px;\n            }\n            \n\n            \n            .request-content {\n              margin: 4px 0 0 0;\n              padding: 8px;\n              background: rgba(0, 0, 0, 0.2);\n              border-radius: 4px;\n              font-family: monospace;\n              font-size: 14px;\n              color: #cccccc;\n              white-space: pre-wrap;\n              word-wrap: break-word;\n              word-break: break-word;\n              overflow-wrap: break-word;\n              max-height: 120px;\n              overflow-y: auto;\n              line-height: 1.4;\n            }\n          }\n        }\n        \n        .agent-controls {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          \n          .agent-status-badge {\n            padding: 3px 8px;\n            border-radius: 10px;\n            font-size: 11px;\n            font-weight: 500;\n            \n            &.running {\n              background: rgba(102, 126, 234, 0.2);\n              color: #667eea;\n            }\n            \n            &.completed {\n              background: rgba(34, 197, 94, 0.2);\n              color: #22c55e;\n            }\n            \n            &.pending {\n              background: rgba(156, 163, 175, 0.2);\n              color: #9ca3af;\n            }\n          }\n          \n          .step-select-icon {\n            font-size: 16px;\n            color: #667eea;\n            transition: transform 0.2s ease;\n          }\n        }\n      }\n      \n      .agent-execution-info {\n        padding: 16px;\n        background: rgba(0, 0, 0, 0.1);\n        border-top: 1px solid rgba(255, 255, 255, 0.05);\n        margin-bottom: 16px;\n        \n        .agent-result, .agent-error {\n          margin-bottom: 12px;\n          \n          &:last-child {\n            margin-bottom: 0;\n          }\n          \n          .result-header, .error-header {\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            margin-bottom: 6px;\n            \n            .result-icon, .error-icon {\n              font-size: 14px;\n            }\n            \n            .result-icon {\n              color: #22c55e;\n            }\n            \n            .error-icon {\n              color: #ef4444;\n            }\n            \n            .result-label, .error-label {\n              color: #ffffff;\n              font-size: 13px;\n              font-weight: 500;\n            }\n          }\n          \n          .result-content, .error-content {\n            margin: 0;\n            padding: 8px;\n            background: rgba(0, 0, 0, 0.2);\n            border-radius: 4px;\n            font-family: monospace;\n            font-size: 12px;\n            white-space: pre-wrap;\n            max-height: 150px;\n            overflow-y: auto;\n            color: #cccccc;\n          }\n          \n          .error-content {\n            color: #ff9999;\n            border: 1px solid rgba(239, 68, 68, 0.2);\n          }\n        }\n      }\n      \n      .sub-plans-container {\n        padding: 16px;\n        background: rgba(0, 0, 0, 0.1);\n        border-top: 1px solid rgba(255, 255, 255, 0.05);\n        \n        .sub-plans-header {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 12px;\n          \n          .sub-plans-icon {\n            font-size: 16px;\n            color: #667eea;\n          }\n          \n          .sub-plans-title {\n            color: #ffffff;\n            font-weight: 600;\n            font-size: 14px;\n          }\n        }\n        \n        .sub-plans-list {\n          display: flex;\n          flex-direction: column;\n          gap: 12px;\n          \n          .sub-plan-item {\n            background: rgba(102, 126, 234, 0.05);\n            border: 1px solid rgba(102, 126, 234, 0.1);\n            border-radius: 6px;\n            padding: 12px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n            \n            &:hover {\n              background: rgba(102, 126, 234, 0.1);\n              border-color: rgba(102, 126, 234, 0.2);\n            }\n            \n            &.running {\n              border-color: rgba(102, 126, 234, 0.3);\n              background: rgba(102, 126, 234, 0.08);\n              box-shadow: 0 0 8px rgba(102, 126, 234, 0.15);\n            }\n            \n            &.completed {\n              border-color: rgba(34, 197, 94, 0.3);\n              background: rgba(34, 197, 94, 0.05);\n            }\n            \n            &.pending {\n              opacity: 0.7;\n            }\n            \n            .sub-plan-header {\n              display: flex;\n              align-items: center;\n              justify-content: space-between;\n              margin-bottom: 8px;\n              \n              .sub-plan-info {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                flex: 1;\n                \n                .sub-plan-status-icon {\n                  font-size: 16px;\n                  \n                  &.completed {\n                    color: #22c55e;\n                  }\n                  \n                  &.running {\n                    color: #667eea;\n                  }\n                  \n                  &.in-progress {\n                    color: #fbbf24;\n                  }\n                  \n                  &.pending {\n                    color: #9ca3af;\n                  }\n                }\n                \n                .sub-plan-details {\n                  .sub-plan-title {\n                    font-weight: 600;\n                    color: #ffffff;\n                    font-size: 13px;\n                    margin-bottom: 2px;\n                  }\n                  \n                  .sub-plan-id {\n                    color: #aaaaaa;\n                    font-size: 11px;\n                    font-family: monospace;\n                  }\n                }\n              }\n              \n              .sub-plan-meta {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                \n                .trigger-tool {\n                  display: flex;\n                  align-items: center;\n                  gap: 4px;\n                  padding: 2px 6px;\n                  background: rgba(102, 126, 234, 0.1);\n                  border-radius: 4px;\n                  font-size: 10px;\n                  \n                  .trigger-icon {\n                    font-size: 10px;\n                    color: #667eea;\n                  }\n                  \n                  .trigger-text {\n                    color: #cccccc;\n                    font-weight: 500;\n                  }\n                }\n              }\n              \n              .sub-plan-status-badge {\n                padding: 2px 6px;\n                border-radius: 8px;\n                font-size: 10px;\n                font-weight: 500;\n                \n                &.completed {\n                  background: rgba(34, 197, 94, 0.2);\n                  color: #22c55e;\n                }\n                \n                &.running {\n                  background: rgba(102, 126, 234, 0.2);\n                  color: #667eea;\n                }\n                \n                &.in-progress {\n                  background: rgba(251, 191, 36, 0.2);\n                  color: #fbbf24;\n                }\n                \n                &.pending {\n                  background: rgba(156, 163, 175, 0.2);\n                  color: #9ca3af;\n                }\n              }\n            }\n            \n            .sub-plan-progress {\n              margin-bottom: 8px;\n              \n              .progress-info {\n                .progress-text {\n                  color: #aaaaaa;\n                  font-size: 10px;\n                  margin-bottom: 4px;\n                }\n                \n                .progress-bar {\n                  background: rgba(0, 0, 0, 0.2);\n                  border-radius: 4px;\n                  height: 4px;\n                  overflow: hidden;\n                  \n                  .progress-fill {\n                    height: 100%;\n                    background: linear-gradient(90deg, #667eea, #764ba2);\n                    transition: width 0.3s ease;\n                    border-radius: 4px;\n                  }\n                }\n              }\n            }\n            \n            .sub-plan-agents-steps {\n              .agents-steps-header {\n                color: #aaaaaa;\n                font-size: 11px;\n                margin-bottom: 6px;\n                font-weight: 500;\n              }\n              \n              .agents-steps-list {\n                display: flex;\n                flex-direction: column;\n                gap: 8px;\n                \n                .agent-step-item {\n                  border: 1px solid rgba(255, 255, 255, 0.1);\n                  border-radius: 6px;\n                  padding: 8px;\n                  background: rgba(0, 0, 0, 0.05);\n                  cursor: pointer;\n                  transition: all 0.2s;\n                  \n                  &:hover {\n                    background: rgba(0, 0, 0, 0.1);\n                    border-color: rgba(255, 255, 255, 0.2);\n                  }\n                  \n                  &.completed {\n                    border-color: rgba(34, 197, 94, 0.3);\n                    background: rgba(34, 197, 94, 0.05);\n                  }\n                  \n                  &.running {\n                    border-color: rgba(102, 126, 234, 0.3);\n                    background: rgba(102, 126, 234, 0.08);\n                  }\n                  \n                  &.pending {\n                    opacity: 0.7;\n                  }\n                  \n                  .agent-step-header {\n                    display: flex;\n                    align-items: center;\n                    gap: 8px;\n                    margin-bottom: 8px;\n                    \n                    .agent-icon {\n                      font-size: 14px;\n                      \n                      &.completed {\n                        color: #22c55e;\n                      }\n                      \n                      &.running {\n                        color: #667eea;\n                      }\n                      \n                      &.pending {\n                        color: #9ca3af;\n                      }\n                    }\n                    \n                    .agent-name {\n                      color: #ffffff;\n                      font-size: 13px;\n                      font-weight: 500;\n                      flex: 1;\n                    }\n                    \n                    .agent-status-badge {\n                      padding: 2px 6px;\n                      border-radius: 3px;\n                      font-size: 10px;\n                      font-weight: 500;\n                      \n                      &.completed {\n                        background: rgba(34, 197, 94, 0.2);\n                        color: #22c55e;\n                      }\n                      \n                      &.running {\n                        background: rgba(102, 126, 234, 0.2);\n                        color: #667eea;\n                      }\n                      \n                      &.pending {\n                        background: rgba(156, 163, 175, 0.2);\n                        color: #9ca3af;\n                      }\n                    }\n                  }\n                  \n                  .sub-agent-execution-info {\n                    margin-left: 22px;\n                    \n                    .agent-result, .agent-error {\n                      margin-bottom: 8px;\n                      \n                      &:last-child {\n                        margin-bottom: 0;\n                      }\n                      \n                      .result-header, .error-header {\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                        margin-bottom: 4px;\n                        \n                        .result-icon, .error-icon {\n                          font-size: 12px;\n                        }\n                        \n                        .result-icon {\n                          color: #22c55e;\n                        }\n                        \n                        .error-icon {\n                          color: #ef4444;\n                        }\n                        \n                        .result-label, .error-label {\n                          color: #ffffff;\n                          font-size: 11px;\n                          font-weight: 500;\n                        }\n                      }\n                      \n                      .result-content, .error-content {\n                        margin: 0;\n                        padding: 6px;\n                        background: rgba(0, 0, 0, 0.2);\n                        border-radius: 3px;\n                        font-family: monospace;\n                        font-size: 10px;\n                        white-space: pre-wrap;\n                        max-height: 80px;\n                        overflow-y: auto;\n                        color: #cccccc;\n                        line-height: 1.3;\n                      }\n                    }\n                    \n                    .think-act-preview {\n                      margin-top: 8px;\n                      \n                      .think-act-header {\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                        margin-bottom: 6px;\n                        \n                        .think-act-icon {\n                          font-size: 12px;\n                          color: #667eea;\n                        }\n                        \n                        .think-act-label {\n                          color: #aaaaaa;\n                          font-size: 11px;\n                          font-weight: 500;\n                        }\n                      }\n                      \n                      .think-act-steps-preview {\n                        display: flex;\n                        flex-direction: column;\n                        gap: 3px;\n                        \n                        .think-act-step-preview {\n                          display: flex;\n                          align-items: center;\n                          gap: 6px;\n                          padding: 4px 6px;\n                          background: rgba(0, 0, 0, 0.1);\n                          border-radius: 3px;\n                          cursor: pointer;\n                          transition: all 0.2s;\n                          font-size: 10px;\n                          \n                          &:hover {\n                            background: rgba(0, 0, 0, 0.2);\n                          }\n                          \n                          .step-number {\n                            color: #667eea;\n                            font-weight: 500;\n                            min-width: 20px;\n                          }\n                          \n                          .step-description {\n                            color: #cccccc;\n                            flex: 1;\n                            white-space: nowrap;\n                            overflow: hidden;\n                            text-overflow: ellipsis;\n                          }\n                          \n                          .step-arrow {\n                            font-size: 10px;\n                            color: #888888;\n                          }\n                        }\n                        \n                        .more-steps {\n                          padding: 2px 6px;\n                          color: #888888;\n                          font-size: 9px;\n                          font-style: italic;\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n}\n</style>\n\n\n\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"thinking-section\" v-if=\"shouldShowThinking\">\n    <div class=\"thinking-header\">\n      <div class=\"thinking-avatar\">\n        <Icon icon=\"carbon:thinking\" class=\"thinking-icon\" />\n      </div>\n      <div class=\"thinking-label\">{{ $t('chat.thinkingLabel') }}</div>\n    </div>\n\n    <div class=\"thinking-content\">\n      <!-- Basic thinking state -->\n      <div v-if=\"thinking\" class=\"thinking\">\n        <Icon icon=\"carbon:thinking\" class=\"thinking-icon\" />\n        <span>{{ thinking }}</span>\n      </div>\n\n      <!-- Execution Details Component -->\n      <ExecutionDetails\n        v-if=\"thinkingDetails || planExecution\"\n        :plan-execution=\"(thinkingDetails || planExecution)!\"\n        :step-actions=\"stepActions || []\"\n        :generic-input=\"genericInput || ''\"\n        @agent-selected=\"handleAgentSelected\"\n        @sub-plan-selected=\"handleSubPlanSelected\"\n        @user-input-submitted=\"handleUserInputSubmit\"\n        @step-selected=\"handleStepSelected\"\n      />\n\n      <!-- Display the default processing state only when there is no final content -->\n      <div\n        v-else-if=\"!hasContent && thinking\"\n        class=\"default-processing\"\n      >\n        <div class=\"processing-indicator\">\n          <div class=\"thinking-dots\">\n            <span></span>\n            <span></span>\n            <span></span>\n          </div>\n          <span>{{ thinking || $t('chat.thinkingProcessing') }}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport ExecutionDetails from './ExecutionDetails.vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord } from '@/types/plan-execution-record'\nimport type { CompatiblePlanExecutionRecord } from './composables/useChatMessages'\n\ninterface Props {\n  thinking?: string\n  thinkingDetails?: CompatiblePlanExecutionRecord\n  planExecution?: CompatiblePlanExecutionRecord\n  stepActions?: any[]\n  genericInput?: string\n  hasContent?: boolean\n}\n\ninterface Emits {\n  (e: 'agent-selected', agentIndex: number, agent: AgentExecutionRecord): void\n  (e: 'sub-plan-selected', agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord): void\n  (e: 'user-input-submitted', inputData: any): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Computed properties\nconst shouldShowThinking = computed(() => {\n  return (props.thinking ?? false) || \n         (props.thinkingDetails?.agentExecutionSequence?.length ?? 0) > 0 ||\n         (props.planExecution?.agentExecutionSequence?.length ?? 0) > 0\n})\n\n// Event handlers\nconst handleAgentSelected = (agentIndex: number, agent: AgentExecutionRecord) => {\n  emit('agent-selected', agentIndex, agent)\n}\n\nconst handleSubPlanSelected = (agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleUserInputSubmit = (inputData: any) => {\n  emit('user-input-submitted', inputData)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.thinking-section {\n  margin-bottom: 16px;\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 12px;\n  background: rgba(102, 126, 234, 0.05);\n  overflow: hidden;\n  \n  .thinking-header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 12px 16px;\n    background: rgba(102, 126, 234, 0.1);\n    border-bottom: 1px solid rgba(102, 126, 234, 0.15);\n    \n    .thinking-avatar {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 32px;\n      height: 32px;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      border-radius: 50%;\n      \n      .thinking-icon {\n        font-size: 16px;\n        color: #ffffff;\n      }\n    }\n    \n    .thinking-label {\n      font-weight: 600;\n      color: #ffffff;\n      font-size: 14px;\n    }\n  }\n  \n  .thinking-content {\n    padding: 16px;\n    \n    .thinking {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      margin-bottom: 12px;\n      padding: 8px 12px;\n      background: rgba(102, 126, 234, 0.1);\n      border-radius: 8px;\n      font-size: 13px;\n      color: #ffffff;\n      \n      .thinking-icon {\n        font-size: 14px;\n        color: #667eea;\n        flex-shrink: 0;\n      }\n      \n      span {\n        line-height: 1.4;\n      }\n    }\n    \n    .default-processing {\n      .processing-indicator {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 16px;\n        color: #aaaaaa;\n        font-size: 14px;\n        \n        .thinking-dots {\n          display: flex;\n          gap: 4px;\n          \n          span {\n            width: 6px;\n            height: 6px;\n            background: #667eea;\n            border-radius: 50%;\n            animation: thinking-pulse 1.5s ease-in-out infinite;\n            \n            &:nth-child(1) {\n              animation-delay: 0s;\n            }\n            \n            &:nth-child(2) {\n              animation-delay: 0.2s;\n            }\n            \n            &:nth-child(3) {\n              animation-delay: 0.4s;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n@keyframes thinking-pulse {\n  0%, 80%, 100% {\n    opacity: 0.3;\n    transform: scale(1);\n  }\n  40% {\n    opacity: 1;\n    transform: scale(1.2);\n  }\n}\n\n@media (max-width: 768px) {\n  .thinking-section {\n    .thinking-header {\n      padding: 10px 14px;\n      \n      .thinking-avatar {\n        width: 28px;\n        height: 28px;\n        \n        .thinking-icon {\n          font-size: 14px;\n        }\n      }\n      \n      .thinking-label {\n        font-size: 13px;\n      }\n    }\n    \n    .thinking-content {\n      padding: 14px;\n      \n      .thinking {\n        padding: 6px 10px;\n        font-size: 12px;\n      }\n    }\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Common request methods (TypeScript version, suitable for Vue projects)\n\nimport type { PlanExecutionRecordResponse } from '@/types/plan-execution-record'\n\nexport class CommonApiService {\n  private static readonly BASE_URL = '/api/executor'\n\n  // Get detailed execution records\n  public static async getDetails(planId: string): Promise<PlanExecutionRecordResponse> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/details/${planId}`)\n      if (response.status === 404) {\n        // 404 returns null\n        return null\n      }\n      if (!response.ok) {\n        const errorText = await response.text()\n        throw new Error(`Failed to get detailed information: ${response.status} - ${errorText}`)\n      }\n      const rawText = await response.text()\n      const data = JSON.parse(rawText)\n\n      // Type validation - ensure the response contains required currentPlanId\n      if (data && typeof data === 'object' && !data.currentPlanId) {\n        // If currentPlanId is missing from response, add it from the parameter\n        data.currentPlanId = planId\n      }\n\n      return data\n    } catch (error: any) {\n      // Log error but don't throw exception\n      console.error('[CommonApiService] Failed to get plan details:', error)\n      // Don't return failed status for network errors - let polling continue\n      // Only return null to indicate no data available\n      return null\n    }\n  }\n\n  // Submit user form input\n  public static async submitFormInput(planId: string, formData: any): Promise<any> {\n    const response = await fetch(`${this.BASE_URL}/submit-input/${planId}`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(formData),\n    })\n    if (!response.ok) {\n      let errorData\n      try {\n        errorData = await response.json()\n      } catch {\n        errorData = { message: `Failed to submit form input: ${response.status}` }\n      }\n      throw new Error(errorData.message || `Failed to submit form input: ${response.status}`)\n    }\n    const contentType = response.headers.get('content-type')\n    if (contentType && contentType.indexOf('application/json') !== -1) {\n      return await response.json()\n    }\n    return { success: true }\n  }\n\n  /**\n   * Get all Prompt list\n   */\n  static async getAllPrompts(): Promise<any[]> {\n    try {\n      const response = await fetch(this.BASE_URL)\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to get Prompt list:', error)\n      throw error\n    }\n  }\n\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message || `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"user-input-form-container\">\n    <div class=\"user-input-header\">\n      <Icon icon=\"carbon:user\" class=\"user-icon\" />\n      <h4 class=\"user-input-title\">{{ $t('chat.userInputRequired') }}</h4>\n    </div>\n    \n    <p class=\"user-input-message\">\n      {{ userInputWaitState?.title ?? $t('chat.userInput.message') }}\n    </p>\n    \n    <p v-if=\"userInputWaitState?.formDescription\" class=\"form-description\">\n      {{ userInputWaitState?.formDescription }}\n    </p>\n\n    <form @submit.prevent=\"handleUserInputSubmit\" class=\"user-input-form\">\n      <template\n        v-if=\"userInputWaitState?.formInputs && userInputWaitState.formInputs.length > 0\"\n      >\n        <div class=\"form-grid\">\n          <div\n            v-for=\"(input, inputIndex) in userInputWaitState?.formInputs\"\n            :key=\"inputIndex\"\n            class=\"form-group\"\n          >\n            <label :for=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\">\n              {{ input.label }}{{ isRequired(input.required) ? ' *' : '' }}:\n            </label>\n\n            <!-- Form input types -->\n            <input\n              v-if=\"!input.type || input.type === 'text'\"\n              type=\"text\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'email'\"\n              type=\"email\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'number'\"\n              type=\"number\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'password'\"\n              type=\"password\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <textarea\n              v-else-if=\"input.type === 'textarea'\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input form-textarea\"\n              rows=\"4\"\n            ></textarea>\n\n            <select\n              v-else-if=\"input.type === 'select' && input.options\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input form-select\"\n            >\n              <option value=\"\">{{ $t('selectCommon.pleaseSelect') }}</option>\n              <option\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                :value=\"option\"\n              >\n                {{ option }}\n              </option>\n            </select>\n\n            <div\n              v-else-if=\"input.type === 'checkbox' && input.options\"\n              class=\"checkbox-group\"\n            >\n              <label\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                class=\"checkbox-item\"\n              >\n                <input\n                  type=\"checkbox\"\n                  :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}-${option.replace(/\\W+/g, '_')}`\"\n                  :name=\"input.label\"\n                  :value=\"option\"\n                  v-model=\"formInputsStore[inputIndex]\"\n                  class=\"form-checkbox\"\n                />\n                <span class=\"checkbox-label\">{{ option }}</span>\n              </label>\n            </div>\n\n            <div\n              v-else-if=\"input.type === 'radio' && input.options\"\n              class=\"radio-group\"\n            >\n              <label\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                class=\"radio-item\"\n              >\n                <input\n                  type=\"radio\"\n                  :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}-${option.replace(/\\W+/g, '_')}`\"\n                  :name=\"input.label\"\n                  :value=\"option\"\n                  v-model=\"formInputsStore[inputIndex]\"\n                  class=\"form-radio\"\n                />\n                <span class=\"radio-label\">{{ option }}</span>\n              </label>\n            </div>\n\n            <input\n              v-else\n              type=\"text\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n          </div>\n        </div>\n      </template>\n\n      <template v-else>\n        <div class=\"form-group\">\n          <label for=\"form-input-genericInput\">{{ $t('common.input') }}:</label>\n          <input\n            type=\"text\"\n            id=\"form-input-genericInput\"\n            name=\"genericInput\"\n            v-model=\"genericInput\"\n            class=\"form-input\"\n          />\n        </div>\n      </template>\n\n      <button type=\"submit\" class=\"submit-user-input-btn\">\n        {{ $t('chat.userInput.submit') }}\n      </button>\n    </form>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, watch, onMounted, onUnmounted } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport { CommonApiService } from '@/api/common-api-service'\nimport type { UserInputWaitState } from '@/types/plan-execution-record'\n\ninterface Props {\n  userInputWaitState?: UserInputWaitState\n  planId?: string\n  genericInput?: string\n}\n\ninterface Emits {\n  (e: 'user-input-submitted', inputData: any): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nuseI18n()\n\n// Local state\nconst formInputsStore = reactive<Record<number, string | string[]>>({})\nconst genericInput = ref(props.genericInput ?? '')\nconst isInitialized = ref(false)\nconst initializationTimeout = ref<ReturnType<typeof setTimeout> | null>(null)\n\n// Initialize form inputs based on type\nconst initializeFormInputs = () => {\n  const formInputs = props.userInputWaitState?.formInputs\n  if (formInputs && formInputs.length > 0) {\n    // Only initialize if not already initialized or if form structure changed\n    const needsInitialization = !isInitialized.value || \n      Object.keys(formInputsStore).length !== formInputs.length\n    \n    if (needsInitialization) {\n      formInputs.forEach((input, index) => {\n        // Only initialize if this field doesn't exist or is empty\n        if (!(index in formInputsStore) || \n            (input.type === 'checkbox' && !Array.isArray(formInputsStore[index])) ||\n            (input.type !== 'checkbox' && formInputsStore[index] === '')) {\n          \n          if (input.type === 'checkbox') {\n            formInputsStore[index] = []\n          } else {\n            formInputsStore[index] = ''\n          }\n        }\n      })\n      isInitialized.value = true\n    }\n  }\n}\n\n// Initialize on mount and when formInputs change\nonMounted(() => {\n  initializeFormInputs()\n})\n\nwatch(() => props.userInputWaitState?.formInputs, () => {\n  // Clear any existing timeout\n  if (initializationTimeout.value) {\n    clearTimeout(initializationTimeout.value)\n  }\n  \n  // Debounce initialization to avoid frequent resets\n  initializationTimeout.value = setTimeout(() => {\n    // Reset initialization flag when form structure changes\n    isInitialized.value = false\n    initializeFormInputs()\n  }, 100) // 100ms debounce\n}, { deep: true })\n\n// Event handlers\nconst handleUserInputSubmit = async () => {\n  try {\n    const inputData: any = {}\n\n    const formInputs = props.userInputWaitState?.formInputs\n    if (formInputs && formInputs.length > 0) {\n      Object.entries(formInputsStore).forEach(([index, value]) => {\n        const numIndex = parseInt(index, 10)\n        const input = formInputs[numIndex]\n        const label = input.label || `input_${index}`\n        // Handle checkbox arrays - convert to string if it's an array\n        if (Array.isArray(value)) {\n          inputData[label] = value.join(', ')\n        } else {\n          inputData[label] = value\n        }\n      })\n    } else {\n      inputData.genericInput = genericInput.value\n    }\n\n    console.log('[UserInputForm] Submitting user input:', inputData, 'for planId:', props.planId)\n\n    // Submit user input to backend API\n    if (props.planId) {\n      await CommonApiService.submitFormInput(props.planId, inputData)\n      console.log('[UserInputForm] User input submitted successfully')\n    } else {\n      console.error('[UserInputForm] No planId available for user input submission')\n    }\n\n    emit('user-input-submitted', inputData)\n  } catch (error: any) {\n    console.error('[UserInputForm] User input submission failed:', error)\n  }\n}\n\n// Helper methods\nconst getOptionsArray = (options: string | string[] | undefined): string[] => {\n  if (!options) return []\n  if (Array.isArray(options)) return options\n  if (typeof options === 'string') {\n    return options.split(',').map(opt => opt.trim()).filter(opt => opt.length > 0)\n  }\n  return []\n}\n\nconst isRequired = (required: boolean | string | undefined): boolean => {\n  if (typeof required === 'boolean') return required\n  if (typeof required === 'string') return required === 'true'\n  return false\n}\n\n// Cleanup on unmount\nonUnmounted(() => {\n  if (initializationTimeout.value) {\n    clearTimeout(initializationTimeout.value)\n  }\n})\n</script>\n\n<style lang=\"less\" scoped>\n.user-input-form-container {\n  margin-top: 20px;\n  padding: 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 8px;\n  \n  .user-input-header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    margin-bottom: 12px;\n    \n    .user-icon {\n      font-size: 16px;\n      color: #667eea;\n    }\n    \n    .user-input-title {\n      margin: 0;\n      color: #ffffff;\n      font-size: 14px;\n      font-weight: 600;\n    }\n  }\n  \n  .user-input-message {\n    margin-bottom: 12px;\n    font-weight: 500;\n    color: #ffffff;\n    font-size: 14px;\n  }\n  \n  .form-description {\n    margin-bottom: 16px;\n    color: #aaaaaa;\n    font-size: 13px;\n    line-height: 1.4;\n  }\n  \n  .user-input-form {\n    .form-grid {\n      display: flex;\n      flex-direction: column;\n      gap: 16px;\n      margin-bottom: 16px;\n      \n      @media (max-width: 768px) {\n        gap: 12px;\n      }\n    }\n    \n    .form-group {\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n      \n      label {\n        font-size: 13px;\n        font-weight: 500;\n        color: #ffffff;\n      }\n      \n      .form-input {\n        padding: 8px 12px;\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 6px;\n        color: #ffffff;\n        font-size: 14px;\n        transition: border-color 0.2s ease;\n        \n        &:focus {\n          outline: none;\n          border-color: #667eea;\n          box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n        }\n        \n        &::placeholder {\n          color: #888888;\n        }\n      }\n      \n      .form-textarea {\n        resize: vertical;\n        min-height: 60px;\n        font-family: inherit;\n      }\n      \n      .form-select {\n        cursor: pointer;\n        \n        option {\n          background: #2d3748;\n          color: #ffffff;\n        }\n      }\n      \n      .checkbox-group,\n      .radio-group {\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n        \n        .checkbox-item,\n        .radio-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          cursor: pointer;\n          padding: 4px 0;\n          \n          .form-checkbox,\n          .form-radio {\n            width: 16px;\n            height: 16px;\n            margin: 0;\n            cursor: pointer;\n            accent-color: #667eea;\n          }\n          \n          .checkbox-label,\n          .radio-label {\n            color: #ffffff;\n            font-size: 14px;\n            user-select: none;\n          }\n        }\n      }\n    }\n    \n    .submit-user-input-btn {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: #ffffff;\n      border: none;\n      padding: 10px 20px;\n      border-radius: 6px;\n      font-size: 14px;\n      font-weight: 500;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      \n      &:hover {\n        transform: translateY(-1px);\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n      }\n      \n      &:active {\n        transform: translateY(0);\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"response-section\">\n    <div class=\"response-header\">\n      <div class=\"response-avatar\">\n        <Icon icon=\"carbon:bot\" class=\"bot-icon\" />\n      </div>\n      <div class=\"response-name\">{{ $t('chat.botName') }}</div>\n      \n      <!-- Response timestamp -->\n      <div v-if=\"timestamp\" class=\"response-timestamp\">\n        {{ formatTimestamp(timestamp) }}\n      </div>\n    </div>\n    \n    <div class=\"response-content\">\n      <!-- User input form -->\n      <UserInputForm\n        v-if=\"userInputWaitState?.waiting\"\n        :user-input-wait-state=\"userInputWaitState\"\n        v-bind=\"planId ? { 'plan-id': planId } : {}\"\n        :generic-input=\"genericInput ?? ''\"\n        @user-input-submitted=\"handleUserInputSubmitted\"\n      />\n      \n      <!-- Final response with content -->\n      <div v-if=\"content\" class=\"final-response\">\n        <div class=\"response-text\" v-html=\"formatResponseText(content)\"></div>\n        \n        <!-- Response actions -->\n        <div class=\"response-actions\">\n          <button\n            class=\"action-btn copy-btn\"\n            @click=\"copyToClipboard\"\n            :title=\"$t('chat.copyResponse')\"\n          >\n            <Icon icon=\"carbon:copy\" />\n          </button>\n          \n          <button\n            class=\"action-btn regenerate-btn\"\n            @click=\"handleRegenerate\"\n            :title=\"$t('chat.regenerateResponse')\"\n          >\n            <Icon icon=\"carbon:renew\" />\n          </button>\n        </div>\n      </div>\n      \n      <!-- Loading/streaming state -->\n      <div v-else-if=\"isStreaming\" class=\"response-placeholder\">\n        <div class=\"typing-indicator\">\n          <div class=\"typing-dots\">\n            <span></span>\n            <span></span>\n            <span></span>\n          </div>\n          <span class=\"typing-text\">{{ $t('chat.thinkingResponse') }}</span>\n        </div>\n      </div>\n      \n      <!-- Error state -->\n      <div v-else-if=\"error\" class=\"response-error\">\n        <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n        <span class=\"error-text\">{{ error }}</span>\n        <button class=\"retry-btn\" @click=\"handleRetry\">\n          {{ $t('chat.retry') }}\n        </button>\n      </div>\n      \n      <!-- Empty state -->\n      <div v-else class=\"response-empty\">\n        <span class=\"empty-text\">{{ $t('chat.waitingForResponse') }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\nimport UserInputForm from './UserInputForm.vue'\nimport type { UserInputWaitState } from '@/types/plan-execution-record'\n\ninterface Props {\n  content?: string\n  isStreaming?: boolean\n  error?: string\n  timestamp?: Date\n  userInputWaitState?: UserInputWaitState\n  planId?: string\n  genericInput?: string\n}\n\ninterface Emits {\n  (e: 'copy'): void\n  (e: 'regenerate'): void\n  (e: 'retry'): void\n  (e: 'user-input-submitted', inputData: any): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\nconst { formatResponseText, formatTimestamp } = useMessageFormatting()\n\n// Methods\nconst copyToClipboard = async () => {\n  if (!props.content) return\n  \n  try {\n    // Strip HTML tags for clipboard\n    const plainText = props.content.replace(/<[^>]*>/g, '')\n    await navigator.clipboard.writeText(plainText)\n    emit('copy')\n  } catch (error) {\n    console.error('Failed to copy to clipboard:', error)\n  }\n}\n\nconst handleRegenerate = () => {\n  emit('regenerate')\n}\n\nconst handleRetry = () => {\n  emit('retry')\n}\n\nconst handleUserInputSubmitted = (inputData: any) => {\n  console.log('[ResponseSection] User input submitted:', inputData)\n  emit('user-input-submitted', inputData)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.response-section {\n  .response-header {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    margin-bottom: 12px;\n    \n    .response-avatar {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 32px;\n      height: 32px;\n      background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);\n      border-radius: 50%;\n      flex-shrink: 0;\n      \n      .bot-icon {\n        font-size: 16px;\n        color: #ffffff;\n      }\n    }\n    \n    .response-name {\n      font-weight: 600;\n      color: #ffffff;\n      font-size: 14px;\n      flex: 1;\n    }\n    \n    .response-timestamp {\n      font-size: 11px;\n      color: #aaaaaa;\n    }\n  }\n  \n  .response-content {\n    .final-response {\n      position: relative;\n      \n      .response-text {\n        background: rgba(255, 255, 255, 0.05);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 12px;\n        padding: 16px;\n        color: #ffffff;\n        line-height: 1.6;\n        font-size: 14px;\n        \n        :deep(strong) {\n          font-weight: 600;\n          color: #ffffff;\n        }\n        \n        :deep(em) {\n          font-style: italic;\n          color: #cccccc;\n        }\n        \n        :deep(code) {\n          background: rgba(0, 0, 0, 0.3);\n          padding: 2px 6px;\n          border-radius: 4px;\n          font-family: 'Monaco', 'Menlo', monospace;\n          font-size: 13px;\n          color: #8be9fd;\n        }\n        \n        :deep(pre) {\n          background: rgba(0, 0, 0, 0.4);\n          padding: 12px;\n          border-radius: 8px;\n          overflow-x: auto;\n          margin: 8px 0;\n          \n          code {\n            background: none;\n            padding: 0;\n            color: #f8f8f2;\n            font-size: 12px;\n          }\n        }\n      }\n      \n      .response-actions {\n        display: flex;\n        gap: 8px;\n        margin-top: 8px;\n        opacity: 0;\n        transition: opacity 0.2s ease;\n        \n        .action-btn {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          width: 28px;\n          height: 28px;\n          background: rgba(255, 255, 255, 0.1);\n          border: none;\n          border-radius: 6px;\n          color: #aaaaaa;\n          cursor: pointer;\n          transition: all 0.2s ease;\n          \n          &:hover {\n            background: rgba(255, 255, 255, 0.2);\n            color: #ffffff;\n          }\n          \n          svg {\n            font-size: 14px;\n          }\n        }\n      }\n      \n      &:hover .response-actions {\n        opacity: 1;\n      }\n    }\n    \n    .response-placeholder {\n      .typing-indicator {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 16px;\n        color: #aaaaaa;\n        font-size: 14px;\n        \n        .typing-dots {\n          display: flex;\n          gap: 4px;\n          \n          span {\n            width: 6px;\n            height: 6px;\n            background: #4f46e5;\n            border-radius: 50%;\n            animation: typing-pulse 1.5s ease-in-out infinite;\n            \n            &:nth-child(1) {\n              animation-delay: 0s;\n            }\n            \n            &:nth-child(2) {\n              animation-delay: 0.2s;\n            }\n            \n            &:nth-child(3) {\n              animation-delay: 0.4s;\n            }\n          }\n        }\n        \n        .typing-text {\n          font-style: italic;\n        }\n      }\n    }\n    \n    .response-error {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 12px 16px;\n      background: rgba(239, 68, 68, 0.1);\n      border: 1px solid rgba(239, 68, 68, 0.2);\n      border-radius: 8px;\n      color: #ff9999;\n      font-size: 13px;\n      \n      .error-icon {\n        font-size: 16px;\n        color: #ef4444;\n        flex-shrink: 0;\n      }\n      \n      .error-text {\n        flex: 1;\n      }\n      \n      .retry-btn {\n        background: rgba(239, 68, 68, 0.2);\n        border: none;\n        padding: 4px 8px;\n        border-radius: 4px;\n        color: #ffffff;\n        font-size: 12px;\n        cursor: pointer;\n        transition: background 0.2s ease;\n        \n        &:hover {\n          background: rgba(239, 68, 68, 0.3);\n        }\n      }\n    }\n    \n    .response-empty {\n      padding: 16px;\n      text-align: center;\n      color: #888888;\n      font-style: italic;\n      font-size: 13px;\n    }\n  }\n}\n\n@keyframes typing-pulse {\n  0%, 80%, 100% {\n    opacity: 0.3;\n    transform: scale(1);\n  }\n  40% {\n    opacity: 1;\n    transform: scale(1.2);\n  }\n}\n\n@media (max-width: 768px) {\n  .response-section {\n    .response-header {\n      gap: 10px;\n      \n      .response-avatar {\n        width: 28px;\n        height: 28px;\n        \n        .bot-icon {\n          font-size: 14px;\n        }\n      }\n      \n      .response-name {\n        font-size: 13px;\n      }\n    }\n    \n    .response-content {\n      .final-response {\n        .response-text {\n          padding: 14px;\n          font-size: 13px;\n        }\n        \n        .response-actions {\n          margin-top: 6px;\n          \n          .action-btn {\n            width: 26px;\n            height: 26px;\n            \n            svg {\n              font-size: 12px;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"assistant-message\">\n    <!-- Thinking section (when available) -->\n    <ThinkingSection\n      v-if=\"message.thinkingDetails\"\n      :thinking-details=\"message.thinkingDetails\"\n      @step-selected=\"handleStepSelected\"\n    />\n    \n    <!-- Plan execution section (when available) -->\n    <ExecutionDetails\n      v-if=\"message.planExecution\"\n      :plan-execution=\"message.planExecution\"\n      :step-actions=\"message.stepActions || []\"\n      :generic-input=\"message.genericInput || ''\"\n      @step-selected=\"handleStepSelected\"\n    />\n    \n    <!-- Response section -->\n    <ResponseSection\n      v-if=\"message.content || message.error || isStreaming || message.planExecution?.userInputWaitState?.waiting\"\n      :content=\"message.content || ''\"\n      :is-streaming=\"isStreaming || false\"\n      v-bind=\"{\n        ...(message.error ? { error: message.error } : {}),\n        ...(message.planExecution?.userInputWaitState ? { userInputWaitState: message.planExecution.userInputWaitState } : {}),\n        ...(message.planExecution?.currentPlanId ? { planId: message.planExecution.currentPlanId } : {})\n      }\"\n      :timestamp=\"message.timestamp\"\n      :generic-input=\"message.genericInput || ''\"\n      @copy=\"handleCopy\"\n      @regenerate=\"handleRegenerate\"\n      @retry=\"handleRetry\"\n      @user-input-submitted=\"(inputData: any) => handleUserInputSubmit(message, inputData)\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport ThinkingSection from './ThinkingSection.vue'\nimport ResponseSection from './ResponseSection.vue'\nimport ExecutionDetails from './ExecutionDetails.vue'\nimport type { ChatMessage } from './composables/useChatMessages'\n\ninterface Props {\n  message: ChatMessage\n  isStreaming?: boolean\n}\n\ninterface Emits {\n  (e: 'copy', messageId: string): void\n  (e: 'regenerate', messageId: string): void\n  (e: 'retry', messageId: string): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Event handlers\nconst handleCopy = () => {\n  emit('copy', props.message.id)\n}\n\nconst handleRegenerate = () => {\n  emit('regenerate', props.message.id)\n}\n\nconst handleRetry = () => {\n  emit('retry', props.message.id)\n}\n\n// Plan execution event handlers\n\nconst handleUserInputSubmit = (message: ChatMessage, inputData: any) => {\n  console.log('[AssistantMessage] User input submitted:', inputData, 'for message:', message.id)\n  // Handle user input submission - can be extended for more functionality\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[AssistantMessage] Step selected:', stepId)\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.assistant-message {\n  margin-bottom: 24px;\n  \n  // Add spacing between thinking and response sections\n  > * + * {\n    margin-top: 16px;\n  }\n}\n\n@media (max-width: 768px) {\n  .assistant-message {\n    margin-bottom: 20px;\n    \n    > * + * {\n      margin-top: 12px;\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"chat-message\" :class=\"messageClasses\">\n    <!-- User message -->\n    <UserMessage\n      v-if=\"message.type === 'user'\"\n      :message=\"message\"\n    />\n    \n    <!-- Assistant message -->\n    <AssistantMessage\n      v-else-if=\"message.type === 'assistant'\"\n      :message=\"message\"\n      :is-streaming=\"isStreaming || false\"\n      @copy=\"handleCopy\"\n      @regenerate=\"handleRegenerate\"\n      @retry=\"handleRetry\"\n      @step-selected=\"handleStepSelected\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport UserMessage from './UserMessage.vue'\nimport AssistantMessage from './AssistantMessage.vue'\nimport type { ChatMessage } from './composables/useChatMessages'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\n\ninterface Props {\n  message: ChatMessage\n  isStreaming?: boolean\n}\n\ninterface Emits {\n  (e: 'copy', messageId: string): void\n  (e: 'regenerate', messageId: string): void\n  (e: 'retry', messageId: string): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\nconst { getMessageClasses } = useMessageFormatting()\n\n// Computed properties\nconst messageClasses = computed(() => {\n  return getMessageClasses(props.message)\n})\n\n// Event handlers\nconst handleCopy = (messageId: string) => {\n  emit('copy', messageId)\n}\n\nconst handleRegenerate = (messageId: string) => {\n  emit('regenerate', messageId)\n}\n\nconst handleRetry = (messageId: string) => {\n  emit('retry', messageId)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.chat-message {\n  width: 100%;\n  \n  &.streaming {\n    position: relative;\n    \n    &::after {\n      content: '';\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      height: 2px;\n      background: linear-gradient(90deg, transparent, #4f46e5, transparent);\n      animation: streaming-pulse 2s ease-in-out infinite;\n    }\n  }\n}\n\n@keyframes streaming-pulse {\n  0% {\n    transform: translateX(-100%);\n    opacity: 0;\n  }\n  50% {\n    opacity: 1;\n  }\n  100% {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ref, computed, readonly } from 'vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord } from '@/types/plan-execution-record'\n\n// Local interface to handle readonly compatibility issues\nexport interface CompatiblePlanExecutionRecord extends Omit<PlanExecutionRecord, 'agentExecutionSequence'> {\n  agentExecutionSequence?: AgentExecutionRecord[]\n}\n\n// Message interface\nexport interface ChatMessage {\n  id: string\n  type: 'user' | 'assistant'\n  content: string\n  timestamp: Date\n  thinking?: string\n  thinkingDetails?: CompatiblePlanExecutionRecord\n  planExecution?: CompatiblePlanExecutionRecord\n  stepActions?: any[]\n  genericInput?: string\n  isStreaming?: boolean\n  error?: string\n  attachments?: File[]\n}\n\n// Input message interface\nexport interface InputMessage {\n  input: string\n  attachments?: File[]\n}\n\n/**\n * Utility type to convert readonly arrays to mutable ones\n */\ntype MakeMutable<T> = T extends readonly (infer U)[] ? U[] : T\n\n/**\n * Convert readonly PlanExecutionRecord to mutable compatible version with strong typing\n */\nfunction convertPlanExecutionRecord<T extends Record<string, any>>(\n  record: T\n): CompatiblePlanExecutionRecord {\n  const converted = { ...record } as unknown as CompatiblePlanExecutionRecord\n  \n  if ('agentExecutionSequence' in record && Array.isArray(record.agentExecutionSequence)) {\n    converted.agentExecutionSequence = record.agentExecutionSequence.map(\n      (agent: any) => convertAgentExecutionRecord(agent)\n    )\n  }\n  \n  return converted\n}\n\n/**\n * Convert readonly AgentExecutionRecord to mutable compatible version with strong typing\n */\nfunction convertAgentExecutionRecord<T extends Record<string, any>>(\n  record: T\n): AgentExecutionRecord {\n  const converted = { ...record } as unknown as AgentExecutionRecord\n  \n  if ('subPlanExecutionRecords' in record && Array.isArray(record.subPlanExecutionRecords)) {\n    converted.subPlanExecutionRecords = record.subPlanExecutionRecords.map(\n      (subPlan: any) => convertPlanExecutionRecord(subPlan)\n    )\n  }\n  \n  return converted\n}\n\n/**\n * Convert a message with potentially readonly arrays to a fully mutable version\n */\nexport function convertMessageToCompatible<T extends Record<string, any>>(message: T): ChatMessage {\n  const converted = { ...message } as unknown as ChatMessage\n  \n  if ('thinkingDetails' in message && message.thinkingDetails) {\n    converted.thinkingDetails = convertPlanExecutionRecord(message.thinkingDetails)\n  }\n  \n  if ('planExecution' in message && message.planExecution) {\n    converted.planExecution = convertPlanExecutionRecord(message.planExecution)\n  }\n  \n  if ('attachments' in message && Array.isArray(message.attachments)) {\n    converted.attachments = [...message.attachments] as MakeMutable<typeof message.attachments>\n  }\n  \n  return converted\n}\n\n/**\n * Chat messages state management\n */\nexport function useChatMessages() {\n  // State\n  const messages = ref<ChatMessage[]>([])\n  const isLoading = ref(false)\n  const streamingMessageId = ref<string | null>(null)\n  const activeMessageId = ref<string | null>(null)\n\n  // Computed properties\n  const lastMessage = computed(() => {\n    return messages.value.length > 0 ? messages.value[messages.value.length - 1] : null\n  })\n\n  const isStreaming = computed(() => {\n    return streamingMessageId.value !== null\n  })\n\n  const hasMessages = computed(() => {\n    return messages.value.length > 0\n  })\n\n  // Methods\n  const addMessage = (type: 'user' | 'assistant', content: string, options?: Partial<ChatMessage>): ChatMessage => {\n    const message: ChatMessage = {\n      id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      type,\n      content,\n      timestamp: new Date(),\n      isStreaming: false,\n      ...options\n    }\n\n    messages.value.push(message)\n    return message\n  }\n\n  const updateMessage = (id: string, updates: Partial<ChatMessage>) => {\n    const index = messages.value.findIndex(m => m.id === id)\n    if (index !== -1) {\n      messages.value[index] = { ...messages.value[index], ...updates }\n    }\n  }\n\n  const removeMessage = (id: string) => {\n    const index = messages.value.findIndex(m => m.id === id)\n    if (index !== -1) {\n      messages.value.splice(index, 1)\n    }\n  }\n\n  const clearMessages = () => {\n    messages.value = []\n    streamingMessageId.value = null\n    activeMessageId.value = null\n  }\n\n  const startStreaming = (messageId: string) => {\n    streamingMessageId.value = messageId\n    updateMessage(messageId, { isStreaming: true })\n  }\n\n  const stopStreaming = (messageId?: string) => {\n    if (messageId) {\n      updateMessage(messageId, { isStreaming: false })\n    }\n    if (streamingMessageId.value === messageId) {\n      streamingMessageId.value = null\n    }\n  }\n\n  const setActiveMessage = (id: string | null) => {\n    activeMessageId.value = id\n  }\n\n  const appendToMessage = (id: string, content: string, field: keyof ChatMessage = 'content') => {\n    const message = messages.value.find(m => m.id === id)\n    if (message && typeof message[field] === 'string') {\n      updateMessage(id, { [field]: (message[field] as string) + content })\n    }\n  }\n\n  const updateMessageThinkingDetails = (id: string, thinkingDetails: PlanExecutionRecord) => {\n    updateMessage(id, { thinkingDetails })\n  }\n\n  const updateMessageThinking = (id: string, thinking: string) => {\n    updateMessage(id, { thinking })\n  }\n\n  const updateMessagePlanExecution = (id: string, planExecution: PlanExecutionRecord) => {\n    updateMessage(id, { planExecution })\n  }\n\n  const findMessage = (id: string): ChatMessage | undefined => {\n    return messages.value.find(m => m.id === id)\n  }\n\n  const getMessageIndex = (id: string): number => {\n    return messages.value.findIndex(m => m.id === id)\n  }\n\n  return {\n    // State\n    messages: readonly(messages),\n    isLoading,\n    streamingMessageId: readonly(streamingMessageId),\n    activeMessageId: readonly(activeMessageId),\n\n    // Computed\n    lastMessage,\n    isStreaming,\n    hasMessages,\n\n    // Methods\n    addMessage,\n    updateMessage,\n    removeMessage,\n    clearMessages,\n    startStreaming,\n    stopStreaming,\n    setActiveMessage,\n    appendToMessage,\n    updateMessageThinking,\n    updateMessageThinkingDetails,\n    updateMessagePlanExecution,\n    findMessage,\n    getMessageIndex\n  }\n}\n\n// Message utilities\nexport const createUserMessage = (content: string): Omit<ChatMessage, 'id' | 'timestamp'> => ({\n  type: 'user',\n  content,\n  isStreaming: false\n})\n\nexport const createAssistantMessage = (options?: Partial<ChatMessage>): Omit<ChatMessage, 'id' | 'timestamp'> => ({\n  type: 'assistant',\n  content: '',\n  thinking: '',\n  isStreaming: true,\n  ...options\n})\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ref, nextTick, onMounted, onUnmounted, readonly } from 'vue'\nimport type { Ref } from 'vue'\n\n/**\n * Scroll behavior management for chat messages\n */\nexport function useScrollBehavior(containerRef: Ref<HTMLElement | null>) {\n  const showScrollToBottom = ref(false)\n  const isAutoScrollEnabled = ref(true)\n  const scrollThreshold = 150 // pixels from bottom to show scroll button\n\n  /**\n   * Scroll to bottom of container\n   */\n  const scrollToBottom = async (smooth = true) => {\n    if (!containerRef.value) return\n    \n    await nextTick()\n    \n    containerRef.value.scrollTo({\n      top: containerRef.value.scrollHeight,\n      behavior: smooth ? 'smooth' : 'auto'\n    })\n  }\n\n  /**\n   * Check if user is near bottom of container\n   */\n  const isNearBottom = (): boolean => {\n    if (!containerRef.value) return false\n    \n    const { scrollTop, scrollHeight, clientHeight } = containerRef.value\n    return scrollHeight - scrollTop - clientHeight < scrollThreshold\n  }\n\n  /**\n   * Check scroll position and update scroll button visibility\n   */\n  const checkScrollPosition = () => {\n    if (!containerRef.value) return\n    \n    const nearBottom = isNearBottom()\n    showScrollToBottom.value = !nearBottom && containerRef.value.scrollHeight > containerRef.value.clientHeight\n    \n    // Enable auto-scroll when user scrolls to bottom\n    if (nearBottom) {\n      isAutoScrollEnabled.value = true\n    }\n  }\n\n  /**\n   * Handle scroll event\n   */\n  const handleScroll = () => {\n    checkScrollPosition()\n    \n    // Disable auto-scroll when user manually scrolls up\n    if (!isNearBottom()) {\n      isAutoScrollEnabled.value = false\n    }\n  }\n\n  /**\n   * Auto scroll to bottom when new messages arrive\n   */\n  const autoScrollToBottom = async () => {\n    if (isAutoScrollEnabled.value) {\n      await scrollToBottom()\n    }\n  }\n\n  /**\n   * Force scroll to bottom and enable auto-scroll\n   */\n  const forceScrollToBottom = async () => {\n    isAutoScrollEnabled.value = true\n    await scrollToBottom()\n  }\n\n  /**\n   * Scroll to a specific message element\n   */\n  const scrollToMessage = (messageId: string, smooth = true) => {\n    if (!containerRef.value) return\n    \n    const messageElement = containerRef.value.querySelector(`[data-message-id=\"${messageId}\"]`)\n    if (messageElement) {\n      messageElement.scrollIntoView({\n        behavior: smooth ? 'smooth' : 'auto',\n        block: 'center'\n      })\n    }\n  }\n\n  /**\n   * Get scroll position info\n   */\n  const getScrollInfo = () => {\n    if (!containerRef.value) {\n      return {\n        scrollTop: 0,\n        scrollHeight: 0,\n        clientHeight: 0,\n        isAtTop: true,\n        isAtBottom: true,\n        scrollPercentage: 0\n      }\n    }\n\n    const { scrollTop, scrollHeight, clientHeight } = containerRef.value\n    const isAtTop = scrollTop === 0\n    const isAtBottom = scrollTop + clientHeight >= scrollHeight - 5\n    const scrollPercentage = scrollHeight > clientHeight \n      ? (scrollTop / (scrollHeight - clientHeight)) * 100 \n      : 100\n\n    return {\n      scrollTop,\n      scrollHeight,\n      clientHeight,\n      isAtTop,\n      isAtBottom,\n      scrollPercentage\n    }\n  }\n\n  /**\n   * Add scroll event listener\n   */\n  const addScrollListener = () => {\n    if (containerRef.value) {\n      containerRef.value.addEventListener('scroll', handleScroll, { passive: true })\n    }\n  }\n\n  /**\n   * Remove scroll event listener\n   */\n  const removeScrollListener = () => {\n    if (containerRef.value) {\n      containerRef.value.removeEventListener('scroll', handleScroll)\n    }\n  }\n\n  /**\n   * Initialize scroll behavior\n   */\n  const initializeScrollBehavior = () => {\n    addScrollListener()\n    checkScrollPosition()\n  }\n\n  /**\n   * Clean up scroll behavior\n   */\n  const cleanupScrollBehavior = () => {\n    removeScrollListener()\n  }\n\n  // Auto-initialize on mount\n  onMounted(() => {\n    nextTick(() => {\n      initializeScrollBehavior()\n    })\n  })\n\n  // Cleanup on unmount\n  onUnmounted(() => {\n    cleanupScrollBehavior()\n  })\n\n  return {\n    // State\n    showScrollToBottom: readonly(showScrollToBottom),\n    isAutoScrollEnabled: readonly(isAutoScrollEnabled),\n\n    // Methods\n    scrollToBottom,\n    autoScrollToBottom,\n    forceScrollToBottom,\n    scrollToMessage,\n    isNearBottom,\n    checkScrollPosition,\n    getScrollInfo,\n    addScrollListener,\n    removeScrollListener,\n    initializeScrollBehavior,\n    cleanupScrollBehavior\n  }\n}\n\n/**\n * Smooth scroll behavior with easing\n */\nexport function useSmoothScroll() {\n  const scrollWithEasing = (\n    element: HTMLElement,\n    targetPosition: number,\n    duration: number = 300\n  ) => {\n    const startPosition = element.scrollTop\n    const distance = targetPosition - startPosition\n    let startTime: number | null = null\n\n    const animation = (currentTime: number) => {\n      if (startTime === null) startTime = currentTime\n      const timeElapsed = currentTime - startTime\n      const run = easeInOutQuad(timeElapsed, startPosition, distance, duration)\n      \n      element.scrollTop = run\n      \n      if (timeElapsed < duration) {\n        requestAnimationFrame(animation)\n      }\n    }\n\n    requestAnimationFrame(animation)\n  }\n\n  // Easing function\n  const easeInOutQuad = (t: number, b: number, c: number, d: number): number => {\n    t /= d / 2\n    if (t < 1) return c / 2 * t * t + b\n    t--\n    return -c / 2 * (t * (t - 2) - 1) + b\n  }\n\n  return {\n    scrollWithEasing\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { reactive } from 'vue'\nimport { PlanActApiService } from '@/api/plan-act-api-service'\nimport { DirectApiService } from '@/api/direct-api-service'\nimport { CommonApiService } from '@/api/common-api-service'\nimport type { PlanExecutionRecord } from '@/types/plan-execution-record'\nimport type { UIStateData } from '@/types/cache-data'\n\n// Define event callback interface\ninterface EventCallbacks {\n  onPlanUpdate?: (rootPlanId: string) => void\n  onPlanCompleted?: (rootPlanId: string) => void\n  onDialogRoundStart?: (rootPlanId: string) => void\n  onChatInputUpdateState?: (rootPlanId: string) => void\n  onChatInputClear?: () => void\n  onPlanError?: (message: string) => void\n}\n\ninterface ExecutionState {\n  activePlanId: string | null\n  lastSequenceSize: number\n  isPolling: boolean\n  pollTimer: number | null\n}\n\n\nexport class PlanExecutionManager {\n  private static instance: PlanExecutionManager | null = null\n  private readonly POLL_INTERVAL = 5000\n\n  // Reactive state\n  private state = reactive<ExecutionState>({\n    activePlanId: null,\n    lastSequenceSize: 0,\n    isPolling: false,\n    pollTimer: null\n  })\n\n  // Event callbacks\n  private callbacks: EventCallbacks = {}\n\n  // Cache for PlanExecutionRecord by rootPlanId\n  private planExecutionCache = new Map<string, PlanExecutionRecord>()\n\n  // Cache for UI state by rootPlanId\n  private uiStateCache = new Map<string, UIStateData>()\n\n  /**\n   * Get cached plan execution record by rootPlanId\n   */\n  getCachedPlanRecord(rootPlanId: string): PlanExecutionRecord | undefined {\n    return this.planExecutionCache.get(rootPlanId)\n  }\n\n  /**\n   * Get cached UI state by rootPlanId\n   */\n  getCachedUIState(rootPlanId: string): UIStateData | undefined {\n    return this.uiStateCache.get(rootPlanId)\n  }\n\n  /**\n   * Set cached UI state by rootPlanId\n   */\n  setCachedUIState(rootPlanId: string, uiState: UIStateData): void {\n    this.uiStateCache.set(rootPlanId, uiState)\n    console.log(`[PlanExecutionManager] Cached UI state for rootPlanId: ${rootPlanId}`)\n  }\n\n  /**\n   * Get all cached plan execution records\n   */\n  getAllCachedRecords(): Map<string, PlanExecutionRecord> {\n    return new Map(this.planExecutionCache)\n  }\n\n  /**\n   * Check if a plan execution record exists in cache\n   */\n  hasCachedPlanRecord(rootPlanId: string): boolean {\n    return this.planExecutionCache.has(rootPlanId)\n  }\n\n  /**\n   * Set cached plan execution record by rootPlanId\n   */\n  setCachedPlanRecord(rootPlanId: string, record: PlanExecutionRecord): void {\n    this.planExecutionCache.set(rootPlanId, record)\n    console.log(`[PlanExecutionManager] Cached plan execution record for rootPlanId: ${rootPlanId}`)\n  }\n\n  /**\n   * Clear cached plan execution record by rootPlanId\n   */\n  clearCachedPlanRecord(rootPlanId: string): boolean {\n    const deleted = this.planExecutionCache.delete(rootPlanId)\n    if (deleted) {\n      console.log(`[PlanExecutionManager] Cleared cached plan execution record for rootPlanId: ${rootPlanId}`)\n    }\n    return deleted\n  }\n\n  /**\n   * Clear all cached plan execution records\n   */\n  clearAllCachedRecords(): void {\n    const planCacheSize = this.planExecutionCache.size\n    const uiStateCacheSize = this.uiStateCache.size\n\n    this.planExecutionCache.clear()\n    this.uiStateCache.clear()\n\n    console.log(`[PlanExecutionManager] Cleared all caches - Plans: ${planCacheSize}, UI States: ${uiStateCacheSize}`)\n  }\n\n  private constructor() {\n    // Remove window event listener initialization\n    console.log('[PlanExecutionManager] Initialized with callback-based event system')\n  }\n\n  /**\n   * Get singleton instance\n   */\n  public static getInstance(): PlanExecutionManager {\n    if (!PlanExecutionManager.instance) {\n      PlanExecutionManager.instance = new PlanExecutionManager()\n    }\n    return PlanExecutionManager.instance\n  }\n\n  /**\n   * Get current active plan ID\n   */\n  public getActivePlanId(): string | null {\n    return this.state.activePlanId\n  }\n\n  /**\n   * Get current state (reactive)\n   */\n  public getState() {\n    return this.state\n  }\n\n  /**\n   * Set event callbacks\n   */\n  public setEventCallbacks(callbacks: EventCallbacks): void {\n    this.callbacks = { ...this.callbacks, ...callbacks }\n    console.log('[PlanExecutionManager] Event callbacks set:', Object.keys(callbacks))\n  }\n\n  /**\n   * Handle user message send request\n   */\n  public async handleUserMessageSendRequested(query: string): Promise<void> {\n    if (!this.validateAndPrepareUIForNewRequest(query)) {\n      return\n    }\n\n    try {\n      await this.sendUserMessageAndSetPlanId(query)\n\n      if (this.state.activePlanId) {\n        this.initiatePlanExecutionSequence(query, this.state.activePlanId)\n      } else {\n        throw new Error('Failed to get valid plan ID')\n      }\n    } catch (error: any) {\n      console.error('[PlanExecutionManager] Failed to send user message:', error)\n      // Set UI state to enabled for error recovery\n      const errorPlanId = this.state.activePlanId ?? 'error'\n      this.setCachedUIState(errorPlanId, { enabled: true })\n\n      this.emitChatInputUpdateState(errorPlanId)\n      this.state.activePlanId = null\n    }\n  }\n\n  /**\n   * Handle plan execution request\n   */\n  public handlePlanExecutionRequested(planId: string, query?: string): void {\n    console.log('[PlanExecutionManager] Received plan execution request:', { planId, query })\n\n    if (planId) {\n      this.state.activePlanId = planId\n      this.initiatePlanExecutionSequence(query ?? 'Execute Plan', planId)\n    } else {\n      console.error('[PlanExecutionManager] Invalid plan execution request: missing planId')\n    }\n  }\n\n  /**\n   * Handle plan execution request with cache lookup by rootPlanId\n   */\n  public handleCachedPlanExecution(rootPlanId: string, query?: string): boolean {\n    const cachedRecord = this.getCachedPlanRecord(rootPlanId)\n\n    if (cachedRecord?.currentPlanId) {\n      console.log(`[PlanExecutionManager] Found cached plan execution record for rootPlanId: ${rootPlanId}`)\n      this.handlePlanExecutionRequested(cachedRecord.currentPlanId, query)\n      return true\n    } else {\n      console.log(`[PlanExecutionManager] No cached plan execution record found for rootPlanId: ${rootPlanId}`)\n      return false\n    }\n  }\n\n  /**\n   * Validate request and prepare UI\n   */\n  private validateAndPrepareUIForNewRequest(query: string): boolean {\n    if (!query) {\n      console.warn('[PlanExecutionManager] Query is empty')\n      return false\n    }\n\n    if (this.state.activePlanId) {\n      // There is already an active plan, cannot start new request\n      return false\n    }\n\n    // Clear input and set to disabled state\n    this.emitChatInputClear()\n\n    // Cache UI state data first\n    const uiStatePlanId = this.state.activePlanId ?? 'ui-state'\n    this.setCachedUIState(uiStatePlanId, { enabled: false, placeholder: 'Processing...' })\n    this.emitChatInputUpdateState(uiStatePlanId)\n\n    return true\n  }\n\n  /**\n   * Send user message and set plan ID\n   */\n  private async sendUserMessageAndSetPlanId(query: string): Promise<any> {\n    try {\n      // Use direct execution mode API to send message\n      const response = await DirectApiService.sendMessage({\n        input: query\n      })\n\n      if (response?.planId) {\n        this.state.activePlanId = response.planId\n        return response\n      } else if (response?.planTemplateId) {\n        // If response contains planTemplateId instead of planId\n        this.state.activePlanId = response.planTemplateId\n        return { ...response, planId: response.planTemplateId }\n      }\n\n      console.error('[PlanExecutionManager] Failed to get planId from response:', response)\n      throw new Error('Failed to get valid planId from API response')\n    } catch (error: any) {\n      console.error('[PlanExecutionManager] API call failed:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Start plan execution sequence\n   */\n  public initiatePlanExecutionSequence(query: string, planId: string): void {\n    console.log(`[PlanExecutionManager] Starting plan execution sequence for query: \"${query}\", planId: ${planId}`)\n\n    // Use planId as rootPlanId for now (assume they are the same initially)\n    const rootPlanId = planId\n\n    // Mark task as running in task store\n    import('@/stores/task').then(({ useTaskStore }) => {\n      const taskStore = useTaskStore()\n      taskStore.setTaskRunning(planId)\n      console.log('[PlanExecutionManager] Task marked as running with planId:', planId)\n    })\n\n    // Try to emit dialog start\n    this.emitDialogRoundStart(rootPlanId)\n\n    this.startPolling()\n  }\n\n  /**\n   * Handle plan completion common logic\n   */\n  private handlePlanCompletion(details: PlanExecutionRecord): void {\n    this.emitPlanCompleted(details.rootPlanId ?? \"\");\n    this.state.lastSequenceSize = 0\n    this.stopPolling()\n\n    // Mark task as no longer running\n    import('@/stores/task').then(({ useTaskStore }) => {\n      const taskStore = useTaskStore()\n      if (taskStore.currentTask && taskStore.currentTask.isRunning) {\n        taskStore.currentTask.isRunning = false\n        console.log('[PlanExecutionManager] Task marked as completed')\n      }\n    })\n\n    // Delay deletion of plan execution record\n    try {\n      setTimeout(async () => {\n        if (this.state.activePlanId) {\n          try {\n            await PlanActApiService.deletePlanTemplate(this.state.activePlanId)\n            console.log(`[PlanExecutionManager] Plan template ${this.state.activePlanId} deleted successfully`)\n          } catch (error: any) {\n            console.log(`Delete plan execution record failed: ${error.message}`)\n          }\n        }\n      }, 5000)\n    } catch (error: any) {\n      console.log(`Delete plan execution record failed: ${error.message}`)\n    }\n\n    if (details.completed) {\n      this.state.activePlanId = null\n      this.emitChatInputUpdateState(details.rootPlanId ?? \"\");\n    }\n  }\n\n  private handlePlanError(details: PlanExecutionRecord): void {\n    this.emitPlanError(details.message ?? \"\");\n    this.state.lastSequenceSize = 0\n    this.stopPolling()\n\n    // Mark task as no longer running\n    import('@/stores/task').then(({ useTaskStore }) => {\n      const taskStore = useTaskStore()\n      if (taskStore.currentTask && taskStore.currentTask.isRunning) {\n        taskStore.currentTask.isRunning = false\n        console.log('[PlanExecutionManager] Task marked as stopped due to error')\n      }\n    })\n\n    // Delay deletion of plan execution record\n    try {\n      setTimeout(async () => {\n        if (this.state.activePlanId) {\n          try {\n            await PlanActApiService.deletePlanTemplate(this.state.activePlanId)\n            console.log(`[PlanExecutionManager] Plan template ${this.state.activePlanId} deleted successfully`)\n          } catch (error: any) {\n            console.log(`Delete plan execution record failed: ${error.message}`)\n          }\n        }\n      }, 5000)\n    } catch (error: any) {\n      console.log(`Delete plan execution record failed: ${error.message}`)\n    }\n  }\n\n  /**\n   * Poll plan execution status\n   */\n  private async pollPlanStatus(): Promise<void> {\n    if (!this.state.activePlanId) return\n\n    if (this.state.isPolling) {\n      console.log('[PlanExecutionManager] Previous polling still in progress, skipping')\n      return\n    }\n\n    try {\n      this.state.isPolling = true\n\n      // Here we need to implement the API call to get plan details\n      // Since the original code calls ManusAPI.getDetails, we need to use the existing API services\n      // For now, we'll use the relevant methods of PlanActApiService\n      const details = await this.getPlanDetails(this.state.activePlanId)\n\n      if (!details) {\n        console.warn('[PlanExecutionManager] No details received from API - this might be a temporary network issue')\n        return\n      }\n\n      // Only handle actual plan execution failures, not network errors\n      if(details.status && details.status === 'failed' && details.message && !details.message.includes('Failed to get detailed information')){\n        this.handlePlanError(details)\n        return;\n      }\n\n      // Update cache with latest plan details if rootPlanId exists\n      if (details.rootPlanId) {\n        this.setCachedPlanRecord(details.rootPlanId, details)\n      }\n\n\n\n      this.emitPlanUpdate(details.rootPlanId ?? \"\");\n\n      if (details.completed) {\n        this.handlePlanCompletion(details)\n      }\n    } catch (error: any) {\n      console.error('[PlanExecutionManager] Failed to poll plan status:', error)\n    } finally {\n      this.state.isPolling = false\n    }\n  }\n\n  /**\n   * Get plan details (needs to be adjusted based on actual API)\n   */\n  private async getPlanDetails(planId: string): Promise<PlanExecutionRecord | null> {\n    try {\n      // Use CommonApiService's getDetails method\n      const details = await CommonApiService.getDetails(planId)\n\n      // Cache the plan execution record by rootPlanId if it exists\n      if (details?.rootPlanId) {\n        this.planExecutionCache.set(details.rootPlanId, details)\n        console.log(`[PlanExecutionManager] Cached plan execution record for rootPlanId: ${details.rootPlanId}`)\n      }\n\n      return details\n    } catch (error: any) {\n      console.error('[PlanExecutionManager] Failed to get plan details:', error)\n      return {\n        currentPlanId: planId,\n        status: 'failed',\n        message: error instanceof Error ? error.message : 'Failed to get plan'\n      }\n    }\n  }\n\n  /**\n   * Start polling plan execution status\n   */\n  public startPolling(): void {\n    if (this.state.pollTimer) {\n      clearInterval(this.state.pollTimer)\n    }\n\n    this.state.pollTimer = window.setInterval(() => {\n      this.pollPlanStatus()\n    }, this.POLL_INTERVAL)\n\n    console.log('[PlanExecutionManager] Started polling')\n  }\n\n  /**\n   * Immediately poll plan execution status (for manual refresh trigger)\n   */\n  public async pollPlanStatusImmediately(): Promise<void> {\n    console.log('[PlanExecutionManager] Polling plan status immediately')\n    await this.pollPlanStatus()\n  }\n\n  /**\n   * Stop polling\n   */\n  public stopPolling(): void {\n    if (this.state.pollTimer) {\n      clearInterval(this.state.pollTimer)\n      this.state.pollTimer = null\n    }\n    console.log('[PlanExecutionManager] Stopped polling')\n  }\n\n  /**\n   * Clean up resources\n   */\n  public cleanup(): void {\n    this.stopPolling()\n    this.state.activePlanId = null\n    this.state.lastSequenceSize = 0\n    this.state.isPolling = false\n\n    // Clear all cached plan execution records\n    this.clearAllCachedRecords()\n  }\n\n  // Event emission helpers - Use callback functions instead of window events\n  private emitChatInputClear(): void {\n    if (this.callbacks.onChatInputClear) {\n      this.callbacks.onChatInputClear()\n    }\n  }\n\n  private emitChatInputUpdateState(rootPlanId: string): void {\n    if (this.callbacks.onChatInputUpdateState) {\n      this.callbacks.onChatInputUpdateState(rootPlanId)\n    }\n  }\n\n  private emitDialogRoundStart(rootPlanId: string): void {\n    if (this.callbacks.onDialogRoundStart) {\n      this.callbacks.onDialogRoundStart(rootPlanId)\n    }\n  }\n\n  private emitPlanUpdate(rootPlanId: string): void {\n    if (this.callbacks.onPlanUpdate) {\n      this.callbacks.onPlanUpdate(rootPlanId)\n    }\n  }\n\n  private emitPlanCompleted(rootPlanId: string): void {\n    if (this.callbacks.onPlanCompleted) {\n      this.callbacks.onPlanCompleted(rootPlanId)\n    }\n  }\n\n  private emitPlanError(message: string): void {\n    if (this.callbacks.onPlanError) {\n      this.callbacks.onPlanError(message)\n    }\n  }\n}\n\n// Export singleton instance\nexport const planExecutionManager = PlanExecutionManager.getInstance()\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"chat-container\">\n    <!-- Messages container -->\n    <div \n      class=\"messages\" \n      ref=\"messagesRef\" \n      @scroll=\"handleScroll\"\n      @click=\"handleMessageContainerClick\"\n    >\n      <!-- Message list -->\n      <ChatMessage\n        v-for=\"message in compatibleMessages\"\n        :key=\"message.id\"\n        :message=\"message\"\n        :is-streaming=\"isMessageStreaming(message.id)\"\n        @copy=\"handleCopyMessage\"\n        @regenerate=\"handleRegenerateMessage\"\n        @retry=\"handleRetryMessage\"\n        @step-selected=\"handleStepSelected\"\n      />\n      \n      <!-- Loading indicator -->\n      <div v-if=\"isLoading\" class=\"loading-message\">\n        <div class=\"loading-content\">\n          <Icon icon=\"carbon:circle-dash\" class=\"loading-icon\" />\n          <span>{{ $t('chat.processing') }}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Scroll to bottom button -->\n    <Transition name=\"scroll-button\">\n      <button\n        v-if=\"showScrollToBottom\"\n        class=\"scroll-to-bottom\"\n        @click=\"() => scrollToBottom()\"\n        :title=\"$t('chat.scrollToBottom')\"\n      >\n        <Icon icon=\"carbon:chevron-down\" />\n      </button>\n    </Transition>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, onMounted, onUnmounted, nextTick, computed } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\n\n// Import new modular components\nimport ChatMessage from './ChatMessage.vue'\n\n// Import composables\nimport { useChatMessages, convertMessageToCompatible } from './composables/useChatMessages'\nimport { useScrollBehavior } from './composables/useScrollBehavior'\n\n// Import plan execution manager\nimport { planExecutionManager } from '@/utils/plan-execution-manager'\n\ninterface Props {\n}\n\ninterface Emits {\n  (e: 'step-selected', stepId: string): void\n}\n\n// InputMessage interface removed - not needed in display component\n\nwithDefaults(defineProps<Props>(), {\n})\n\nconst emit = defineEmits<Emits>()\n\n// Initialize composables\nconst { t } = useI18n()\n\n// Chat messages state\nconst {\n  messages,\n  isLoading,\n  streamingMessageId,\n  addMessage,\n  updateMessage,\n  startStreaming,\n  stopStreaming,\n  findMessage\n} = useChatMessages()\n\n// Scroll behavior\nconst messagesRef = ref<HTMLElement | null>(null)\nconst {\n  scrollToBottom,\n  autoScrollToBottom,\n  showScrollToBottom\n} = useScrollBehavior(messagesRef)\n\n// Local state\nconst pollingInterval = ref<number>()\n\n// Computed properties\nconst isMessageStreaming = (messageId: string) => {\n  return streamingMessageId.value === messageId\n}\n\n// Convert messages to compatible format for ChatMessage component\nconst compatibleMessages = computed(() => {\n  return messages.value.map(convertMessageToCompatible)\n})\n\n// Event handlers\nconst handleScroll = () => {\n  // Scroll behavior is handled by useScrollBehavior composable\n}\n\nconst handleMessageContainerClick = (event: Event) => {\n  // Handle markdown copy buttons and other click events\n  const target = event.target as HTMLElement\n  \n  if (target.classList.contains('md-copy-btn')) {\n    const rawText = target.getAttribute('data-raw')\n    if (rawText) {\n      const text = decodeURIComponent(rawText)\n      navigator.clipboard.writeText(text).then(() => {\n        // Show copy feedback\n        target.textContent = t('chat.copied')\n        setTimeout(() => {\n          target.textContent = t('chat.copy')\n        }, 1000)\n      })\n    }\n  }\n}\n\nconst handleCopyMessage = async (messageId: string) => {\n  const message = findMessage(messageId)\n  if (!message) return\n  \n  try {\n    // Strip HTML tags for clipboard\n    const plainText = message.content.replace(/<[^>]*>/g, '')\n    await navigator.clipboard.writeText(plainText)\n    // Could add toast notification here\n  } catch (error) {\n    console.error('Failed to copy message:', error)\n  }\n}\n\nconst handleRegenerateMessage = (messageId: string) => {\n  // Implementation for regenerating assistant response\n  const message = findMessage(messageId)\n  if (message && message.type === 'assistant') {\n    // Reset message content and restart generation\n    updateMessage(messageId, {\n      content: ''\n    })\n    startStreaming(messageId)\n    // Trigger regeneration logic here\n  }\n}\n\nconst handleRetryMessage = (messageId: string) => {\n  // Implementation for retrying failed message\n  const message = findMessage(messageId)\n  if (message) {\n    updateMessage(messageId, {\n      content: ''\n    })\n    startStreaming(messageId)\n    // Trigger retry logic here\n  }\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[ChatContainer] Step selected:', stepId)\n  emit('step-selected', stepId)\n}\n\n// Message handling methods removed - ChatContainer is now a pure display component\n\n// Plan execution handlers\nconst handlePlanUpdate = (rootPlanId: string) => {\n  console.log('[ChatContainer] Plan update received:', rootPlanId)\n  \n  // Get the PlanExecutionRecord from the cache\n  const planDetails = planExecutionManager.getCachedPlanRecord(rootPlanId)\n  \n  if (!planDetails) {\n    console.warn('[ChatContainer] No cached plan data found for rootPlanId:', rootPlanId)\n    return\n  }\n  \n  console.log('[ChatContainer] Retrieved plan details from cache:', planDetails)\n  \n  // Find the corresponding message\n  const messageIndex = messages.value.findIndex(\n    m => m.planExecution?.currentPlanId === planDetails.currentPlanId && m.type === 'assistant'\n  )\n  \n  if (messageIndex !== -1) {\n    const message = messages.value[messageIndex]\n    \n    // Update planExecution data using updateMessage\n    const updates: any = {\n      planExecution: JSON.parse(JSON.stringify(planDetails))\n    }\n    \n    // Handle simple responses (cases without agent execution sequence)\n    if (!planDetails.agentExecutionSequence || planDetails.agentExecutionSequence.length === 0) {\n      console.log('[ChatContainer] Handling simple response without agent execution sequence')\n      \n      if (planDetails.completed) {\n        // Clear thinking state and set final response\n        updates.thinking = ''\n        const finalResponse = planDetails.summary ?? planDetails.result ?? planDetails.message ?? 'Execution completed'\n        updates.content = finalResponse\n        console.log('[ChatContainer] Set simple response content:', finalResponse)\n      }\n    } else {\n      console.log('[ChatContainer] Handling detailed plan with agent execution sequence')\n      // This is a detailed plan with execution steps, keep the plan execution display\n    }\n    \n    // Update the message\n    updateMessage(message.id, updates)\n  }\n}\n\nconst handlePlanCompleted = (planDetails: any) => {\n  console.log('[ChatContainer] Plan completed:', planDetails)\n  \n  if (planDetails.rootPlanId) {\n    const messageIndex = messages.value.findIndex(\n      m => m.planExecution?.currentPlanId === planDetails.rootPlanId\n    )\n    \n    if (messageIndex !== -1) {\n      const message = messages.value[messageIndex]\n      \n      const summary = planDetails.summary ?? planDetails.result ?? 'Execution completed'\n      updateMessage(message.id, {\n        thinking: '',\n        content: summary\n      })\n      console.log('[ChatContainer] Updated completed message:', summary)\n    }\n  }\n}\n\nconst handleDialogRoundStart = (planId: string) => {\n  console.log('[ChatContainer] Dialog round start:', planId)\n  // This method can be used to initialize plan execution state\n}\n\nconst handlePlanError = (message: string) => {\n  console.log('[ChatContainer] Plan error:', message)\n  \n  // Show error message\n  addMessage('assistant', `Error: ${message}`)\n  console.error('[ChatContainer] Plan execution error:', message)\n}\n\n// Scroll handlers (remove unused function)\n\n// Lifecycle\nonMounted(() => {\n  // Initial prompt processing removed - handled by parent component\n\n  // Auto-scroll to bottom when new messages are added\n  watch(messages, () => {\n    nextTick(() => {\n      autoScrollToBottom()\n    })\n  }, { deep: true })\n\n  // Register plan execution callbacks\n  planExecutionManager.setEventCallbacks({\n    onPlanUpdate: handlePlanUpdate,\n    onPlanCompleted: handlePlanCompleted,\n    onDialogRoundStart: handleDialogRoundStart,\n    onPlanError: handlePlanError\n  })\n})\n\nonUnmounted(() => {\n  if (pollingInterval.value) {\n    clearInterval(pollingInterval.value)\n  }\n})\n\n// Expose methods for parent components\ndefineExpose({\n  scrollToBottom,\n  handlePlanUpdate,\n  handlePlanCompleted,\n  handleDialogRoundStart,\n  handlePlanError,\n  addMessage,\n  updateMessage,\n  startStreaming,\n  stopStreaming\n})\n</script>\n\n<style lang=\"less\" scoped>\n.chat-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  position: relative;\n  background: #1a1a1a;\n  \n  .messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 20px;\n    scroll-behavior: smooth;\n    \n    // Custom scrollbar\n    &::-webkit-scrollbar {\n      width: 6px;\n    }\n    \n    &::-webkit-scrollbar-track {\n      background: rgba(255, 255, 255, 0.1);\n      border-radius: 3px;\n    }\n    \n    &::-webkit-scrollbar-thumb {\n      background: rgba(255, 255, 255, 0.3);\n      border-radius: 3px;\n      \n      &:hover {\n        background: rgba(255, 255, 255, 0.5);\n      }\n    }\n  }\n  \n  .loading-message {\n    display: flex;\n    justify-content: center;\n    padding: 20px;\n    \n    .loading-content {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      color: #aaaaaa;\n      font-size: 14px;\n      \n      .loading-icon {\n        font-size: 16px;\n        animation: spin 1s linear infinite;\n      }\n    }\n  }\n  \n  .scroll-to-bottom {\n    position: absolute;\n    bottom: 30px;\n    right: 30px;\n    width: 40px;\n    height: 40px;\n    background: rgba(79, 70, 229, 0.9);\n    border: none;\n    border-radius: 50%;\n    color: #ffffff;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    transition: all 0.2s ease;\n    z-index: 10;\n    \n    &:hover {\n      background: rgba(79, 70, 229, 1);\n      transform: scale(1.1);\n    }\n    \n    svg {\n      font-size: 20px;\n    }\n  }\n}\n\n// Transitions\n.scroll-button-enter-active,\n.scroll-button-leave-active {\n  transition: all 0.3s ease;\n}\n\n.scroll-button-enter-from,\n.scroll-button-leave-to {\n  opacity: 0;\n  transform: translateY(20px) scale(0.8);\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@media (max-width: 768px) {\n  .chat-container {\n    .messages {\n      padding: 16px;\n    }\n    \n    .scroll-to-bottom {\n      bottom: 20px;\n      right: 20px;\n      width: 36px;\n      height: 36px;\n      \n      svg {\n        font-size: 18px;\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"input-area\">\n    <!-- File upload component at the top, full width -->\n    <FileUploadComponent\n      ref=\"fileUploadRef\"\n      :disabled=\"isDisabled\"\n      @files-uploaded=\"handleFilesUploaded\"\n      @files-removed=\"handleFilesRemoved\"\n      @upload-key-changed=\"handleUploadKeyChanged\"\n      @upload-started=\"handleUploadStarted\"\n      @upload-completed=\"handleUploadCompleted\"\n      @upload-error=\"handleUploadError\"\n    />\n    \n    <div class=\"input-container\">\n      <textarea\n        v-model=\"currentInput\"\n        ref=\"inputRef\"\n        class=\"chat-input\"\n        :placeholder=\"currentPlaceholder\"\n        :disabled=\"isDisabled\"\n        @keydown=\"handleKeydown\"\n        @input=\"adjustInputHeight\"\n      ></textarea>\n      <button class=\"plan-mode-btn\" :title=\"$t('input.planMode')\" @click=\"handlePlanModeClick\">\n        <Icon icon=\"carbon:document\" />\n        {{ $t('input.planMode') }}\n      </button>\n      <button\n        v-if=\"!isTaskRunning\"\n        class=\"send-button\"\n        :disabled=\"!currentInput.trim() || isDisabled\"\n        @click=\"handleSend\"\n        :title=\"$t('input.send')\"\n      >\n        <Icon icon=\"carbon:send-alt\" />\n        {{ $t('input.send') }}\n      </button>\n      <button\n        v-else\n        class=\"send-button stop-button\"\n        @click=\"handleStop\"\n        :title=\"$t('input.stop')\"\n      >\n        <Icon icon=\"carbon:stop-filled\" />\n        {{ $t('input.stop') }}\n      </button>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, nextTick, onMounted, onUnmounted, computed, watch } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { useI18n } from 'vue-i18n'\nimport { memoryStore } from \"@/stores/memory\"\nimport type { InputMessage } from \"@/stores/memory\"\nimport { FileInfo } from \"@/api/file-upload-api-service\"\nimport FileUploadComponent from \"@/components/file-upload/FileUploadComponent.vue\"\nimport { useTaskStore } from '@/stores/task'\n\nconst { t } = useI18n()\nconst taskStore = useTaskStore()\n\n// Track if task is running\nconst isTaskRunning = computed(() => taskStore.hasRunningTask())\n\ninterface Props {\n  placeholder?: string\n  disabled?: boolean\n  initialValue?: string\n}\n\ninterface Emits {\n  (e: 'send', message: InputMessage): void\n  (e: 'clear'): void\n  (e: 'update-state', enabled: boolean, placeholder?: string): void\n  (e: 'plan-mode-clicked'): void\n}\n\n\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: '',\n  disabled: false,\n  initialValue: '',\n})\n\nconst emit = defineEmits<Emits>()\n\nconst inputRef = ref<HTMLTextAreaElement>()\nconst fileUploadRef = ref<InstanceType<typeof FileUploadComponent>>()\nconst currentInput = ref('')\nconst defaultPlaceholder = computed(() => props.placeholder || t('input.placeholder'))\nconst currentPlaceholder = ref(defaultPlaceholder.value)\nconst uploadedFiles = ref<string[]>([])\nconst uploadKey = ref<string | null>(null)\n\n// Function to reset session when starting a new conversation session\nconst resetSession = () => {\n  console.log('[FileUpload] Resetting session and clearing uploadKey')\n  fileUploadRef.value?.resetSession()\n}\n\n// Auto-reset session when component is unmounted to prevent memory leaks\nonUnmounted(() => {\n  resetSession()\n})\n// File upload event handlers\nconst handleFilesUploaded = (files: FileInfo[], key: string | null) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  uploadKey.value = key\n  console.log('[InputArea] Files uploaded:', files.length, 'uploadKey:', key)\n  \n  // Update placeholder to show files are attached\n  if (uploadedFiles.value.length > 0) {\n    currentPlaceholder.value = t('input.filesAttached', { count: uploadedFiles.value.length })\n  }\n}\n\nconst handleFilesRemoved = (files: FileInfo[]) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  console.log('[InputArea] Files removed, remaining:', files.length)\n  \n  // Update placeholder\n  if (uploadedFiles.value.length === 0) {\n    currentPlaceholder.value = defaultPlaceholder.value\n  } else {\n    currentPlaceholder.value = t('input.filesAttached', { count: uploadedFiles.value.length })\n  }\n}\n\nconst handleUploadKeyChanged = (key: string | null) => {\n  uploadKey.value = key\n  console.log('[InputArea] Upload key changed:', key)\n}\n\nconst handleUploadStarted = () => {\n  console.log('[InputArea] Upload started')\n}\n\nconst handleUploadCompleted = () => {\n  console.log('[InputArea] Upload completed')\n}\n\nconst handleUploadError = (error: any) => {\n  console.error('[InputArea] Upload error:', error)\n}\n\n// Computed property to ensure 'disabled' is a boolean type\nconst isDisabled = computed(() => Boolean(props.disabled))\n\nconst adjustInputHeight = () => {\n  nextTick(() => {\n    if (inputRef.value) {\n      inputRef.value.style.height = 'auto'\n      inputRef.value.style.height = Math.min(inputRef.value.scrollHeight, 120) + 'px'\n    }\n  })\n}\n\nconst handleKeydown = (event: KeyboardEvent) => {\n  if (event.key === 'Enter' && !event.shiftKey) {\n    event.preventDefault()\n    handleSend()\n  }\n}\n\nconst handleSend = () => {\n  if (!currentInput.value.trim() || isDisabled.value) return\n\n  const finalInput = currentInput.value.trim()\n\n  const query: InputMessage = {\n    input: finalInput,\n    memoryId: memoryStore.selectMemoryId,\n    uploadedFiles: uploadedFiles.value\n  }\n  \n  // Add uploadKey if it exists\n  if (uploadKey.value) {\n    query.uploadKey = uploadKey.value\n    console.log('[InputArea] Including uploadKey in message:', uploadKey.value)\n  } else {\n    console.log('[InputArea] No uploadKey available for message')\n  }\n\n  // Use Vue's emit to send a message\n  emit('send', query)\n\n  // Clear the input but keep uploaded files and uploadKey for follow-up conversations\n  clearInput()\n}\n\nconst handlePlanModeClick = () => {\n  // Trigger the plan mode toggle event\n  emit('plan-mode-clicked')\n}\n\nconst handleStop = async () => {\n  console.log('[InputArea] Stop button clicked')\n  const success = await taskStore.stopCurrentTask()\n  if (success) {\n    console.log('[InputArea] Task stopped successfully')\n  } else {\n    console.error('[InputArea] Failed to stop task')\n  }\n}\n\n\n/**\n * Clear the input box\n */\nconst clearInput = () => {\n  currentInput.value = ''\n  adjustInputHeight()\n  emit('clear')\n}\n\n/**\n * Update the state of the input area (enable/disable)\n * @param {boolean} enabled - Whether to enable input\n * @param {string} [placeholder] - Placeholder text when enabled\n */\nconst updateState = (enabled: boolean, placeholder?: string) => {\n  if (placeholder) {\n    currentPlaceholder.value = enabled ? placeholder : t('input.waiting')\n  }\n  emit('update-state', enabled, placeholder)\n}\n\n/**\n * Set the input value without triggering send\n * @param {string} value - The value to set\n */\nconst setInputValue = (value: string) => {\n  currentInput.value = value\n  adjustInputHeight()\n}\n\n/**\n * Get the current value of the input box\n * @returns {string} The text value of the current input box (trimmed)\n */\nconst getQuery = () => {\n  return currentInput.value.trim()\n}\n\n// Watch for initialValue changes\nwatch(\n  () => props.initialValue,\n  (newValue) => {\n    if (newValue.trim()) {\n      currentInput.value = newValue\n      adjustInputHeight()\n    }\n  },\n  { immediate: true }\n)\n\n// Expose methods to the parent component\ndefineExpose({\n  clearInput,\n  updateState,\n  setInputValue,\n  getQuery,\n  resetSession,\n  focus: () => inputRef.value?.focus(),\n  get uploadedFiles() { return fileUploadRef.value?.uploadedFiles?.map(f => f.originalName) || [] },\n  get uploadKey() { return fileUploadRef.value?.uploadKey || null }\n})\n\nonMounted(() => {\n  // Initialization logic after component mounting\n})\n\nonUnmounted(() => {\n  // Cleanup logic before component unmounting\n})\n</script>\n\n<style lang=\"less\" scoped>\n.input-area {\n  min-height: 112px;\n  padding: 10px 12px;\n  border-top: 1px solid #1a1a1a;\n  background: rgba(255, 255, 255, 0.02);\n  /* Ensure the input area is always at the bottom */\n  flex-shrink: 0; /* Won't be compressed */\n  position: sticky; /* Fixed at the bottom */\n  bottom: 0;\n  z-index: 100;\n  /* Add a slight shadow to distinguish the message area */\n  box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);\n  backdrop-filter: blur(20px);\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.input-container {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  padding: 12px 16px;\n\n  &:focus-within {\n    border-color: #667eea;\n  }\n}\n\n\n.chat-input {\n  flex: 1;\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #ffffff;\n  font-size: 14px;\n  line-height: 1.5;\n  resize: none;\n  min-height: 20px;\n  max-height: 120px;\n\n  &::placeholder {\n    color: #666666;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n\n    &::placeholder {\n      color: #444444;\n    }\n  }\n}\n\n.plan-mode-btn {\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 6px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: #667eea;\n    transform: translateY(-1px);\n  }\n}\n\n.send-button {\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 6px 12px;\n  border: none;\n  border-radius: 6px;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover:not(:disabled) {\n    transform: translateY(-1px);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n  \n  &.stop-button {\n    background: linear-gradient(135deg, #f56565 0%, #c53030 100%);\n    \n    &:hover {\n      background: linear-gradient(135deg, #fc8181 0%, #e53e3e 100%);\n    }\n  }\n}\n\n.clear-memory-btn{\n  width: 1.5em;\n  height: 1.5em;\n}\n\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { CronConfig } from '@/types/cron-task'\n\nexport class CronApiService {\n  private static readonly BASE_URL = '/api/cron-tasks'\n\n  /**\n   * Get all cron tasks\n   */\n  static async getAllCronTasks(): Promise<CronConfig[]> {\n    try {\n      const response = await fetch(this.BASE_URL)\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to get cron tasks:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get cron task by ID\n   */\n  static async getCronTaskById(id: string): Promise<CronConfig> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${id}`)\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to get cron task by id:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Create cron task\n   */\n  static async createCronTask(cronConfig: CronConfig): Promise<CronConfig> {\n    try {\n      const response = await fetch(this.BASE_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(cronConfig),\n      })\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to create cron task:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Update cron task\n   */\n  static async updateCronTask(id: number, cronConfig: CronConfig): Promise<CronConfig> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(cronConfig),\n      })\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to update cron task:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Update task status\n   */\n  static async updateTaskStatus(id: string, status: number): Promise<void> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${id}/status?status=${status}`, {\n        method: 'PUT',\n      })\n      await this.handleResponse(response)\n    } catch (error) {\n      console.error('Failed to update task status:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Delete cron task\n   */\n  static async deleteCronTask(id: string): Promise<void> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${id}`, {\n        method: 'DELETE',\n      })\n      await this.handleResponse(response)\n    } catch (error) {\n      console.error('Failed to delete cron task:', error)\n      throw error\n    }\n  }\n\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message || `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n}\n\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { CronConfig } from '@/types/cron-task'\nimport { CronApiService } from '@/api/cron-api-service'\n\n/**\n * CronTask utility functions collection\n * Provides common functionality related to scheduled tasks\n */\nexport const CronTaskUtils = {\n  /**\n   * Validate Cron expression format\n   * @param cronExpr Cron expression\n   * @returns Whether it's valid\n   */\n  validateCronExpression(cronExpr: string): boolean {\n    // Simple validation: check if there are 5-6 space-separated parts\n    const parts = cronExpr.trim().split(/\\s+/)\n    return parts.length >= 5 && parts.length <= 6\n  },\n\n  /**\n   * Format time\n   * @param timeString Time string\n   * @returns Formatted time string\n   */\n  formatTime(timeString: string): string {\n    return new Date(timeString).toLocaleString()\n  },\n\n  /**\n   * Save scheduled task\n   * @param task Task object\n   * @returns Save result\n   */\n  async saveTask(task: CronConfig): Promise<CronConfig> {\n    try {\n      let result: CronConfig\n\n      if (task.id) {\n        // Update existing task\n        result = await CronApiService.updateCronTask(Number(task.id), task)\n      } else {\n        // Create new task\n        result = await CronApiService.createCronTask(task)\n      }\n\n      return result\n    } catch (error) {\n      console.error('Failed to save cron task:', error)\n      throw error\n    }\n  },\n\n  /**\n   * Delete scheduled task\n   * @param taskId Task ID\n   */\n  async deleteTask(taskId: string | number): Promise<void> {\n    try {\n      await CronApiService.deleteCronTask(String(taskId))\n    } catch (error) {\n      console.error('Failed to delete cron task:', error)\n      throw error\n    }\n  },\n\n  /**\n   * Toggle task status\n   * @param task Task object\n   * @returns Updated task\n   */\n  async toggleTaskStatus(task: CronConfig): Promise<CronConfig> {\n    if (!task.id) {\n      throw new Error('Task ID is required')\n    }\n\n    const newStatus = task.status === 0 ? 1 : 0\n    return await CronApiService.updateCronTask(Number(task.id), { ...task, status: newStatus })\n  },\n\n  /**\n   * Prepare task execution data\n   * @param task Task object\n   * @returns Execution data object\n   */\n  prepareTaskExecution(task: CronConfig): { useTemplate: boolean; planData?: any; taskContent?: string } {\n    if (task.planTemplateId) {\n      // Execute using template\n      return {\n        useTemplate: true,\n        planData: {\n          title: task.cronName || 'Scheduled Task Execution',\n          planData: {\n            id: task.planTemplateId,\n            planTemplateId: task.planTemplateId,\n            planId: task.planTemplateId\n          },\n          params: task.executionParams || undefined\n        }\n      }\n    } else {\n      // Execute task content directly\n      return {\n        useTemplate: false,\n        taskContent: task.planDesc || task.cronName || ''\n      }\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Teleport to=\"body\">\n    <Transition name=\"modal\">\n      <div v-if=\"modelValue\" class=\"modal-overlay\" @click=\"handleOverlayClick\">\n        <div class=\"modal-container\" @click.stop>\n          <div class=\"modal-header\">\n            <h3>{{ $t('cronTask.taskDetail') }}</h3>\n            <div class=\"header-actions\">\n              <div class=\"status-switch\">\n                <span class=\"status-label\">{{ $t('cronTask.taskStatus') }}</span>\n                <label class=\"toggle-switch\">\n                  <input type=\"checkbox\" :checked=\"formData.status === 0\" @change=\"formData.status = formData.status === 0 ? 1 : 0\">\n                  <span class=\"toggle-slider\"></span>\n                </label>\n              </div>\n              <button class=\"close-btn\" @click=\"$emit('update:modelValue', false)\">\n                <Icon icon=\"carbon:close\" />\n              </button>\n            </div>\n          </div>\n          <div class=\"modal-content\">\n            <form @submit.prevent=\"handleSave\" class=\"task-form\">\n              <!-- Task Name -->\n              <div class=\"form-group\">\n                <label class=\"form-label\">{{ $t('cronTask.taskName') }}</label>\n                <input\n                  v-model=\"formData.cronName\"\n                  type=\"text\"\n                  class=\"form-input\"\n                  :placeholder=\"$t('cronTask.taskNamePlaceholder')\"\n                  required\n                />\n              </div>\n\n              <!-- Cron Expression -->\n              <div class=\"form-group\">\n                <label class=\"form-label\">{{ $t('cronTask.cronExpression') }}</label>\n                <input\n                  v-model=\"formData.cronTime\"\n                  type=\"text\"\n                  class=\"form-input\"\n                  :placeholder=\"$t('cronTask.cronExpressionPlaceholder')\"\n                  required\n                />\n                <div class=\"form-help\">\n                  {{ $t('cronTask.cronExpressionHelp') }}\n                </div>\n              </div>\n\n              <!-- Task Description -->\n              <div class=\"form-group\">\n                <label class=\"form-label\">{{ $t('cronTask.taskDescription') }}</label>\n                <textarea\n                  v-model=\"formData.planDesc\"\n                  class=\"form-textarea\"\n                  :placeholder=\"$t('cronTask.taskDescriptionPlaceholder')\"\n                  rows=\"4\"\n                  required\n                ></textarea>\n              </div>\n\n              <!-- Plan Template Association -->\n              <div class=\"form-group\">\n                <label class=\"form-label\">{{ $t('cronTask.planTemplate') }}</label>\n                <div class=\"template-toggle\">\n                  <button\n                    type=\"button\"\n                    :class=\"['template-btn', formData.linkTemplate ? 'active' : '']\"\n                    @click=\"formData.linkTemplate = true\"\n                  >\n                    <Icon icon=\"carbon:checkmark\" />\n                    {{ $t('cronTask.linkTemplate') }}\n                  </button>\n                  <button\n                    type=\"button\"\n                    :class=\"['template-btn', !formData.linkTemplate ? 'active' : '']\"\n                    @click=\"handleDisableLinkTemplate\"\n                  >\n                    <Icon icon=\"carbon:close\" />\n                    {{ $t('cronTask.noTemplate') }}\n                  </button>\n                </div>\n                <div v-if=\"formData.linkTemplate\" class=\"template-selector\">\n                  <select\n                    v-model=\"formData.templateId\"\n                    class=\"form-select\"\n                  >\n                    <option value=\"\">{{ $t('cronTask.selectTemplate') }}</option>\n                    <option v-for=\"template in templates\" :key=\"template.id\" :value=\"template.id\">\n                      {{ template.name }}\n                    </option>\n                  </select>\n                  <div class=\"form-help\">\n                    {{ $t('cronTask.templateHelpText') }}\n                  </div>\n                </div>\n              </div>\n\n              <!-- Task Information (Read-only) -->\n              <div v-if=\"task?.createTime\" class=\"form-group\">\n                <div class=\"time-info\">\n                  <span class=\"time-label\">{{ $t('cronTask.createTime') }}:</span>\n                  <span class=\"time-value\">{{ formatTime(task.createTime) }}</span>\n                </div>\n              </div>\n\n              <div v-if=\"task?.updateTime\" class=\"form-group\">\n                <div class=\"time-info\">\n                  <span class=\"time-label\">{{ $t('cronTask.updateTime') }}:</span>\n                  <span class=\"time-value\">{{ formatTime(task.updateTime) }}</span>\n                </div>\n              </div>\n            </form>\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"cancel-btn\" @click=\"$emit('update:modelValue', false)\">\n              {{ $t('common.cancel') }}\n            </button>\n            <button type=\"button\" class=\"save-btn\" @click=\"handleSave\" :disabled=\"saving\">\n              <Icon v-if=\"saving\" icon=\"carbon:loading\" class=\"loading-icon\" />\n              {{ props.task?.id ? $t('common.save') : $t('common.create') }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, onMounted, onUnmounted } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport type { CronConfig } from '@/types/cron-task'\nimport { PlanActApiService } from '@/api/plan-act-api-service'\nimport type { PlanTemplate } from '@/types/plan-template'\nimport { CronTaskUtils } from '@/utils/cron-task-utils'\n\nconst props = defineProps<{\n  modelValue: boolean\n  task: CronConfig | null\n}>()\n\nconst emit = defineEmits<{\n  'update:modelValue': [value: boolean]\n  'save': [task: CronConfig]\n}>()\n\n// State variables\nconst saving = ref(false)\nconst templates = ref<Array<{id: string, name: string}>>([])\n\n// Form data\nconst formData = ref<CronConfig>({\n  cronName: '',\n  cronTime: '',\n  planDesc: '',\n  status: 1,\n  linkTemplate: false,\n  templateId: '',\n  planTemplateId: ''\n})\n\n/**\n * Get template list from API\n */\nconst fetchTemplates = async () => {\n  try {\n    const response = await PlanActApiService.getAllPlanTemplates()\n    if (response?.templates) {\n      templates.value = response.templates.map((template: PlanTemplate) => ({\n        id: template.id,\n        name: template.title ?? 'Unnamed Template'\n      }))\n    }\n  } catch (error) {\n    console.error('Failed to get template list:', error)\n  }\n}\n\n// Handle ESC key to close modal\nconst handleEscKey = (e: KeyboardEvent) => {\n  if (e.key === 'Escape' && props.modelValue) {\n    emit('update:modelValue', false)\n  }\n}\n\nonMounted(() => {\n  fetchTemplates()\n  document.addEventListener('keydown', handleEscKey)\n})\n\nonUnmounted(() => {\n  document.removeEventListener('keydown', handleEscKey)\n})\n\n/**\n * Handle click on modal overlay area\n */\nconst handleOverlayClick = (e: MouseEvent) => {\n  if (e.target === e.currentTarget) {\n    emit('update:modelValue', false)\n  }\n}\n\n/**\n * Disable template linking\n */\nconst handleDisableLinkTemplate = () => {\n  formData.value.linkTemplate = false\n  formData.value.templateId = ''\n  formData.value.planTemplateId = ''\n}\n\n/**\n * Validate form data\n */\nconst validateForm = (): boolean => {\n  // Required field validation\n  if (!formData.value.cronName.trim()) {\n    alert('Task name cannot be empty')\n    return false\n  }\n\n  if (!formData.value.cronTime.trim()) {\n    alert('Cron expression cannot be empty')\n    return false\n  }\n\n  // Validate Cron expression format\n  if (!CronTaskUtils.validateCronExpression(formData.value.cronTime)) {\n    alert('Invalid Cron expression format, should be 5-6 parts separated by spaces')\n    return false\n  }\n\n  if (!formData.value.planDesc.trim()) {\n    alert('Task description cannot be empty')\n    return false\n  }\n\n  // If template linking is selected, template ID cannot be empty\n  if (formData.value.linkTemplate && !formData.value.templateId) {\n    alert('Please select a plan template')\n    return false\n  }\n\n  return true\n}\n\n/**\n * Format time\n */\nconst formatTime = (timeString: string) => {\n  return CronTaskUtils.formatTime(timeString)\n}\n\n/**\n * Save task\n */\nconst handleSave = async () => {\n  if (!validateForm()) return\n\n  saving.value = true\n  try {\n    // Prepare data to save\n    const taskToSave: CronConfig = {\n      ...formData.value,\n      ...(props.task?.id !== undefined && { id: props.task.id }),\n      cronName: formData.value.cronName.trim(),\n      cronTime: formData.value.cronTime.trim(),\n      planDesc: formData.value.planDesc.trim(),\n      status: formData.value.status,\n      planTemplateId: formData.value.linkTemplate ? formData.value.templateId ?? '' : ''\n    }\n\n    // Trigger save event\n    emit('save', taskToSave)\n  } finally {\n    saving.value = false\n  }\n}\n\n// Watch for task changes, update form data\nwatch(\n  () => props.task,\n  (newTask) => {\n    if (newTask) {\n      // Unified handling of template ID field\n      const templateId = newTask.templateId ?? newTask.planTemplateId ?? ''\n\n      formData.value = {\n        cronName: newTask.cronName || '',\n        cronTime: newTask.cronTime || '',\n        planDesc: newTask.planDesc || '',\n        status: newTask.status,\n        linkTemplate: !!templateId,\n        templateId: templateId,\n        planTemplateId: templateId\n      }\n    } else {\n      // Reset form\n      formData.value = {\n        cronName: '',\n        cronTime: '',\n        planDesc: '',\n        status: 1,\n        linkTemplate: false,\n        templateId: '',\n        planTemplateId: ''\n      }\n    }\n  },\n  { immediate: true }\n)\n\n// Reset form when modal closes\nwatch(\n  () => props.modelValue,\n  (newValue) => {\n    if (!newValue) {\n      formData.value = {\n        cronName: '',\n        cronTime: '',\n        planDesc: '',\n        status: 1,\n        linkTemplate: false,\n        templateId: '',\n        planTemplateId: ''\n      }\n    }\n  }\n)\n</script>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.7);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1001;\n}\n\n.modal-container {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.15));\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 16px;\n  width: 90%;\n  max-width: 600px;\n  max-height: 90vh;\n  overflow-y: auto;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 24px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.status-switch {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.status-label {\n  font-size: 14px;\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s;\n}\n\n.close-btn:hover {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.modal-content {\n  padding: 24px;\n}\n\n.task-form {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.form-group {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.form-label {\n  font-size: 14px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input,\n.form-textarea,\n.form-select {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 12px;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  transition: all 0.3s;\n}\n\n.form-input:focus,\n.form-textarea:focus,\n.form-select:focus {\n  outline: none;\n  border-color: rgba(102, 126, 234, 0.5);\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);\n}\n\n.form-input::placeholder,\n.form-textarea::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n\n.form-textarea {\n  resize: vertical;\n  min-height: 80px;\n}\n\n.form-help {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.5);\n  margin-top: 4px;\n}\n\n.time-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 0;\n}\n\n.time-label {\n  font-size: 14px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.time-value {\n  font-size: 14px;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.template-toggle {\n  display: flex;\n  gap: 8px;\n}\n\n.template-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 8px 16px;\n  border-radius: 6px;\n  font-size: 14px;\n  cursor: pointer;\n  transition: all 0.3s;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.template-btn.active {\n  background: rgba(102, 126, 234, 0.2);\n  border-color: rgba(102, 126, 234, 0.3);\n  color: #667eea;\n}\n\n.template-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.template-btn.active:hover {\n  background: rgba(102, 126, 234, 0.3);\n}\n\n.template-selector {\n  margin-top: 8px;\n}\n\n.form-select {\n  width: 100%;\n  appearance: none;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='rgba(255, 255, 255, 0.5)' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\");\n  background-repeat: no-repeat;\n  background-position: right 12px center;\n  padding-right: 36px;\n}\n\n.modal-footer {\n  padding: 20px 24px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n}\n\n.cancel-btn,\n.save-btn {\n  padding: 10px 20px;\n  border-radius: 8px;\n  font-size: 14px;\n  cursor: pointer;\n  transition: all 0.3s;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.cancel-btn {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.cancel-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.save-btn {\n  background: rgba(102, 126, 234, 0.2);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  color: #667eea;\n}\n\n.save-btn:hover:not(:disabled) {\n  background: rgba(102, 126, 234, 0.3);\n}\n\n.save-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.loading-icon {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n/* Transition animations */\n.modal-enter-active,\n.modal-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.modal-enter-from,\n.modal-leave-to {\n  opacity: 0;\n}\n\n/* Toggle Switch Styles */\n.toggle-switch {\n  position: relative;\n  display: inline-block;\n  width: 50px;\n  height: 24px;\n}\n\n.toggle-switch input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.toggle-slider {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(255, 255, 255, 0.2);\n  transition: .4s;\n  border-radius: 24px;\n}\n\n.toggle-slider:before {\n  position: absolute;\n  content: \"\";\n  height: 18px;\n  width: 18px;\n  left: 3px;\n  bottom: 3px;\n  background-color: white;\n  transition: .4s;\n  border-radius: 50%;\n}\n\ninput:checked + .toggle-slider {\n  background-color: rgba(102, 126, 234, 0.6);\n}\n\ninput:focus + .toggle-slider {\n  box-shadow: 0 0 1px rgba(102, 126, 234, 0.6);\n}\n\ninput:checked + .toggle-slider:before {\n  transform: translateX(26px);\n}\n</style>\n\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Teleport to=\"body\">\n    <Transition name=\"modal\">\n      <div v-if=\"modelValue\" class=\"modal-overlay\" @click=\"handleOverlayClick\">\n        <div class=\"modal-container\" @click.stop>\n          <div class=\"modal-header\">\n            <h3>{{ $t('cronTask.title') }}</h3>\n            <div class=\"header-actions\">\n              <button class=\"add-task-btn\" @click=\"addNewTask\" @click.stop>\n                <Icon icon=\"carbon:add\" />\n                {{ $t('cronTask.addTask') }}\n              </button>\n              <button class=\"close-btn\" @click=\"$emit('update:modelValue', false)\">\n                <Icon icon=\"carbon:close\" />\n              </button>\n            </div>\n          </div>\n          <div class=\"modal-content\">\n            <!-- Loading state -->\n            <div v-if=\"loading\" class=\"loading-container\">\n              <Icon icon=\"carbon:loading\" class=\"loading-icon\" />\n              <span>{{ $t('common.loading') }}</span>\n            </div>\n\n            <!-- Empty state -->\n            <div v-else-if=\"cronTasks.length === 0\" class=\"empty-container\">\n              <Icon icon=\"carbon:time\" class=\"empty-icon\" />\n              <span>{{ $t('cronTask.noTasks') }}</span>\n            </div>\n\n            <!-- Task list -->\n            <div v-else class=\"task-list\">\n              <div v-for=\"task in cronTasks\" :key=\"task.id || ''\" class=\"task-item\" @click=\"showTaskDetail(task)\">\n                <div class=\"task-main\">\n                  <div class=\"task-info\">\n                    <div class=\"task-header\">\n                      <div class=\"task-name\">{{ task.cronName}}</div>\n                      <div class=\"task-status-badge\" :class=\"task.status === 0 ? 'active' : 'inactive'\">\n                        <Icon :icon=\"task.status === 0 ? 'carbon:checkmark-filled' : 'carbon:pause-filled'\" />\n                        <span>{{ task.status === 0 ? $t('cronTask.active') : $t('cronTask.inactive') }}</span>\n                      </div>\n                    </div>\n                    <div class=\"task-description\">{{ task.planDesc }}</div>\n                    <div class=\"task-time\">\n                      <Icon icon=\"carbon:time\" />\n                      <span class=\"cron-readable\" style=\"cursor:pointer\" @click.stop=\"copyCronTime(task.cronTime)\">{{ task.cronTime }}</span>\n                    </div>\n                  </div>\n                </div>\n\n                <div class=\"task-actions\" @click.stop>\n                  <button\n                    class=\"action-btn execute-btn\"\n                    @click=\"executeTask(task.id!)\"\n                    :disabled=\"executing === task.id\"\n                    :title=\"$t('cronTask.executeOnce')\"\n                  >\n                    <Icon :icon=\"executing === task.id ? 'carbon:loading' : 'carbon:play-filled'\" />\n                    {{ $t('cronTask.executeOnce') }}\n                  </button>\n\n                  <div class=\"action-dropdown\" :class=\"{ 'active': activeDropdown === task.id }\">\n                    <button\n                      class=\"action-btn dropdown-btn\"\n                      @click=\"toggleDropdown(task.id!)\"\n                      :title=\"$t('cronTask.operations')\"\n                    >\n                      <Icon icon=\"carbon:overflow-menu-horizontal\" />\n                      {{ $t('cronTask.operations') }}\n                    </button>\n\n                    <div class=\"dropdown-menu\" v-show=\"activeDropdown === task.id\">\n                      <button\n                        class=\"dropdown-item edit-btn\"\n                        @click=\"showTaskDetail(task)\"\n                      >\n                        <Icon icon=\"carbon:edit\" />\n                        {{ $t('cronTask.edit') }}\n                      </button>\n\n                      <button\n                        class=\"dropdown-item toggle-btn\"\n                        @click=\"toggleTaskStatus(task)\"\n                        :disabled=\"toggling === task.id\"\n                      >\n                        <Icon :icon=\"toggling === task.id ? 'carbon:loading' : (task.status === 0 ? 'carbon:pause-filled' : 'carbon:play-filled')\" />\n                        {{ task.status === 0 ? $t('cronTask.disable') : $t('cronTask.enable') }}\n                      </button>\n\n                      <button\n                        class=\"dropdown-item delete-btn\"\n                        @click=\"showDeleteConfirmDialog(task)\"\n                        :disabled=\"deleting === task.id\"\n                      >\n                        <Icon :icon=\"deleting === task.id ? 'carbon:loading' : 'carbon:trash-can'\" />\n                        {{ $t('cronTask.delete') }}\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n\n  <!-- Task Detail Modal -->\n  <TaskDetailModal\n    v-model=\"showDetail\"\n    :task=\"selectedTask\"\n    @save=\"handleSaveTask\"\n  />\n\n  <!-- Delete Confirmation Modal -->\n  <Teleport to=\"body\">\n    <Transition name=\"modal\">\n      <div v-if=\"showDeleteConfirm\" class=\"modal-overlay\" @click=\"cancelDelete\">\n        <div class=\"confirm-modal\" @click.stop>\n          <div class=\"confirm-header\">\n            <Icon icon=\"carbon:warning\" class=\"warning-icon\" />\n            <h3>{{ $t('cronTask.deleteConfirm') }}</h3>\n          </div>\n          <div class=\"confirm-content\">\n            <p>{{ $t('cronTask.deleteConfirmMessage', { taskName: taskToDelete?.cronName || taskToDelete?.planDesc || '' }) }}</p>\n          </div>\n          <div class=\"confirm-actions\">\n            <button class=\"confirm-btn cancel-btn\" @click=\"cancelDelete\">\n              {{ $t('common.cancel') }}\n            </button>\n            <button\n              class=\"confirm-btn delete-btn\"\n              @click=\"handleDeleteTask\"\n              :disabled=\"deleting === taskToDelete?.id\"\n            >\n              <Icon :icon=\"deleting === taskToDelete?.id ? 'carbon:loading' : 'carbon:trash-can'\" />\n              {{ $t('cronTask.delete') }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n\n  <!-- Create Options Modal -->\n  <Teleport to=\"body\">\n    <Transition name=\"modal\">\n      <div v-if=\"showCreateOptions\" class=\"modal-overlay\" @click=\"cancelCreateOptions\">\n        <div class=\"confirm-modal create-options-modal\" @click.stop>\n          <div class=\"confirm-header\">\n            <Icon icon=\"carbon:time\" class=\"create-icon\" />\n            <h3>{{ $t('cronTask.createTask') }}</h3>\n          </div>\n          <div class=\"confirm-content\">\n            <p>{{ $t('cronTask.selectCreateMethod') }}</p>\n\n            <div class=\"create-options\">\n              <button class=\"create-option-btn jmanus-btn\" @click=\"createWithJmanus\">\n                <Icon icon=\"carbon:ai-status\" />\n                <div class=\"option-content\">\n                  <span class=\"option-title\">{{ $t('cronTask.createWithJmanus') }}</span>\n                  <span class=\"option-desc\">{{ $t('cronTask.createWithJmanusDesc') }}</span>\n                </div>\n              </button>\n\n              <button class=\"create-option-btn manual-btn\" @click=\"createManually\">\n                <Icon icon=\"carbon:edit\" />\n                <div class=\"option-content\">\n                  <span class=\"option-title\">{{ $t('cronTask.createManually') }}</span>\n                  <span class=\"option-desc\">{{ $t('cronTask.createManuallyDesc') }}</span>\n                </div>\n              </button>\n            </div>\n          </div>\n          <div class=\"confirm-actions\">\n            <button class=\"confirm-btn cancel-btn\" @click=\"cancelCreateOptions\">\n              {{ $t('common.cancel') }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, onMounted, onUnmounted } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { useRouter } from 'vue-router'\nimport { useI18n } from 'vue-i18n'\nimport { CronApiService } from '@/api/cron-api-service'\nimport type { CronConfig } from '@/types/cron-task'\nimport TaskDetailModal from './TaskDetailModal.vue'\nimport { useTaskStore } from '@/stores/task'\nimport { useToast } from '@/plugins/useToast'\nimport { CronTaskUtils } from '@/utils/cron-task-utils'\nconst router = useRouter()\nconst taskStore = useTaskStore()\nconst toast = useToast()\nconst { t } = useI18n()\n\nconst props = defineProps({\n  modelValue: {\n    type: Boolean,\n    required: true,\n  },\n})\n\nconst emit = defineEmits(['update:modelValue'])\n\nconst cronTasks = ref<CronConfig[]>([])\nconst loading = ref(false)\nconst executing = ref<string | number | null>(null)\nconst deleting = ref<string | number | null>(null)\nconst toggling = ref<string | number | null>(null)\nconst activeDropdown = ref<string | number | null>(null)\nconst showDetail = ref(false)\nconst selectedTask = ref<CronConfig | null>(null)\nconst showDeleteConfirm = ref(false)\nconst taskToDelete = ref<CronConfig | null>(null)\nconst showCreateOptions = ref(false)\n\n\n\n/**\n * Handle click on modal overlay area\n */\nconst handleOverlayClick = (e: MouseEvent) => {\n  if (e.target === e.currentTarget) {\n    emit('update:modelValue', false)\n  }\n}\n\n/**\n * Load all scheduled tasks\n */\nconst loadCronTasks = async () => {\n  loading.value = true\n  try {\n    cronTasks.value = await CronApiService.getAllCronTasks()\n  } catch (error) {\n    console.error('Failed to load cron tasks:', error)\n    toast.error(`Failed to load tasks: ${error instanceof Error ? error.message : String(error)}`)\n  } finally {\n    loading.value = false\n  }\n}\n\n/**\n * Execute scheduled task\n * @param taskId Task ID\n */\nconst executeTask = async (taskId: string | number) => {\n  executing.value = taskId\n  try {\n    // Find task\n    const task = cronTasks.value.find(t => t.id === taskId)\n    if (!task) {\n      console.error('Task not found:', taskId)\n      return\n    }\n\n    // Close modal\n    emit('update:modelValue', false)\n\n    // Navigate to chat page\n    const chatId = Date.now().toString()\n    await router.push({\n      name: 'direct',\n      params: { id: chatId },\n    })\n\n    // Wait for page to load\n    await new Promise(resolve => setTimeout(resolve, 100))\n\n    // Prepare execution data\n    const executionData = CronTaskUtils.prepareTaskExecution(task)\n\n    // Execute task\n    if (executionData.useTemplate && executionData.planData) {\n      // Execute plan using template\n      taskStore.emitPlanExecutionRequested(executionData.planData)\n    } else if (executionData.taskContent) {\n      // Execute directly using task description as content\n      taskStore.setTask(executionData.taskContent)\n    }\n  } catch (error) {\n    console.error('Failed to execute task:', error)\n    toast.error(`Execution failed: ${error instanceof Error ? error.message : String(error)}`)\n  } finally {\n    executing.value = null\n  }\n}\n\n/**\n * Show task details\n * @param task Task object\n */\nconst showTaskDetail = (task: CronConfig) => {\n  selectedTask.value = { ...task }\n  showDetail.value = true\n  activeDropdown.value = null\n}\n\n/**\n * Handle task save\n * @param updatedTask Updated task\n */\nconst handleSaveTask = async (updatedTask: CronConfig) => {\n  try {\n    await CronTaskUtils.saveTask(updatedTask)\n    await loadCronTasks() // Reload task list\n    showDetail.value = false\n    toast.success('Task saved successfully')\n  } catch (error) {\n    console.error('Failed to save task:', error)\n    toast.error(`Save failed: ${error instanceof Error ? error.message : String(error)}`)\n  }\n}\n\n/**\n * Show delete confirmation dialog\n * @param task Task to delete\n */\nconst showDeleteConfirmDialog = (task: CronConfig) => {\n  taskToDelete.value = task\n  showDeleteConfirm.value = true\n}\n\n/**\n * Handle task deletion\n */\nconst handleDeleteTask = async () => {\n  if (!taskToDelete.value?.id) return\n\n  deleting.value = taskToDelete.value.id\n  try {\n    await CronTaskUtils.deleteTask(taskToDelete.value.id)\n    await loadCronTasks() // Reload task list\n    showDeleteConfirm.value = false\n    taskToDelete.value = null\n    toast.success('Task deleted successfully')\n  } catch (error) {\n    console.error('Failed to delete task:', error)\n    toast.error(`Delete failed: ${error instanceof Error ? error.message : String(error)}`)\n  } finally {\n    deleting.value = null\n  }\n}\n\n/**\n * Cancel delete operation\n */\nconst cancelDelete = () => {\n  showDeleteConfirm.value = false\n  taskToDelete.value = null\n}\n\n/**\n * Toggle dropdown menu display state\n * @param taskId Task ID\n */\nconst toggleDropdown = (taskId: string | number) => {\n  activeDropdown.value = activeDropdown.value === taskId ? null : taskId\n}\n\n/**\n * Toggle task status (enable/disable)\n * @param task Task object\n */\nconst toggleTaskStatus = async (task: CronConfig) => {\n  if (!task.id) return\n\n  toggling.value = task.id\n  try {\n    await CronTaskUtils.toggleTaskStatus(task)\n    await loadCronTasks() // Reload task list\n    activeDropdown.value = null // Close dropdown menu\n    toast.success(`Task ${task.status === 0 ? 'disabled' : 'enabled'} successfully`)\n  } catch (error) {\n    console.error('Failed to toggle task status:', error)\n    toast.error(`Status toggle failed: ${error instanceof Error ? error.message : String(error)}`)\n  } finally {\n    toggling.value = null\n  }\n}\n\n/**\n * Copy Cron expression\n * @param cronTime Cron expression\n */\nconst copyCronTime = async (cronTime: string) => {\n  try {\n    await navigator.clipboard.writeText(cronTime)\n    toast.success('Cron expression copied successfully')\n  } catch (e) {\n    toast.error(`Copy failed: ${e instanceof Error ? e.message : String(e)}`)\n  }\n}\n\n/**\n * Add new task\n */\nconst addNewTask = () => {\n  showCreateOptions.value = true\n}\n\n/**\n * Create task using AI assistant\n */\nconst createWithJmanus = () => {\n  showCreateOptions.value = false\n\n  try {\n    // Close modal\n    emit('update:modelValue', false)\n\n    // Get scheduled task template from i18n config, set to input box but don't execute\n    const templateContent = t('cronTask.template')\n    taskStore.setTaskToInput(templateContent)\n\n    // Navigate to chat page\n    const chatId = Date.now().toString()\n    router.push({\n      name: 'direct',\n      params: { id: chatId }\n    })\n  } catch (error) {\n    console.error('Error in createWithJmanus:', error)\n    toast.error(`Creation failed: ${error instanceof Error ? error.message : String(error)}`)\n  }\n}\n\n/**\n * Create task manually\n */\nconst createManually = () => {\n  showCreateOptions.value = false\n\n  // Create an empty task object\n  selectedTask.value = {\n    cronName: '',\n    cronTime: '',\n    planDesc: '',\n    status: 0,\n    planTemplateId: ''\n  }\n  showDetail.value = true\n}\n\n/**\n * Cancel create options\n */\nconst cancelCreateOptions = () => {\n  showCreateOptions.value = false\n}\n\n/**\n * Handle click outside to close dropdown\n */\nconst handleClickOutside = (event: MouseEvent) => {\n  const target = event.target as HTMLElement\n  if (!target.closest('.action-dropdown') && !target.closest('.dropdown-menu')) {\n    activeDropdown.value = null\n  }\n}\n\n// Handle ESC key to close modals\nconst handleEscKey = (e: KeyboardEvent) => {\n  if (e.key === 'Escape') {\n    if (showDeleteConfirm.value) {\n      cancelDelete()\n    } else if (showCreateOptions.value) {\n      cancelCreateOptions()\n    } else if (props.modelValue) {\n      emit('update:modelValue', false)\n    }\n  }\n}\n\n// Lifecycle hooks\nonMounted(() => {\n  document.addEventListener('click', handleClickOutside, true)\n  document.addEventListener('keydown', handleEscKey)\n})\n\nonUnmounted(() => {\n  document.removeEventListener('click', handleClickOutside, true)\n  document.removeEventListener('keydown', handleEscKey)\n})\n\n// Watch modal display state, load task list\nwatch(() => props.modelValue, (newValue) => {\n  if (newValue) {\n    loadCronTasks()\n  }\n})\n</script>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.7);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-container {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.15));\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 16px;\n  width: 90%;\n  max-width: 800px;\n  max-height: 90vh;\n  overflow-y: auto;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px 24px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.add-task-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 8px 16px;\n  background: rgba(34, 197, 94, 0.1);\n  border: 1px solid rgba(34, 197, 94, 0.2);\n  border-radius: 8px;\n  color: #22c55e;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.3s;\n}\n\n.add-task-btn:hover {\n  background: rgba(34, 197, 94, 0.2);\n  border-color: rgba(34, 197, 94, 0.3);\n  transform: translateY(-1px);\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s;\n}\n\n.close-btn:hover {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.modal-content {\n  padding: 24px;\n  min-height: 300px;\n}\n\n.loading-container,\n.empty-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 200px;\n  color: rgba(255, 255, 255, 0.6);\n  gap: 12px;\n}\n\n.loading-icon {\n  font-size: 24px;\n  animation: spin 1s linear infinite;\n}\n\n.empty-icon {\n  font-size: 48px;\n  opacity: 0.5;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n.task-list {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.task-item {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  padding: 24px;\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  transition: all 0.3s ease;\n  gap: 20px;\n  cursor: pointer;\n}\n\n.task-item:hover {\n  background: rgba(102, 126, 234, 0.15);\n  border-color: rgba(102, 126, 234, 0.4);\n  transform: translateY(-3px);\n  box-shadow: 0 8px 32px rgba(102, 126, 234, 0.2);\n}\n\n.task-main {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.task-info {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.task-header {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  flex-wrap: wrap;\n}\n\n.task-name {\n  font-size: 20px;\n  font-weight: 700;\n  color: rgba(255, 255, 255, 0.95);\n  line-height: 1.3;\n  background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.8));\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  background-clip: text;\n}\n\n.task-status-badge {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 8px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 500;\n  border: 1px solid transparent;\n  white-space: nowrap;\n}\n\n.task-status-badge.active {\n  background: rgba(59, 130, 246, 0.1);\n  border-color: rgba(59, 130, 246, 0.2);\n  color: #3b82f6;\n}\n\n.task-status-badge.inactive {\n  background: rgba(156, 163, 175, 0.1);\n  border-color: rgba(156, 163, 175, 0.2);\n  color: #9ca3af;\n}\n\n.task-description {\n  font-size: 14px;\n  color: rgba(255, 255, 255, 0.7);\n  line-height: 1.5;\n  margin: 4px 0;\n  max-width: 80%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n}\n\n.task-time {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 13px;\n  padding: 6px 10px;\n  background: rgba(255, 255, 255, 0.03);\n  border-radius: 8px;\n  border: 1px solid rgba(255, 255, 255, 0.05);\n  transition: all 0.2s ease;\n}\n\n.task-time:hover {\n  background: rgba(255, 255, 255, 0.06);\n  border-color: rgba(255, 255, 255, 0.1);\n}\n\n.cron-readable {\n  color: rgba(255, 255, 255, 0.85);\n  font-weight: 600;\n  font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;\n}\n\n.task-actions {\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  min-width: 200px;\n  align-items: flex-start;\n  margin-left: auto;\n  justify-content: flex-end;\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  padding: 8px 12px;\n  border-radius: 6px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.3s;\n  white-space: nowrap;\n  border: 1px solid transparent;\n}\n\n.execute-btn {\n  background: rgba(59, 130, 246, 0.1);\n  border-color: rgba(59, 130, 246, 0.2);\n  color: #3b82f6;\n}\n\n.execute-btn:hover:not(:disabled) {\n  background: rgba(59, 130, 246, 0.2);\n  border-color: rgba(59, 130, 246, 0.3);\n}\n\n.execute-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.delete-btn {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: rgba(239, 68, 68, 0.2);\n  color: #ef4444;\n}\n\n.delete-btn:hover:not(:disabled) {\n  background: rgba(239, 68, 68, 0.2);\n  border-color: rgba(239, 68, 68, 0.3);\n}\n\n.delete-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.dropdown-btn {\n  background: rgba(156, 163, 175, 0.1);\n  border-color: rgba(156, 163, 175, 0.2);\n  color: #9ca3af;\n}\n\n.dropdown-btn:hover {\n  background: rgba(156, 163, 175, 0.2);\n  border-color: rgba(156, 163, 175, 0.3);\n}\n\n.action-dropdown {\n  position: relative;\n}\n\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  right: 0;\n  background: rgba(30, 30, 30, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(8px);\n  z-index: 100;\n  min-width: 140px;\n  margin-top: 4px;\n}\n\n.dropdown-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  width: 100%;\n  padding: 10px 12px;\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 13px;\n  cursor: pointer;\n  transition: all 0.2s;\n  text-align: left;\n}\n\n.dropdown-item:first-child {\n  border-radius: 8px 8px 0 0;\n}\n\n.dropdown-item:last-child {\n  border-radius: 0 0 8px 8px;\n}\n\n.dropdown-item:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.95);\n}\n\n.dropdown-item.edit-btn:hover:not(:disabled) {\n  background: rgba(59, 130, 246, 0.1);\n  color: #3b82f6;\n}\n\n.dropdown-item.toggle-btn:hover:not(:disabled) {\n  background: rgba(249, 115, 22, 0.1);\n  color: #f97316;\n}\n\n.dropdown-item.delete-btn:hover:not(:disabled) {\n  background: rgba(239, 68, 68, 0.1);\n  color: #ef4444;\n}\n\n.dropdown-item:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Transition animations */\n.modal-enter-active,\n.modal-leave-active {\n  transition: opacity 0.3s ease;\n}\n\n.modal-enter-from,\n.modal-leave-to {\n  opacity: 0;\n}\n\n/* Confirmation modal styles */\n.confirm-modal {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.15));\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 16px;\n  width: 90%;\n  max-width: 480px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  overflow: hidden;\n}\n\n.confirm-header {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 24px 24px 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.warning-icon {\n  font-size: 24px;\n  color: #f59e0b;\n}\n\n.confirm-header h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.confirm-content {\n  padding: 20px 24px;\n}\n\n.confirm-content p {\n  margin: 0;\n  color: rgba(255, 255, 255, 0.8);\n  line-height: 1.6;\n  font-size: 14px;\n}\n\n.confirm-actions {\n  display: flex;\n  gap: 12px;\n  padding: 16px 24px 24px;\n  justify-content: flex-end;\n}\n\n.confirm-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  border-radius: 8px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.3s;\n  border: 1px solid transparent;\n  min-width: 80px;\n  justify-content: center;\n}\n\n.confirm-btn.cancel-btn {\n  background: rgba(156, 163, 175, 0.1);\n  border-color: rgba(156, 163, 175, 0.2);\n  color: #9ca3af;\n}\n\n.confirm-btn.cancel-btn:hover {\n  background: rgba(156, 163, 175, 0.2);\n  border-color: rgba(156, 163, 175, 0.3);\n}\n\n.confirm-btn.delete-btn {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: rgba(239, 68, 68, 0.2);\n  color: #ef4444;\n}\n\n.confirm-btn.delete-btn:hover:not(:disabled) {\n  background: rgba(239, 68, 68, 0.2);\n  border-color: rgba(239, 68, 68, 0.3);\n}\n\n.confirm-btn.delete-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Create Options Modal Styles */\n.create-options-modal {\n  max-width: 520px;\n}\n\n.create-icon {\n  font-size: 24px;\n  color: #3b82f6;\n}\n\n.create-options {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n  margin-top: 20px;\n}\n\n.create-option-btn {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  padding: 16px;\n  border-radius: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  cursor: pointer;\n  transition: all 0.3s;\n  text-align: left;\n}\n\n.create-option-btn:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);\n}\n\n.create-option-btn .iconify {\n  font-size: 24px;\n}\n\n.jmanus-btn {\n  color: #3b82f6;\n}\n\n.jmanus-btn:hover {\n  background: rgba(59, 130, 246, 0.1);\n  border-color: rgba(59, 130, 246, 0.3);\n}\n\n.jmanus-btn .iconify {\n  color: #3b82f6;\n}\n\n.manual-btn {\n  color: #10b981;\n}\n\n.manual-btn:hover {\n  background: rgba(16, 185, 129, 0.1);\n  border-color: rgba(16, 185, 129, 0.3);\n}\n\n.manual-btn .iconify {\n  color: #10b981;\n}\n\n.option-content {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n}\n\n.option-title {\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.option-desc {\n  font-size: 13px;\n  color: rgba(255, 255, 255, 0.6);\n}\n</style>\n\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"direct-page\">\n    <div class=\"direct-chat\">\n      <Sidebar ref=\"sidebarRef\" @planExecutionRequested=\"handlePlanExecutionRequested\" />\n      <!-- Left Panel - Chat -->\n      <div class=\"left-panel\" :style=\"{ width: computedLeftPanelWidth + '%' }\">\n        <div class=\"chat-header\">\n          <button class=\"back-button\" @click=\"goBack\">\n            <Icon icon=\"carbon:arrow-left\" />\n          </button>\n          <h2>{{ $t('conversation') }}</h2>\n          <div class=\"header-actions\">\n            <LanguageSwitcher />\n            <button class=\"config-button\" @click=\"newChat\" :title=\"$t('memory.newChat')\">\n              <Icon icon=\"carbon:add\" width=\"20\" />\n            </button>\n            <button class=\"config-button\" @click=\"handleConfig\" :title=\"$t('direct.configuration')\">\n              <Icon icon=\"carbon:settings-adjust\" width=\"20\" />\n            </button>\n            <button class=\"cron-task-btn\" @click=\"showCronTaskModal = true\" :title=\"$t('cronTask.title')\">\n              <Icon icon=\"carbon:alarm\" width=\"20\" />\n            </button>\n            <button class=\"cron-task-btn\" @click=\"memoryStore.toggleSidebar()\" :title=\"$t('memory.selectMemory')\">\n              <Icon icon=\"carbon:calendar\" width=\"20\" />\n            </button>\n          </div>\n        </div>\n\n        <!-- Chat Container -->\n        <div class=\"chat-content\">\n          <ChatContainer\n            ref=\"chatRef\"\n            mode=\"direct\"\n            :initial-prompt=\"prompt || ''\"\n            @step-selected=\"handleStepSelected\"\n            @sub-plan-step-selected=\"handleSubPlanStepSelected\"\n          />\n        </div>\n\n        <!-- Input Area -->\n        <InputArea\n          :key=\"$i18n.locale\"\n          ref=\"inputRef\"\n          :disabled=\"isLoading\"\n          :placeholder=\"isLoading ? t('input.waiting') : t('input.placeholder')\"\n          :initial-value=\"prompt\"\n          @send=\"handleSendMessage\"\n          @clear=\"handleInputClear\"\n          @focus=\"handleInputFocus\"\n          @update-state=\"handleInputUpdateState\"\n          @plan-mode-clicked=\"handlePlanModeClicked\"\n        />\n      </div>\n\n      <!-- Resizer -->\n      <div\n        class=\"panel-resizer\"\n        @mousedown=\"startResize\"\n        @dblclick=\"resetPanelSize\"\n        :title=\"$t('direct.panelResizeHint')\"\n      >\n        <div class=\"resizer-line\"></div>\n      </div>\n\n      <!-- Right Panel - Preview -->\n      <RightPanel ref=\"rightPanelRef\" :style=\"{ width: 100 - leftPanelWidth + '%' }\" :current-root-plan-id=\"currentRootPlanId\" />\n    </div>\n\n    <!-- Cron Task Modal -->\n    <CronTaskModal v-model=\"showCronTaskModal\" />\n\n    <!-- Memory Modal -->\n    <Memory\n        @memory-selected=\"memorySelected\"\n    />\n\n    <!-- Message toast component -->\n    <div v-if=\"message.show\" class=\"message-toast\" :class=\"message.type\">\n      <div class=\"message-content\">\n        <span>{{ message.text }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted, onUnmounted, watch, nextTick, computed } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport Sidebar from '@/components/sidebar/Sidebar.vue'\nimport Memory from '@/components/memory/Memory.vue'\nimport RightPanel from '@/components/right-panel/RightPanel.vue'\nimport ChatContainer from '@/components/chat/ChatContainer.vue'\nimport InputArea from '@/components/input/InputArea.vue'\nimport LanguageSwitcher from '@/components/language-switcher/LanguageSwitcher.vue'\nimport CronTaskModal from '@/components/cron-task-modal/CronTaskModal.vue'\nimport { PlanActApiService } from '@/api/plan-act-api-service'\nimport { CommonApiService } from '@/api/common-api-service'\nimport { useTaskStore } from '@/stores/task'\nimport { sidebarStore } from '@/stores/sidebar'\nimport { planExecutionManager } from '@/utils/plan-execution-manager'\nimport { useMessage } from '@/composables/useMessage'\nimport { memoryStore } from \"@/stores/memory\";\nimport type { InputMessage } from \"@/stores/memory\";\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution';\nconst route = useRoute()\nconst router = useRouter()\nconst taskStore = useTaskStore()\nconst { t } = useI18n()\nconst { message } = useMessage()\n\nconst prompt = ref<string>('')\nconst inputOnlyContent = ref<string>('')\nconst rightPanelRef = ref()\nconst chatRef = ref()\nconst inputRef = ref()\nconst sidebarRef = ref()\nconst isExecutingPlan = ref(false)\nconst isLoading = ref(false)\nconst currentRootPlanId = ref<string | null>(null)\nconst showCronTaskModal = ref(false)\n\n// Related to panel width\nconst leftPanelWidth = ref(50) // Left panel width percentage\nconst isResizing = ref(false)\nconst startX = ref(0)\nconst startLeftWidth = ref(0)\n\n// Computed left panel width that adjusts based on sidebar width\nconst computedLeftPanelWidth = computed(() => {\n  if (sidebarStore.isCollapsed) {\n    return leftPanelWidth.value\n  }\n\n  // When sidebar is expanded, calculate available width for left panel\n  // Get sidebar width from the sidebar component if available\n  let sidebarWidth = 26 // Default sidebar width\n\n  // Try to get actual sidebar width from the sidebar component\n  if (sidebarRef.value && sidebarRef.value.sidebarWidth !== undefined) {\n    sidebarWidth = sidebarRef.value.sidebarWidth\n  }\n\n  // Calculate maximum available width for left panel\n  // Total width is 100%, so left panel max = 100% - sidebar width\n  const maxAvailableWidth = 100 - sidebarWidth\n\n  // Ensure left panel width doesn't exceed available space\n  // Also maintain minimum width of 20%\n  return Math.max(20, Math.min(maxAvailableWidth, leftPanelWidth.value))\n})\n\nonMounted(() => {\n  console.log('[Direct] onMounted called')\n  console.log('[Direct] taskStore.currentTask:', taskStore.currentTask)\n  console.log('[Direct] taskStore.hasUnprocessedTask():', taskStore.hasUnprocessedTask())\n\n  // Register event callbacks to planExecutionManager\n  planExecutionManager.setEventCallbacks({\n    onPlanUpdate: (rootPlanId: string) => {\n      console.log('[Direct] Plan update event received for rootPlanId:', rootPlanId)\n\n      if (!shouldProcessEventForCurrentPlan(rootPlanId)) {\n        return\n      }\n\n      console.log('[Direct] Processing plan update for current rootPlanId:', rootPlanId)\n\n      // Call chat component's handlePlanUpdate method\n      if (chatRef.value && typeof chatRef.value.handlePlanUpdate === 'function') {\n        console.log('[Direct] Calling chatRef.handlePlanUpdate with rootPlanId:', rootPlanId)\n        chatRef.value.handlePlanUpdate(rootPlanId)\n      } else {\n        console.warn('[Direct] chatRef.handlePlanUpdate method not available')\n      }\n\n      // Call right panel component's updateDisplayedPlanProgress method\n      if (rightPanelRef.value && typeof rightPanelRef.value.updateDisplayedPlanProgress === 'function') {\n        console.log('[Direct] Calling rightPanelRef.updateDisplayedPlanProgress with rootPlanId:', rootPlanId)\n        rightPanelRef.value.updateDisplayedPlanProgress(rootPlanId)\n      } else {\n        console.warn('[Direct] rightPanelRef.updateDisplayedPlanProgress method not available')\n      }\n    },\n\n    onPlanCompleted: (rootPlanId: string) => {\n      console.log('[Direct] Plan completed event received for rootPlanId:', rootPlanId)\n\n      if (!shouldProcessEventForCurrentPlan(rootPlanId)) {\n        return\n      }\n\n      console.log('[Direct] Processing plan completion for current rootPlanId:', rootPlanId)\n\n      // Call chat component's handlePlanCompleted method\n      if (chatRef.value && typeof chatRef.value.handlePlanCompleted === 'function') {\n        const planDetails = planExecutionManager.getCachedPlanRecord(rootPlanId)\n\n        // Retrieved plan details from cache for processing\n        if (planDetails && planDetails.completed) {\n          if (planDetails.summary && planDetails.summary.trim().length > 0) {\n            console.log('[Direct]  Plan details are valid and complete from polling cache, updating UI')\n            chatRef.value.handlePlanCompleted(planDetails)\n          } else {\n            console.warn('[Direct]  Plan completed but summary is empty, still proceeding with available data')\n            chatRef.value.handlePlanCompleted(planDetails)\n          }\n        } else {\n          console.warn('[Direct]  Plan details incomplete in cache, attempting API fallback')\n          // Fallback: try getting it from the API (maybe it has been deleted)\n          CommonApiService.getDetails(rootPlanId).then(freshDetails => {\n            console.log('[Direct]  Got fresh details from API:', freshDetails)\n            if (freshDetails && freshDetails.completed) {\n              console.log('[Direct] Fresh details from API are valid, updating UI')\n              planExecutionManager.setCachedPlanRecord(rootPlanId, freshDetails)\n              chatRef.value.handlePlanCompleted(freshDetails)\n            } else {\n              console.warn('[Direct]  API details also incomplete, using best available data')\n              chatRef.value.handlePlanCompleted(planDetails ?? { planId: rootPlanId })\n            }\n          }).catch(error => {\n            console.error('[Direct] API call failed (likely record deleted), using cached data:', error)\n            chatRef.value.handlePlanCompleted(planDetails ?? { planId: rootPlanId })\n          })\n        }\n      } else {\n        console.warn('[Direct] chatRef.handlePlanCompleted method not available')\n      }\n\n      // Clear current root plan ID when plan is completed\n      currentRootPlanId.value = null\n      console.log('[Direct] 🧹 Cleared currentRootPlanId after plan completion')\n\n      //Clear sessionPlanId to ensure that subsequent file uploads use the new planId\n      if (inputRef.value && typeof inputRef.value.resetSession === 'function') {\n        console.log('[Direct] 🧹 Calling inputRef.resetSession to clear sessionPlanId')\n        inputRef.value.resetSession()\n      }\n    },\n\n    onDialogRoundStart: (rootPlanId: string) => {\n      console.log('[Direct] Dialog round start event received for rootPlanId:', rootPlanId)\n\n      // Set current root plan ID when dialog starts\n      currentRootPlanId.value = rootPlanId\n      console.log('[Direct] Set currentRootPlanId to:', rootPlanId)\n\n      // Call chat component's handleDialogRoundStart method (without query parameter)\n      if (chatRef.value && typeof chatRef.value.handleDialogRoundStart === 'function') {\n        console.log('[Direct] Calling chatRef.handleDialogRoundStart with planId:', rootPlanId)\n        chatRef.value.handleDialogRoundStart(rootPlanId)\n      } else {\n        console.warn('[Direct] chatRef.handleDialogRoundStart method not available')\n      }\n    },\n\n    onChatInputClear: () => {\n      console.log('[Direct] Chat input clear event received')\n      handleInputClear()\n    },\n\n    onChatInputUpdateState: (rootPlanId: string) => {\n      console.log('[Direct] Chat input update state event received for rootPlanId:', rootPlanId)\n\n      if (!shouldProcessEventForCurrentPlan(rootPlanId, true)) {\n        return\n      }\n\n      const uiState = planExecutionManager.getCachedUIState(rootPlanId)\n      if (uiState) {\n        handleInputUpdateState(uiState.enabled, uiState.placeholder)\n      }\n    },\n\n    onPlanError: (message: string) => {\n      // No right panel notification needed, uncomment if needed\n      // showMessage(`${t('planTemplate.executionFailed')}: ${message}`, 'error')\n      chatRef.value.handlePlanError(message)\n    },\n  })\n\n  console.log('[Direct] Event callbacks registered to planExecutionManager')\n\n  // Initialize sidebar data\n  sidebarStore.loadPlanTemplateList()\n\n  // Check if there is a task in the store\n  if (taskStore.hasUnprocessedTask() && taskStore.currentTask) {\n    const taskContent = taskStore.currentTask.prompt\n    console.log('[Direct] Found unprocessed task from store:', taskContent)\n    // Mark the task as processed to prevent duplicate responses\n    taskStore.markTaskAsProcessed()\n\n    // Execute task directly without showing content in input box\n    nextTick(async () => {\n      try {\n        console.log('[Direct] Calling handleChatSendMessage with taskContent:', taskContent)\n        await handleChatSendMessage({\n          input: taskContent\n        })\n      } catch (error) {\n        console.warn('[Direct] handleChatSendMessage failed, falling back to prompt:', error)\n        prompt.value = taskContent\n      }\n    })\n  } else {\n    // Check if there is a task to input (for pre-filling input without executing)\n    const taskToInput = taskStore.getAndClearTaskToInput()\n    if (taskToInput) {\n      inputOnlyContent.value = taskToInput\n      console.log('[Direct] Setting inputOnlyContent for input only:', inputOnlyContent.value)\n      // Don't set prompt.value since this is just for input pre-filling\n    } else {\n      // Degrade to URL parameters (backward compatibility)\n      prompt.value = (route.query.prompt as string) || ''\n      console.log('[Direct] Received task from URL:', prompt.value)\n      console.log('[Direct] No unprocessed task in store')\n    }\n  }\n\n  // Restore panel width from localStorage\n  const savedWidth = localStorage.getItem('directPanelWidth')\n  if (savedWidth) {\n    leftPanelWidth.value = parseFloat(savedWidth)\n  }\n\n  console.log('[Direct] Final prompt value:', prompt.value)\n\n  // Set input content if there's inputOnlyContent (after component is mounted)\n  if (inputOnlyContent.value) {\n    nextTick(() => {\n      if (inputRef.value && typeof inputRef.value.setInputValue === 'function') {\n        inputRef.value.setInputValue(inputOnlyContent.value)\n        console.log('[Direct] Set input value:', inputOnlyContent.value)\n        inputOnlyContent.value = '' // Clear after setting\n      }\n    })\n  }\n\n  // Listen for plan-execution-requested events on window\n  window.addEventListener('plan-execution-requested', ((event: CustomEvent) => {\n    console.log('[DirectView] Received plan-execution-requested event:', event.detail)\n    handlePlanExecutionRequested(event.detail)\n  }) as EventListener)\n\n  // No longer need to check pending plans in sessionStorage\n  // Because emitPlanExecutionRequested in task.ts already sends events directly\n})\n\n// Listen for changes in the store's task (only handle unprocessed tasks)\nwatch(\n  () => taskStore.currentTask,\n  newTask => {\n    console.log('[Direct] Watch taskStore.currentTask triggered, newTask:', newTask)\n    if (newTask && !newTask.processed && newTask.prompt.trim()) {\n      const taskContent = newTask.prompt\n      taskStore.markTaskAsProcessed()\n      console.log('[Direct] Received new task from store:', taskContent)\n\n      // Execute task directly without showing content in input box\n      nextTick(async () => {\n        try {\n          console.log('[Direct] Directly executing new task via handleChatSendMessage:', taskContent)\n          await handleChatSendMessage({ input: taskContent })\n        } catch (error) {\n          console.warn('[Direct] handleChatSendMessage failed for new task:', error)\n        }\n      })\n    } else {\n      console.log('[Direct] Task is null, already processed, or has empty prompt - ignoring')\n    }\n  },\n  { immediate: false }\n)\n\n// Listen for changes in prompt value, only for logging purposes\nwatch(\n  () => prompt.value,\n  (newPrompt, oldPrompt) => {\n    console.log('[Direct] prompt value changed from:', oldPrompt, 'to:', newPrompt)\n    // Prompt is now only used for input field initial value, no automatic execution\n  },\n  { immediate: false }\n)\n\n// Listen for changes in taskToInput (for handling cron task template setting)\nwatch(\n  () => taskStore.taskToInput,\n  (newTaskToInput) => {\n    console.log('[Direct] Watch taskStore.taskToInput triggered, newTaskToInput:', newTaskToInput)\n    if (newTaskToInput.trim()) {\n      console.log('[Direct] Setting input value from taskToInput:', newTaskToInput)\n      nextTick(() => {\n        if (inputRef.value && typeof inputRef.value.setInputValue === 'function') {\n          inputRef.value.setInputValue(newTaskToInput.trim())\n          console.log('[Direct] Input value set from taskToInput watch:', newTaskToInput.trim())\n          // Clear the taskToInput after setting\n          taskStore.getAndClearTaskToInput()\n        }\n      })\n    }\n  },\n  { immediate: false }\n)\n\nonUnmounted(() => {\n  console.log('[Direct] onUnmounted called, cleaning up resources')\n\n  // Clear current root plan ID\n  currentRootPlanId.value = null\n\n  // Clean up plan execution manager resources\n  planExecutionManager.cleanup()\n\n  // Remove event listeners\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  window.removeEventListener('plan-execution-requested', ((event: CustomEvent) => {\n    handlePlanExecutionRequested(event.detail)\n  }) as EventListener)\n})\n\n// Methods related to panel size adjustment\nconst startResize = (e: MouseEvent) => {\n  isResizing.value = true\n  startX.value = e.clientX\n  startLeftWidth.value = leftPanelWidth.value\n\n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = 'col-resize'\n  document.body.style.userSelect = 'none'\n\n  e.preventDefault()\n}\n\nconst handleMouseMove = (e: MouseEvent) => {\n  if (!isResizing.value) return\n\n  const containerWidth = window.innerWidth\n  const deltaX = e.clientX - startX.value\n  const deltaPercent = (deltaX / containerWidth) * 100\n\n  let newWidth = startLeftWidth.value + deltaPercent\n\n  // Limit panel width between 20% and 80%\n  newWidth = Math.max(20, Math.min(80, newWidth))\n\n  leftPanelWidth.value = newWidth\n}\n\nconst handleMouseUp = () => {\n  isResizing.value = false\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = ''\n  document.body.style.userSelect = ''\n\n  // Save to localStorage\n  localStorage.setItem('directPanelWidth', leftPanelWidth.value.toString())\n}\n\nconst resetPanelSize = () => {\n  leftPanelWidth.value = 50\n  localStorage.setItem('directPanelWidth', '50')\n}\n\n// Helper function to check if the event should be processed for the current plan\nconst shouldProcessEventForCurrentPlan = (rootPlanId: string, allowSpecialIds: boolean = false): boolean => {\n  // If no current plan is set, allow all events (initial state)\n  if (!currentRootPlanId.value) {\n    return true\n  }\n\n  // Check if this event is for the current active plan\n  if (rootPlanId === currentRootPlanId.value) {\n    return true\n  }\n\n  // Allow special IDs for UI state updates (error handling, etc.)\n  if (allowSpecialIds && (rootPlanId === 'ui-state' || rootPlanId === 'error')) {\n    return true\n  }\n\n  // Otherwise, ignore the event\n  console.log('[Direct] Ignoring event for non-current rootPlanId:', rootPlanId, 'current:', currentRootPlanId.value)\n  return false\n}\n\n// Handle message sending from ChatContainer via event\nconst handleChatSendMessage = async (query: InputMessage) => {\n  let assistantMessage: any = null\n\n  try {\n    console.log('[DirectView] Processing send-message event:', query)\n\n    // Add user message to UI\n    const userMessage = chatRef.value?.addMessage('user', query.input)\n    if ((query as any).attachments && userMessage) {\n      chatRef.value?.updateMessage(userMessage.id, { attachments: (query as any).attachments })\n    }\n\n    // Add assistant thinking message\n    assistantMessage = chatRef.value?.addMessage('assistant', '', {\n      thinking: t('chat.thinkingProcessing')\n    })\n\n    if (assistantMessage) {\n      chatRef.value?.startStreaming(assistantMessage.id)\n    }\n\n    // Import and call DirectApiService to send message to backend\n    const { DirectApiService } = await import('@/api/direct-api-service')\n    console.log('[DirectView] Calling DirectApiService.sendMessageWithDefaultPlan')\n    const response = await DirectApiService.sendMessageWithDefaultPlan(query)\n    console.log('[DirectView] API response received:', response)\n\n    // Handle the response\n    if (response.planId && assistantMessage) {\n      // Plan mode: Update message with plan execution info\n      chatRef.value?.updateMessage(assistantMessage.id, {\n        thinking: t('chat.planningExecution'),\n        planExecution: {\n          currentPlanId: response.planId,\n          rootPlanId: response.planId,\n          status: 'running'\n        }\n      })\n\n      // Set current root plan ID for the new plan execution\n      currentRootPlanId.value = response.planId\n      console.log('[DirectView] Set currentRootPlanId to:', response.planId)\n\n      // Start polling for plan updates\n      planExecutionManager.handlePlanExecutionRequested(response.planId, query.input)\n      console.log('[DirectView] Started polling for plan execution updates')\n    } else if (assistantMessage) {\n      // Direct mode: Show the response\n      chatRef.value?.updateMessage(assistantMessage.id, {\n        content: response.message || response.result || 'No response received from backend'\n      })\n      chatRef.value?.stopStreaming(assistantMessage.id)\n    }\n\n  } catch (error: any) {\n    console.error('[DirectView] Send message failed:', error)\n\n    // Show error message\n    chatRef.value?.addMessage('assistant', `Error: ${error?.message || 'Failed to send message'}`)\n    if (assistantMessage) {\n      chatRef.value?.stopStreaming(assistantMessage.id)\n    }\n  }\n}\n\n// Event handler for input area send button\nconst handleSendMessage = async (message: InputMessage) => {\n  console.log('[DirectView] Send message from input:', JSON.stringify(message))\n\n  // Directly handle the message sending\n  await handleChatSendMessage(message)\n}\n\nconst handleInputClear = () => {\n  console.log('[DirectView] Input cleared')\n  if (inputRef.value && typeof inputRef.value.clear === 'function') {\n    inputRef.value.clear()\n  }\n}\n\nconst handleInputFocus = () => {\n  console.log('[DirectView] Input focused')\n}\n\nconst handleInputUpdateState = (enabled: boolean, placeholder?: string) => {\n  console.log('[DirectView] Input state updated:', enabled, placeholder)\n  isLoading.value = !enabled\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[DirectView] Step selected:', stepId)\n\n  // Forward step selection to right panel\n  if (rightPanelRef.value && typeof rightPanelRef.value.handleStepSelected === 'function') {\n    console.log('[DirectView] Forwarding step selection to right panel:', stepId)\n    rightPanelRef.value.handleStepSelected(stepId)\n  } else {\n    console.warn('[DirectView] rightPanelRef.handleStepSelected method not available')\n  }\n}\n\nconst handleSubPlanStepSelected = (parentPlanId: string, subPlanId: string, stepIndex: number, subStepIndex: number) => {\n  console.log('[DirectView] Sub plan step selected:', {\n    parentPlanId,\n    subPlanId,\n    stepIndex,\n    subStepIndex\n  })\n\n  // Forward sub plan step selection to right panel\n  if (rightPanelRef.value && typeof rightPanelRef.value.handleSubPlanStepSelected === 'function') {\n    console.log('[DirectView] Forwarding sub plan step selection to right panel:', {\n      parentPlanId,\n      subPlanId,\n      stepIndex,\n      subStepIndex\n    })\n    rightPanelRef.value.handleSubPlanStepSelected(parentPlanId, subPlanId, stepIndex, subStepIndex)\n  } else {\n    console.warn('[DirectView] rightPanelRef.handleSubPlanStepSelected method not available')\n  }\n}\n\nconst handlePlanModeClicked = () => {\n  console.log('[DirectView] Plan mode button clicked')\n  // Toggle sidebar display state\n  sidebarStore.toggleSidebar()\n  console.log('[DirectView] Sidebar toggled, isCollapsed:', sidebarStore.isCollapsed)\n}\n\nconst goBack = () => {\n  router.push('/home')\n}\n\nconst handleConfig = () => {\n  router.push('/configs')\n}\n\nconst handlePlanExecutionRequested = async (payload: PlanExecutionRequestPayload) => {\n  console.log('[DirectView] Plan execution requested:', payload)\n\n  // Prevent duplicate execution\n  if (isExecutingPlan.value) {\n    console.log('[DirectView] Plan execution already in progress, ignoring request')\n    return\n  }\n\n  isExecutingPlan.value = true\n\n  // Mark whether user message has been added\n  let userMessageAdded = false;\n  let assistantMessage: any = null;\n\n  // Add user and assistant messages using the same pattern as handleChatSendMessage\n  try {\n    console.log('[DirectView] Adding messages for plan execution:', payload.title)\n\n    // Add user message\n    chatRef.value?.addMessage('user', payload.title)\n    userMessageAdded = true;\n\n    // Add assistant message to show system feedback\n    assistantMessage = chatRef.value?.addMessage('assistant', '', {\n      thinking: t('chat.planningExecution')\n    })\n\n    if (assistantMessage) {\n      chatRef.value?.startStreaming(assistantMessage.id)\n      console.log('[DirectView] Added assistant message for plan execution:', assistantMessage.id)\n    }\n  } catch (messageError) {\n    console.warn('[DirectView] Failed to add messages:', messageError)\n  }\n  try {\n    // Get the plan template ID\n    const planTemplateId = payload.planData.planTemplateId\n\n    if (!planTemplateId) {\n      throw new Error(t('direct.planTemplateIdNotFound'))\n    }\n\n    console.log(\n      '[Direct] Executing plan with templateId:',\n      planTemplateId,\n      'params:',\n      payload.params\n    )\n\n    // Call real API to execute plan\n    console.log('[Direct] About to call PlanActApiService.executePlan')\n\n    // Get uploaded files from InputArea component\n    const uploadedFiles = payload.uploadedFiles ?? []\n    const uploadKey = payload.uploadKey ?? undefined\n\n    \n    console.log('[Direct] 🔍 DEBUG - InputArea uploadedFiles:', uploadedFiles)\n    console.log('[Direct] 🔍 DEBUG - InputArea uploadKey:', uploadKey)\n    console.log('[Direct] Executing with uploaded files:', uploadedFiles.length)\n    console.log('[Direct] Executing with replacement params:', payload.replacementParams)\n\n\n    let response\n    if (payload.params?.trim()) {\n      console.log('[Direct] Calling executePlan with rawParam:', payload.params.trim())\n      response = await PlanActApiService.executePlan(planTemplateId, payload.params.trim(), uploadedFiles, payload.replacementParams, uploadKey)\n    } else {\n      console.log('[Direct] Calling executePlan without rawParam')\n      response = await PlanActApiService.executePlan(planTemplateId, undefined, uploadedFiles, payload.replacementParams, uploadKey)\n    }\n\n    console.log('[Direct] Plan execution API response:', response)\n\n    // Use the returned planId to start the plan execution process\n    if (response.planId && assistantMessage) {\n      console.log('[Direct] Got planId from response:', response.planId, 'starting plan execution')\n\n      // Update assistant message with plan execution info\n      chatRef.value?.updateMessage(assistantMessage.id, {\n        thinking: t('chat.planningExecution'),\n        planExecution: {\n          currentPlanId: response.planId,\n          rootPlanId: response.planId,\n          status: 'running'\n        }\n      })\n\n      // Set current root plan ID for the new plan execution\n      currentRootPlanId.value = response.planId\n      console.log('[Direct] Set currentRootPlanId to:', response.planId)\n\n      // Use planExecutionManager to handle plan execution\n      console.log('[Direct] Delegating plan execution to planExecutionManager')\n      planExecutionManager.handlePlanExecutionRequested(response.planId, payload.title)\n    } else {\n      console.error('[Direct] No planId in response:', response)\n      throw new Error(t('direct.executionFailedNoPlanId'))\n    }\n  } catch (error: any) {\n    console.error('[Direct] Plan execution failed:', error)\n    console.error('[Direct] Error details:', { message: error.message, stack: error.stack })\n\n    // Clear current root plan ID on error\n    currentRootPlanId.value = null\n\n    // Handle error messages using consistent pattern\n    try {\n      console.log('[Direct] Adding error messages to chat')\n\n      // Only add user message if it hasn't been added before\n      if (!userMessageAdded) {\n        chatRef.value?.addMessage('user', payload.title)\n      }\n\n      // Update assistant message with error or add new error message\n      if (assistantMessage) {\n        chatRef.value?.updateMessage(assistantMessage.id, {\n          content: `${t('direct.executionFailed')}: ${error.message || t('common.unknownError')}`,\n          thinking: undefined\n        })\n        chatRef.value?.stopStreaming(assistantMessage.id)\n      } else {\n        chatRef.value?.addMessage('assistant', `${t('direct.executionFailed')}: ${error.message || t('common.unknownError')}`)\n      }\n    } catch (errorHandlingError) {\n      console.error('[Direct] Failed to add error messages:', errorHandlingError)\n      // Note: This would need toast import if used in this context\n      alert(`${t('direct.executionFailed')}: ${error.message || t('common.unknownError')}`)\n    }\n  } finally {\n    console.log('[Direct] Plan execution finished, resetting isExecutingPlan flag')\n    isExecutingPlan.value = false\n  }\n}\n\nconst memorySelected = () => {\n  chatRef.value.showMemory()\n}\n\nconst newChat = () => {\n  memoryStore.clearMemoryId()\n  chatRef.value.newChat()\n}\n</script>\n\n<style lang=\"less\" scoped>\n.direct-page {\n  width: 100%;\n  display: flex;\n  position: relative;\n}\n\n.direct-chat {\n  height: 100vh;\n  width: 100%;\n  background: #0a0a0a;\n  display: flex;\n}\n\n.left-panel {\n  position: relative;\n  border-right: none; /* Remove the original border, which will be provided by the resizer */\n  display: flex;\n  flex-direction: column;\n  height: 100vh; /* Use fixed height */\n  overflow: hidden; /* Prevent panel itself overflow */\n  transition: width 0.1s ease; /* Smooth transition */\n}\n\n.panel-resizer {\n  width: 6px;\n  height: 100vh;\n  background: #1a1a1a;\n  cursor: col-resize;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background-color 0.2s ease;\n  flex-shrink: 0;\n\n  &:hover {\n    background: #2a2a2a;\n\n    .resizer-line {\n      background: #4a90e2;\n      width: 2px;\n    }\n  }\n\n  &:active {\n    background: #3a3a3a;\n  }\n}\n\n.resizer-line {\n  width: 1px;\n  height: 40px;\n  background: #3a3a3a;\n  border-radius: 1px;\n  transition: all 0.2s ease;\n}\n\n/* Adjust right panel styles */\n:deep(.right-panel) {\n  transition: width 0.1s ease;\n}\n\n.chat-header {\n  padding: 20px 24px;\n  border-bottom: 1px solid #1a1a1a;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  background: rgba(255, 255, 255, 0.02);\n  flex-shrink: 0; /* Ensure the header will not be compressed */\n  position: sticky; /* Fix the header at the top */\n  top: 0;\n  z-index: 100;\n\n  h2 {\n    flex: 1;\n    margin: 0;\n    font-size: 18px;\n    font-weight: 600;\n    color: #ffffff;\n  }\n}\n\n.chat-content {\n  flex: 1; /* Occupy remaining space */\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Allow shrink */\n  overflow: hidden; /* Prevent overflow */\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.back-button {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 14px;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.config-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.cron-task-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.loading-prompt {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #888888;\n  font-size: 16px;\n  padding: 50px;\n}\n\n/* Message toast styles */\n.message-toast {\n  position: fixed;\n  top: 80px;\n  right: 24px;\n  z-index: 9999;\n  min-width: 320px;\n  max-width: 480px;\n  padding: 16px 20px;\n  border-radius: 8px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  animation: slideInRight 0.3s ease-out;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.message-toast.error {\n  color: #fff2f0;\n  background-color: #ff4d4f;\n}\n\n.message-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  word-break: break-all;\n}\n\n.message-content i {\n  font-size: 16px;\n}\n\n</style>\n"],"file":"assets/index-BeArTTM_.js"}